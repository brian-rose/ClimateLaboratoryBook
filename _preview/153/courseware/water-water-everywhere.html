
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>26. Water, water everywhere! &#8212; The Climate Laboratory</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-43758959-2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-43758959-2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-43758959-2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'courseware/water-water-everywhere';</script>
    <link rel="canonical" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/water-water-everywhere.html" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="About the assignments" href="../about-assignments.html" />
    <link rel="prev" title="25. Land-Ocean contrasts under climate change" href="land-ocean-contrast.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
  
    <p class="title logo__title">The Climate Laboratory</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    The Climate Laboratory
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../who-for.html">Who is the book for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to.html">How to use this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../attribution.html">How to cite and reuse this material</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="models-budgets-fun.html">1. Climate models, the global energy budget, and Fun with Python</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="zero-dim-ebm.html">2. Modeling the global energy budget</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="analytical-efolding.html">Advanced topic: Analytical solution of the global Energy Balance Model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="climate-system-models.html">3. The climate system and climate models</a></li>
<li class="toctree-l1"><a class="reference internal" href="introducing-cesm.html">4. Introducing the Community Earth System Model (CESM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="climlab-intro.html">5. Building simple climate models using climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">6. A Brief Review of Radiation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="elementary-greenhouse.html">7. Elementary greenhouse models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sympy-greenhouse.html">Advanced topic: Solving the two-layer grey gas model analytically with sympy</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="grey-radiation-climlab.html">8. Grey radiation modeling with climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiative-transfer.html">9. Modeling non-scattering radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectral-bands.html">10. Who needs spectral bands? We do. Some baby steps…</a></li>
<li class="toctree-l1"><a class="reference internal" href="radeq.html">11. Radiative Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="rce.html">12. Radiative-Convective Equilibrium</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensitivity-feedback.html">13. Climate sensitivity and feedback</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-sensitivity-feedback.html">Advanced topic: Climate sensitivity and feedback</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="transient-cesm.html">14. Examing the transient and equilibrium CO2 response in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="transient-toy.html">15. Toy models of transient warming</a></li>
<li class="toctree-l1"><a class="reference internal" href="clouds.html">16. Clouds and cloud feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="insolation.html">17. Insolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="orbital.html">18. Orbital variations, insolation, and the ice ages</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="heat-transport.html">19. Heat transport</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-heat-transport.html">Advanced topic: Heat transport decomposition</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="one-dim-ebm.html">20. The one-dimensional energy balance model</a></li>
<li class="toctree-l1"><a class="reference internal" href="seasonal-cycle.html">21. Modeling the seasonal cycle of surface temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical-diffusion.html">22. A peek at numerical methods for diffusion models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="albedo-snowball.html">23. Ice-albedo feedback and Snowball Earth in the EBM</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-albedo-feedback.html">Advanced topic: Ice albedo feedback in the EBM</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-snowball-earth.html">Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="surface-energy-balance.html">24. The surface energy balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="land-ocean-contrast.html">25. Land-Ocean contrasts under climate change</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">26. Water, water everywhere!</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about-assignments.html">About the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-zero-dim-ebm.html">Assignment: Climate change in the zero-dimensional EBM</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="assignment-cesm-control.html">Assignment: Global average budgets in the CESM pre-industrial control simulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="assignment-cesm-control-hints.html">Additional hints and guidance for CESM budgets assignment</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-simple-clouds.html">Assignment: Clouds in the Leaky Greenhouse Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-rcm-feedback.html">Assignment: Feedbacks in the Radiative-Convective Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-cesm-climate-change.html">Assignment: Climate change in the CESM simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-insolation-orbit.html">Assignment: Insolation and orbital parameters</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Postamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://binder.projectpythia.org/v2/gh/brian-rose/ClimateLaboratoryBook/main?urlpath=tree/courseware/water-water-everywhere.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://lore.atmos.albany.edu:8000/hub/user-redirect/git-pull?repo=https%3A//github.com/brian-rose/ClimateLaboratoryBook&urlpath=tree/ClimateLaboratoryBook/courseware/water-water-everywhere.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/courseware/water-water-everywhere.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Water, water everywhere!</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-brief-look-at-the-effects-of-evaporation-on-global-climate">A brief look at the effects of evaporation on global climate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imagine-a-world-with-reduced-efficiency-of-evaporation">1. Imagine a world with reduced efficiency of evaporation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-evaporation-experiment-in-a-simple-model-with-climlab">2. Reduced evaporation experiment in a simple model with <code class="docutils literal notranslate"><span class="pre">climlab</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-complete-model-ready-to-use">The complete model, ready to use!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reducing-the-evaporation-efficiency">Reducing the evaporation efficiency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-what-is-this-model-missing">Discussion: what is this model missing?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-evaporation-efficiency-experiment-in-an-aquaplanet-gcm">3. Reduced evaporation efficiency experiment in an aquaplanet GCM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-anomalies">Temperature anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-all-the-terms-in-the-toa-and-surface-energy-and-water-budget-anomalies">Compute all the terms in the TOA and surface energy and water budget anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-budget-anomalies-at-toa-and-surface">Energy budget anomalies at TOA and surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertical-structure-of-relative-humidity-and-cloud-changes">Vertical structure of relative humidity and cloud changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meridional-heat-transport-anomalies">Meridional heat transport anomalies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">4. Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="water-water-everywhere">
<h1><span class="section-number">26. </span>Water, water everywhere!<a class="headerlink" href="#water-water-everywhere" title="Link to this heading">#</a></h1>
<section id="a-brief-look-at-the-effects-of-evaporation-on-global-climate">
<h2>A brief look at the effects of evaporation on global climate<a class="headerlink" href="#a-brief-look-at-the-effects-of-evaporation-on-global-climate" title="Link to this heading">#</a></h2>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a> by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<hr class="docutils" />
<p><a id='section1'></a></p>
</section>
<section id="imagine-a-world-with-reduced-efficiency-of-evaporation">
<h2>1. Imagine a world with reduced efficiency of evaporation<a class="headerlink" href="#imagine-a-world-with-reduced-efficiency-of-evaporation" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Recall from the lecture on <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/surface-energy-balance.html">surface energy balance</a> that the bulk formula for surface evaporation (latent heat flux) is</p>
<div class="math notranslate nohighlight">
\[ \text{LE} = L ~\rho ~ C_D ~ U \left( q_s - q_a \right) \]</div>
<p>which we approximated in terms of temperatures for a wet surface as</p>
<div class="math notranslate nohighlight">
\[ \text{LE} \approx L ~\rho ~ C_D ~ U \left( (1-r) ~ q_s^* + r \frac{\partial q^*}{\partial T} \left( T_s - T_a \right) \right)  \]</div>
<p>The drag coefficient <span class="math notranslate nohighlight">\(C_D\)</span> determines the flux for a given set of temperatures, relative humidity, and wind speed.</p>
<p>Now suppose that the drag coefficient is <strong>reduced by a factor of two</strong> (for evaporation only, not for sensible heat flux). i.e. <em>all else being equal, there will be half as much evaporation</em>.</p>
<p>Reasoning through the effects of this perturbation (and calculating the effects in models) will give us some insight into several different roles played by water in the climate system.</p>
<section id="in-class-exercise">
<h3>In-class exercise:<a class="headerlink" href="#in-class-exercise" title="Link to this heading">#</a></h3>
<p><strong>What is the effect of the reduced evaporation efficiency on surface temperature?</strong></p>
<ul class="simple">
<li><p>Form small groups.</p></li>
<li><p>Each group should formulate a hypothesis about how and why the surface temperature will change when <span class="math notranslate nohighlight">\(C_D\)</span> is reduced by a factor of 2.</p></li>
<li><p>Draw a sketch of the <strong>surface temperature anomaly</strong> as a function of latitude.</p></li>
<li><p>Be prepared to explain your sketch and your hypothesis.</p></li>
</ul>
<hr class="docutils" />
<p><a id='section2'></a></p>
</section>
</section>
<section id="reduced-evaporation-experiment-in-a-simple-model-with-climlab">
<h2>2. Reduced evaporation experiment in a simple model with <code class="docutils literal notranslate"><span class="pre">climlab</span></code><a class="headerlink" href="#reduced-evaporation-experiment-in-a-simple-model-with-climlab" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>We can use <code class="docutils literal notranslate"><span class="pre">climlab</span></code> to construct a model for the zonal-average climate. The model will be on a pressure-latitude grid. It will include the following processes:</p>
<ul class="simple">
<li><p><strong>Seasonally varying insolation</strong> as function of latitude</p></li>
<li><p>RRTMG radiation, including water vapor dependence and prescribed clouds</p></li>
<li><p>Fixed relative humidity</p></li>
<li><p>Shortave absorption by ozone</p></li>
<li><p>Meridional heat transport, implemented as a <strong>horizontal down-gradient temperature diffusion</strong> at every vertical level</p></li>
<li><p>Sensible and Latent heat fluxes at the surface using the bulk formulas</p></li>
<li><p>Convective adjustment of the <strong>atmospheric</strong> lapse rate (not surface)</p></li>
</ul>
<p>This model basically draws together all the process models we have developed throughout the course, and adds the surface flux parameterizations.</p>
<p>Note that since we are using explicit surface flux parameterizations, we will now use the convective adjustment only on the <strong>atmospheric</strong> air temperatures. Previous our adjustment has also modified the <strong>surface</strong> temperature, which was implicitly taking account of the turbulent heat fluxes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">climlab</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inferred_heat_transport</span><span class="p">(</span> <span class="n">energy_in</span><span class="p">,</span> <span class="n">lat_deg</span> <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns the inferred heat transport (in PW) by integrating the net energy imbalance from pole to pole.&#39;&#39;&#39;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">integrate</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">climlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
    <span class="n">lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span> <span class="n">lat_deg</span> <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span> <span class="mf">1E-15</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> 
            <span class="n">integrate</span><span class="o">.</span><span class="n">cumulative_trapezoid</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">)</span><span class="o">*</span><span class="n">energy_in</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">lat_rad</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A two-dimensional domain</span>
<span class="n">num_lev</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">column_state</span><span class="p">(</span><span class="n">num_lev</span><span class="o">=</span><span class="n">num_lev</span><span class="p">,</span> <span class="n">num_lat</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">water_depth</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">lev</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="s1">&#39;lev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">points</span>
</pre></div>
</div>
</div>
</div>
<p>Here we specify cloud properties. The combination of the two cloud layers defined below were found to reproduce the <strong>global, annual mean energy balance</strong> in a single-column model.</p>
<p>We will specify the same clouds everywhere for simplicity. A more thorough investigation would incorporate some meridional variations in cloud properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Define two types of cloud, high and low</span>
<span class="n">cldfrac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="p">)</span>
<span class="n">r_liq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="p">)</span>
<span class="n">r_ice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="p">)</span>
<span class="n">clwp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="p">)</span>
<span class="n">ciwp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">Tatm</span><span class="p">)</span>
<span class="c1">#   indices</span>
<span class="n">high</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># corresponds to 210 hPa</span>
<span class="n">low</span> <span class="o">=</span> <span class="mi">40</span>   <span class="c1">#  corresponds to 810 hPa</span>
<span class="c1">#  A high, thin ice layer (cirrus cloud)</span>
<span class="n">r_ice</span><span class="p">[:,</span><span class="n">high</span><span class="p">]</span> <span class="o">=</span> <span class="mf">14.</span> <span class="c1"># Cloud ice crystal effective radius (microns)</span>
<span class="n">ciwp</span><span class="p">[:,</span><span class="n">high</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>  <span class="c1"># in-cloud ice water path (g/m2)</span>
<span class="n">cldfrac</span><span class="p">[:,</span><span class="n">high</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.322</span>
<span class="c1">#  A low, thick, water cloud layer (stratus)</span>
<span class="n">r_liq</span><span class="p">[:,</span><span class="n">low</span><span class="p">]</span> <span class="o">=</span> <span class="mf">14.</span>  <span class="c1"># Cloud water drop effective radius (microns)</span>
<span class="n">clwp</span><span class="p">[:,</span><span class="n">low</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>  <span class="c1"># in-cloud liquid water path (g/m2)</span>
<span class="n">cldfrac</span><span class="p">[:,</span><span class="n">low</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.21</span>
<span class="c1"># wrap everything up in a dictionary</span>
<span class="n">mycloud</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cldfrac&#39;</span><span class="p">:</span> <span class="n">cldfrac</span><span class="p">,</span>
          <span class="s1">&#39;ciwp&#39;</span><span class="p">:</span> <span class="n">ciwp</span><span class="p">,</span>
          <span class="s1">&#39;clwp&#39;</span><span class="p">:</span> <span class="n">clwp</span><span class="p">,</span>
          <span class="s1">&#39;r_ice&#39;</span><span class="p">:</span> <span class="n">r_ice</span><span class="p">,</span>
          <span class="s1">&#39;r_liq&#39;</span><span class="p">:</span> <span class="n">r_liq</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cldfrac</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">lev</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (hPa)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cloud fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Prescribed cloud fraction in the column model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/21d3bcb1101eea173f27516de6022d932016b35985013cd1a3ed21c1002146a1.png" src="../_images/21d3bcb1101eea173f27516de6022d932016b35985013cd1a3ed21c1002146a1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  The top-level model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">TimeDependentProcess</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Radiative-Convective-Diffusive Model&#39;</span><span class="p">)</span>
<span class="c1">#  Specified relative humidity distribution</span>
<span class="n">h2o</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">ManabeWaterVapor</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
<span class="c1">#  Hard convective adjustment for ATMOSPHERE ONLY (not surface)</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">convection</span><span class="o">.</span><span class="n">ConvectiveAdjustment</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Tatm&#39;</span><span class="p">:</span><span class="n">model</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">]},</span>
                                               <span class="n">adj_lapse_rate</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span>
                                               <span class="o">**</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
<span class="c1">#  Annual mean insolation as a function of latitude and time of year</span>
<span class="n">sun</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">DailyInsolation</span><span class="p">(</span><span class="n">domains</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">Ts</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span>
<span class="c1">#  Couple the radiation to insolation and water vapor processes</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">RRTMG</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> 
                              <span class="n">specific_humidity</span><span class="o">=</span><span class="n">h2o</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> 
                              <span class="n">albedo</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span>
                              <span class="n">coszen</span><span class="o">=</span><span class="n">sun</span><span class="o">.</span><span class="n">coszen</span><span class="p">,</span>
                              <span class="n">irradiance_factor</span><span class="o">=</span><span class="n">sun</span><span class="o">.</span><span class="n">irradiance_factor</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">mycloud</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;Radiation&#39;</span><span class="p">,</span> <span class="n">rad</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;Insolation&#39;</span><span class="p">,</span> <span class="n">sun</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;WaterVapor&#39;</span><span class="p">,</span> <span class="n">h2o</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;Convection&#39;</span><span class="p">,</span> <span class="n">conv</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climlab Process of type &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;. 
State variables and domain shapes: 
  Ts: (60, 1) 
  Tatm: (60, 50) 
The subprocess tree: 
Radiative-Convective-Diffusive Model: &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;
   Radiation: &lt;class &#39;climlab.radiation.rrtm.rrtmg.RRTMG&#39;&gt;
      SW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_sw.RRTMG_SW&#39;&gt;
      LW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_lw.RRTMG_LW&#39;&gt;
   Insolation: &lt;class &#39;climlab.radiation.insolation.DailyInsolation&#39;&gt;
   WaterVapor: &lt;class &#39;climlab.radiation.water_vapor.ManabeWaterVapor&#39;&gt;
   Convection: &lt;class &#39;climlab.convection.convadj.ConvectiveAdjustment&#39;&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/br546577/miniconda3/envs/new-climlab-courseware/lib/python3.13/site-packages/climlab/radiation/radiation.py:153: UserWarning: Some grid points are beyond the bounds of the ozone file. Ozone values will be extrapolated.
  warnings.warn(&#39;Some grid points are beyond the bounds of the ozone file. Ozone values will be extrapolated.&#39;)
</pre></div>
</div>
</div>
</div>
<p>Here we add a diffusive heat transport process. The <code class="docutils literal notranslate"><span class="pre">climlab</span></code> code is set up to handle meridional diffusion level-by-level with a constant coefficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">climlab.dynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MeridionalDiffusion</span>

<span class="c1"># thermal diffusivity in W/m**2/degC</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.04</span>
<span class="c1"># meridional diffusivity in m**2/s</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">D</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">Tatm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">heat_capacity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">MeridionalDiffusion</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Tatm&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">]},</span> 
                        <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="o">**</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;Diffusion&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we will add the surface heat flux processes. We have not used these before.</p>
<p>Note that the drag coefficient <span class="math notranslate nohighlight">\(C_D\)</span> is passed as an input argument when we create the process. It is also stored as an attribute of the process and can be modified (see below).</p>
<p>The bulk formulas depend on a wind speed <span class="math notranslate nohighlight">\(U\)</span>. In this model, <span class="math notranslate nohighlight">\(U\)</span> is specified as a constant. In a model with more complete dynamics, <span class="math notranslate nohighlight">\(U\)</span> would be interactively calculated from the equations of motion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Add surface heat fluxes</span>
<span class="n">shf</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">SensibleHeatFlux</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">0.5E-3</span><span class="p">)</span>
<span class="n">lhf</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">LatentHeatFlux</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">Cd</span><span class="o">=</span><span class="mf">0.5E-3</span><span class="p">)</span>
<span class="c1"># set the water vapor input field for LHF</span>
<span class="n">lhf</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">q</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;SHF&#39;</span><span class="p">,</span> <span class="n">shf</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add_subprocess</span><span class="p">(</span><span class="s1">&#39;LHF&#39;</span><span class="p">,</span> <span class="n">lhf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="the-complete-model-ready-to-use">
<h3>The complete model, ready to use!<a class="headerlink" href="#the-complete-model-ready-to-use" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climlab Process of type &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;. 
State variables and domain shapes: 
  Ts: (60, 1) 
  Tatm: (60, 50) 
The subprocess tree: 
Radiative-Convective-Diffusive Model: &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;
   Radiation: &lt;class &#39;climlab.radiation.rrtm.rrtmg.RRTMG&#39;&gt;
      SW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_sw.RRTMG_SW&#39;&gt;
      LW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_lw.RRTMG_LW&#39;&gt;
   Insolation: &lt;class &#39;climlab.radiation.insolation.DailyInsolation&#39;&gt;
   WaterVapor: &lt;class &#39;climlab.radiation.water_vapor.ManabeWaterVapor&#39;&gt;
   Convection: &lt;class &#39;climlab.convection.convadj.ConvectiveAdjustment&#39;&gt;
   Diffusion: &lt;class &#39;climlab.dynamics.meridional_advection_diffusion.MeridionalDiffusion&#39;&gt;
   SHF: &lt;class &#39;climlab.surface.turbulent.SensibleHeatFlux&#39;&gt;
   LHF: &lt;class &#39;climlab.surface.turbulent.LatentHeatFlux&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="alert alert-warning">
Although this is a "simple" model, it has a 60 x 30 point grid and is **by far the most complex model** we have built so far in these notes. These runs will probably take several minutes to execute, depending on the speed of your computer.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 1460 steps, 1460.9688 days, or 4.0 years.
Total elapsed time is 3.997347513512951 years.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  One more year to get annual-mean diagnostics</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 365 steps, 365.2422 days, or 1.0 years.
Total elapsed time is 4.996684391891189 years.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface temperature (reference)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">field</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Atmospheric temperature (reference)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;LHF&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LHF&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;SHF&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SHF&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface heat flux (reference)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Rtoa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;ASR&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;OLR&#39;</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Rtoa</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Meridional heat transport (reference)&#39;</span><span class="p">);</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de33273e4540a32913c7eec599c619d5f887cd938bf05c0087d9d12153e1bb4d.png" src="../_images/de33273e4540a32913c7eec599c619d5f887cd938bf05c0087d9d12153e1bb4d.png" />
</div>
</div>
</section>
<section id="reducing-the-evaporation-efficiency">
<h3>Reducing the evaporation efficiency<a class="headerlink" href="#reducing-the-evaporation-efficiency" title="Link to this heading">#</a></h3>
<p>Just need to clone our model, and modify <span class="math notranslate nohighlight">\(C_D\)</span> in the latent heat flux subprocess.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">process_like</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">subprocess</span><span class="p">[</span><span class="s1">&#39;LHF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Cd</span> <span class="o">*=</span> <span class="mf">0.5</span>
<span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 1460 steps, 1460.9688 days, or 4.0 years.
Total elapsed time is 8.994031905404139 years.
Integrating for 365 steps, 365.2422 days, or 1.0 years.
Total elapsed time is 9.993368783782378 years.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface temperature anomaly&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">field</span> <span class="o">=</span> <span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Atmospheric temperature anomaly&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LHF&#39;</span><span class="p">,</span><span class="s1">&#39;SHF&#39;</span><span class="p">]:</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">field</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface heat flux anomalies&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Rtoa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;ASR&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;OLR&#39;</span><span class="p">])</span>
<span class="n">Rtoa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;ASR&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">model2</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;OLR&#39;</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Rtoa2</span><span class="o">-</span><span class="n">Rtoa</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Meridional heat transport anomaly&#39;</span><span class="p">);</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
    
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The global mean surface temperature anomaly is </span><span class="si">%0.2f</span><span class="s1"> K.&#39;</span> 
       <span class="o">%</span><span class="k">np</span>.average(model2.timeave[&#39;Ts&#39;] - model.timeave[&#39;Ts&#39;], 
                   <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The global mean surface temperature anomaly is 0.84 K.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/dl/j7hb106d36n501mrm8j646bxpf4y1c/T/ipykernel_85353/3339827933.py:33: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  print (&#39;The global mean surface temperature anomaly is %0.2f K.&#39;
</pre></div>
</div>
<img alt="../_images/b7cd92c78a241db4eca816879710a6b0c71d9269c13209721451046a19f9c7a6.png" src="../_images/b7cd92c78a241db4eca816879710a6b0c71d9269c13209721451046a19f9c7a6.png" />
</div>
</div>
<p>This model predicts the following:</p>
<ul class="simple">
<li><p>The <strong>surface temperature</strong> warms slightly in the tropics, and cools at high latitudes</p></li>
<li><p>The <strong>atmosphere</strong> gets colder everywhere!</p></li>
<li><p>There is a substantial reduction in surface latent heat flux, especially in the tropics where it is dominant.</p></li>
<li><p>There is also a substantial <strong>increase</strong> in sensible heat flux. This is consistent with the cooler air temperatures and warmer surface.</p></li>
<li><p>Colder tropical atmosphere leads to a decrease in the poleward heat tranpsort. This helps explain the high-latitude cooling.</p></li>
<li><p>Notice that the heat transport responds to the <strong>atmopsheric</strong> temperature gradient, which changes in the opposite direction of the <strong>surface</strong> temperature gradient.</p></li>
</ul>
<p>Basically, this model predicts that by inhibiting evaporation in the tropics, we force the tropical surface to warm and the tropical atmosphere to cool. This cooling signal is then communicated globally by atmospheric heat transport. The result is small positive global surface temperature anomaly.</p>
</section>
<section id="discussion-what-is-this-model-missing">
<h3>Discussion: what is this model missing?<a class="headerlink" href="#discussion-what-is-this-model-missing" title="Link to this heading">#</a></h3>
<p>We could list many things, but as we will see below, two key climate components that are not included in this model are</p>
<ul class="simple">
<li><p>changes in relative humidity</p></li>
<li><p>cloud feedback</p></li>
</ul>
<p>We will compare this result to an analogous experiment in a GCM.</p>
<hr class="docutils" />
<p><a id='section3'></a></p>
</section>
</section>
<section id="reduced-evaporation-efficiency-experiment-in-an-aquaplanet-gcm">
<h2>3. Reduced evaporation efficiency experiment in an aquaplanet GCM<a class="headerlink" href="#reduced-evaporation-efficiency-experiment-in-an-aquaplanet-gcm" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The model is the familiar CESM but in simplified “aquaplanet” setup. The surface is completely covered by a shallow slab ocean.</p>
<p>This model setup (with CAM4 model physics) is described in detail in <span id="id1">Rose <em>et al.</em> [<a class="reference internal" href="../references.html#id26" title="Brian E. J. Rose, Kyle C. Armour, David S. Battisti, Nicole Feldl, and Daniel D. B. Koll. The dependence of transient climate sensitivity and radiative feedbacks on the spatial pattern of ocean heat uptake. Geophys. Res. Lett., 2014. doi:10.1002/2013GL058955.">2014</a>]</span> and <span id="id2">Rose and Rencurrel [<a class="reference internal" href="../references.html#id12" title="Brian E. J. Rose and M. Cameron Rencurrel. The vertical structure of tropospheric water vapor: comparing radiative and ocean-driven climate changes. J. Climate, 29:4251–4268, 2016. doi:10.1175/JCLI-D-15-0482.1.">2016</a>]</span>.</p>
<p>Here we will compare a control simulation with a perturbation simulation in which we have once again <strong>reduced the drag coefficient by a factor of 2</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the climatologies from the CAM4 aquaplanet runs</span>
<span class="n">datapath</span> <span class="o">=</span> <span class="s2">&quot;http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/&quot;</span>
<span class="n">ctrl</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s2">&quot;QAqu_ctrl/clim/QAqu_ctrl.cam.h0.clim.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">halfEvap</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">datapath</span> <span class="o">+</span> <span class="s2">&quot;QAqu_halfEvap/clim/QAqu_halfEvap.cam.h0.clim.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">lat</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">lon</span>
<span class="n">lev</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">lev</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TS_anom</span> <span class="o">=</span> <span class="n">halfEvap</span><span class="o">.</span><span class="n">TS</span> <span class="o">-</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">TS</span>
<span class="n">Tatm_anom</span> <span class="o">=</span> <span class="n">halfEvap</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="temperature-anomalies">
<h3>Temperature anomalies<a class="headerlink" href="#temperature-anomalies" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">TS_anom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">));</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface temperature anomaly&#39;</span><span class="p">)</span>
<span class="n">cax2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="n">Tatm_anom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">();</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax2</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Atmospheric temperature anomaly&#39;</span><span class="p">);</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
    
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The global mean surface temperature anomaly is </span><span class="si">%0.2f</span><span class="s1"> K.&#39;</span> <span class="o">%</span><span class="p">((</span><span class="n">TS_anom</span><span class="o">*</span><span class="n">ctrl</span><span class="o">.</span><span class="n">gw</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">ctrl</span><span class="o">.</span><span class="n">gw</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The global mean surface temperature anomaly is 4.94 K.
</pre></div>
</div>
<img alt="../_images/bce0d7d6cce53806a8f4e948b63e9c96f535ededb0776bde51339cac95c8a49a.png" src="../_images/bce0d7d6cce53806a8f4e948b63e9c96f535ededb0776bde51339cac95c8a49a.png" />
</div>
</div>
<p>In this model, reducing the evaporation efficiency leads to a <strong>much warmer climate</strong>.  The largest warming occurs in mid-latitudes. The warming is <strong>not</strong> limited to the surface but in fact extends deeply through the troposphere.</p>
<p>Both the spatial pattern and the magnitude of the warming are completely different than what our much simpler model predicted.</p>
<p>Why?</p>
</section>
<section id="compute-all-the-terms-in-the-toa-and-surface-energy-and-water-budget-anomalies">
<h3>Compute all the terms in the TOA and surface energy and water budget anomalies<a class="headerlink" href="#compute-all-the-terms-in-the-toa-and-surface-energy-and-water-budget-anomalies" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_budget</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span><span class="s1">&#39;halfEvap&#39;</span><span class="p">],[</span><span class="n">ctrl</span><span class="p">,</span><span class="n">halfEvap</span><span class="p">]):</span>
    <span class="n">budget</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    <span class="c1"># TOA radiation</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;OLR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FLNT</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;OLR_clr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FLNTC</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;ASR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FSNT</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;ASR_clr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FSNTC</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;Rtoa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span><span class="o">.</span><span class="n">ASR</span> <span class="o">-</span> <span class="n">budget</span><span class="o">.</span><span class="n">OLR</span>  <span class="c1"># net downwelling radiation</span>
    <span class="c1">#  surface fluxes  (all positive UP)</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LHF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">LHFLX</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SHF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">SHFLX</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LWsfc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FLNS</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LWsfc_clr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">FLNSC</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SWsfc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">FSNS</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SWsfc_clr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">FSNSC</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SnowFlux&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">PRECSC</span><span class="o">+</span><span class="n">run</span><span class="o">.</span><span class="n">PRECSL</span><span class="p">)</span>
                           <span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">rho_w</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">Lhfus</span><span class="p">)</span>
    <span class="c1"># net upward radiation from surface</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SfcNetRad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LWsfc&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SWsfc&#39;</span><span class="p">]</span>  
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SfcNetRad_clr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LWsfc_clr&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SWsfc_clr&#39;</span><span class="p">]</span>  
    <span class="c1"># net upward surface heat flux</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SfcNet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SfcNetRad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;LHF&#39;</span><span class="p">]</span> <span class="o">+</span> 
                     <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SHF&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SnowFlux&#39;</span><span class="p">])</span>
    <span class="c1"># net heat flux in to atmosphere</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;Fatmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;Rtoa&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;SfcNet&#39;</span><span class="p">]</span>  
    <span class="c1">#  hydrological cycle</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;Evap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="s1">&#39;QFLX&#39;</span><span class="p">]</span>  <span class="c1"># kg/m2/s or mm/s</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;Precip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;PRECC&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;PRECL&#39;</span><span class="p">][:])</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">rho_w</span>  <span class="c1"># kg/m2/s or mm/s</span>
    <span class="n">budget</span><span class="p">[</span><span class="s1">&#39;EminusP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span><span class="o">.</span><span class="n">Evap</span> <span class="o">-</span> <span class="n">budget</span><span class="o">.</span><span class="n">Precip</span>  <span class="c1"># kg/m2/s or mm/s</span>
    <span class="n">energy_budget</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">budget</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#   Here we take advantage of xarray!</span>
<span class="c1">#   We can simply subtract the two xarray.Dataset objects </span>
<span class="c1">#   to get anomalies for every term</span>
<span class="c1">#   And also take the zonal averages for all anomaly fields in one line of code</span>
<span class="n">anom</span> <span class="o">=</span> <span class="n">energy_budget</span><span class="p">[</span><span class="s1">&#39;halfEvap&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">energy_budget</span><span class="p">[</span><span class="s1">&#39;ctrl&#39;</span><span class="p">]</span>
<span class="n">zonanom</span> <span class="o">=</span> <span class="n">anom</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="energy-budget-anomalies-at-toa-and-surface">
<h3>Energy budget anomalies at TOA and surface<a class="headerlink" href="#energy-budget-anomalies-at-toa-and-surface" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">ASR</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ASR&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">OLR</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OLR&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">ASR_clr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">OLR_clr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TOA radiation anomalies&#39;</span><span class="p">)</span>
    
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">SWsfc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SW&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">SWsfc_clr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">LWsfc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LW&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">LWsfc_clr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">LHF</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LHF&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">SHF</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SHF&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">zonanom</span><span class="o">.</span><span class="n">SfcNet</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Net&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Surface energy budget anomalies&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0534c7141557528facd85d673d9dfce5bc0f243b763111b479cb4f578df4dae7.png" src="../_images/0534c7141557528facd85d673d9dfce5bc0f243b763111b479cb4f578df4dae7.png" />
</div>
</div>
<p>Dashed lines are <strong>clear-sky</strong> radiation anomalies.</p>
<p>Looking at the TOA budget:</p>
<ul class="simple">
<li><p>Reducing evaporation efficiency leads to very large increase in ASR, especially in mid-latitudes</p></li>
<li><p>This increase is almost entirely due to clouds!</p></li>
<li><p>Accompanied by a (mostly) clear-sky OLR increase, consistent with the warmer temperatures.</p></li>
</ul>
<p>This is very suggestive of an important role for <strong>low-level cloud changes</strong>.  [Why?]</p>
<p>From the <strong>surface budget</strong>:</p>
<ul class="simple">
<li><p>Notice that the <strong>decrease in evaporation is much weaker</strong> than we found in the simple model.</p></li>
<li><p>Here, the decreased evaporation <strong>efficiency</strong> is competing against the <strong>warmer temperatures</strong> which tend to strongly increase evaporation, all else being equal.</p></li>
<li><p>The surface (ocean) gains a lot of excess heat by solar radiation.</p></li>
<li><p>As noted from the TOA budget, this is <strong>due to changes in cloudiness</strong>.</p></li>
<li><p>The clear-sky SW anomaly is actually positive, consistent with a warmer, moister atmosphere (but this effect is small).</p></li>
<li><p>The LW anomaly is positive, indicating increased radiative cooling of the surface.</p></li>
<li><p>This is also largely a cloud effect, and consistent with a <strong>decrease in low-level cloudiness</strong>. [Why?]</p></li>
<li><p>As in the simple model, there is an <strong>increase in the sensible heat flux</strong> (though weaker).</p></li>
<li><p>According to bulk formula, should be driven by one or both of</p>
<ul>
<li><p>increased wind speed</p></li>
<li><p>increased air-sea temperature difference</p></li>
</ul>
</li>
</ul>
</section>
<section id="vertical-structure-of-relative-humidity-and-cloud-changes">
<h3>Vertical structure of relative humidity and cloud changes<a class="headerlink" href="#vertical-structure-of-relative-humidity-and-cloud-changes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">RH</span> <span class="o">=</span> <span class="p">(</span><span class="n">halfEvap</span><span class="o">.</span><span class="n">RELHUM</span> <span class="o">-</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">RELHUM</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">);</span> <span class="n">CLOUD</span> <span class="o">=</span> <span class="p">(</span><span class="n">halfEvap</span><span class="o">.</span><span class="n">CLOUD</span> <span class="o">-</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">CLOUD</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mf">16.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span>
<span class="n">cax1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="n">RH</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Relative Humidity (%)&#39;</span><span class="p">)</span>
<span class="n">cax2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lev</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">CLOUD</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cloud fraction (%)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f5ff0fbb234e536817a5247f57d74685904124c49bb5e43b22e4136e3bd0ca59.png" src="../_images/f5ff0fbb234e536817a5247f57d74685904124c49bb5e43b22e4136e3bd0ca59.png" />
</div>
</div>
</section>
<section id="meridional-heat-transport-anomalies">
<h3>Meridional heat transport anomalies<a class="headerlink" href="#meridional-heat-transport-anomalies" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HT</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">HT</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">anom</span><span class="o">.</span><span class="n">Rtoa</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">lat</span><span class="p">)</span>
<span class="n">HT</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">anom</span><span class="o">.</span><span class="n">Fatmin</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">lat</span><span class="p">)</span>
<span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">anom</span><span class="o">.</span><span class="n">EminusP</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">Lhvap</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="n">HT</span><span class="p">[</span><span class="s1">&#39;dse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">],</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;dse&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dry&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;latent&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Latitude&#39;)
</pre></div>
</div>
<img alt="../_images/a98f0b112a56643212c99412a32cc379e9ee7139eb7f967f9e2aae730a0818a1.png" src="../_images/a98f0b112a56643212c99412a32cc379e9ee7139eb7f967f9e2aae730a0818a1.png" />
</div>
</div>
<hr class="docutils" />
<p><a id='section4'></a></p>
</section>
</section>
<section id="conclusion">
<h2>4. Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>We have forced a climate change NOT by adding any kind of radiative forcing, but just by changing the efficiency of evaporation at the sea surface.</p>
<p>The climate system then find a new equilibrium in which the radiative fluxes, surface temperature, air-sea temperature difference, boundary layer relative humidity, and wind speeds all change simultaneously.</p>
<p>Reasoning our way through such a problem from first principles in practically impossible. This is particularly true because in this example, the dominant driver of the climate change is an increase in SW absorption due to a substantial decrease in low-level clouds across the subtropics and mid-latitudes.</p>
<p>A comprehensive theory to explain these cloud changes does not yet exist. <strong>Understanding changes in low-level cloudiness under climate change is enormously important</strong> – because these clouds, which have an unambiguous cooling effect, are a key determinant of climate sensitivity. There is lots of work left to do.</p>
<p>Water is intimately involved in just about every aspect of the planetary energy budget. Here we have highlighted the role of water in:</p>
<ul class="simple">
<li><p>Cooling of the surface by evaporation</p></li>
<li><p>Water vapor greenhouse effect</p></li>
<li><p>Poleward latent heat transport</p></li>
<li><p>Cloud formation</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Link to this heading">#</a></h2>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a>, an open-source textbook developed and maintained by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p>It is licensed for free and open consumption under the
<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> license.</p>
<p>Development of these notes and the <a class="reference external" href="https://github.com/climlab/climlab">climlab software</a> is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.</p>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./courseware"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="land-ocean-contrast.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">25. </span>Land-Ocean contrasts under climate change</p>
      </div>
    </a>
    <a class="right-next"
       href="../about-assignments.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">About the assignments</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-brief-look-at-the-effects-of-evaporation-on-global-climate">A brief look at the effects of evaporation on global climate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imagine-a-world-with-reduced-efficiency-of-evaporation">1. Imagine a world with reduced efficiency of evaporation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-evaporation-experiment-in-a-simple-model-with-climlab">2. Reduced evaporation experiment in a simple model with <code class="docutils literal notranslate"><span class="pre">climlab</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-complete-model-ready-to-use">The complete model, ready to use!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reducing-the-evaporation-efficiency">Reducing the evaporation efficiency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-what-is-this-model-missing">Discussion: what is this model missing?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-evaporation-efficiency-experiment-in-an-aquaplanet-gcm">3. Reduced evaporation efficiency experiment in an aquaplanet GCM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-anomalies">Temperature anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-all-the-terms-in-the-toa-and-surface-energy-and-water-budget-anomalies">Compute all the terms in the TOA and surface energy and water budget anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-budget-anomalies-at-toa-and-surface">Energy budget anomalies at TOA and surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertical-structure-of-relative-humidity-and-cloud-changes">Vertical structure of relative humidity and cloud changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meridional-heat-transport-anomalies">Meridional heat transport anomalies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">4. Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian E. J. Rose
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>