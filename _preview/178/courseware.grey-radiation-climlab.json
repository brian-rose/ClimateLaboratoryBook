{"version":2,"kind":"Notebook","sha256":"b2cea5ee3dbdf03163b8c398707407746a975e43c454cd1951dd8d4732739950","slug":"courseware.grey-radiation-climlab","location":"/courseware/grey-radiation-climlab.ipynb","dependencies":[],"frontmatter":{"title":"Grey radiation modeling with climlab","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"}],"doi":"https://doi.org/10.5281/zenodo.4265097","open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/brian-rose/ClimateLaboratoryBook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"}],"abbreviations":{"TOA":"Top of Atmosphere","SW":"Shortwave","LW":"Longwave","UV":"Ultraviolet","IR":"Infrared","OLR":"Outgoing Longwave Radiation","ASR":"Absorbed Shortwave Radiation","CC":"Clausius-Clapeyron","LWP":"Liquid Water Path","CRE":"Cloud Radiative Effect","ECS":"Equilibrium Climate Sensitivity","TCR":"Transient Climate Response","WV":"Water Vapor","LR":"Lapse Rate","LCL":"Lifting Condensation Level","LGM":"Last Glacial Maximum","MSE":"Moist Static Energy","AHT":"Atmospheric Heat Transport","OHT":"Ocean Heat Transport","THT":"Total Heat Transport","1D":"One-dimensional","2D":"Two-dimensional","3D":"Three-dimensional","lat":"latitude","lon":"longitude","ppm":"parts per million","ppmv":"parts per million by volume","hPa":"hectoPascals","Ma":"Millions of years","LHS":"Left hand side","RHS":"Right hand side","EBM":"Energy Balance Model","GCM":"Global Circulation Model","OGCM":"Ocean Global Circulation Model","AGCM":"Atmospheric Global Circulation Model","AOGCM":"Atmosphere-Ocean Global Circulation Model","CGCM":"Coupled Global Circulation Model","RC":"Radiative-Convective","RCM":"Radiative-Convective Model","RCE":"Radiative-Convective Equilibrium","SCM":"Single-Column Model","ESM":"Earth System Model","SD":"Statistical-Dynamical","EMIC":"Earth System Model of Intermediate Complexity","IAM":"Integrated Asessment Model","SOM":"Slab Ocean Model","CESM":"Community Earth System Model","CAM":"Community Atmosphere Model","POP":"Parallel Ocean Program","CLM":"Community Land Model","CICE":"Community Ice CodE","RRTMG":"Rapid Radiative Transfer Model","ODE":"Ordinary Differential Equation","PDE":"Partial Differential Equation","FTCS":"Forward Time, Centered Space","URL":"Uniform Research Locator","CMIP":"Coupled Model Intercomparison Project","IPCC":"Intergovernmental Panel on Climate Change","AR5":"Fifth Assessment Report","AR6":"Sixth Assessment Report","WG1":"Working Group 1","NCAR":"National Center for Atmospheric Research","AMS":"American Meteorological Society","NCEP":"National Centers for Environmental Prediction"},"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/brian-rose/ClimateLaboratoryBook/blob/HEAD/courseware/grey-radiation-climlab.ipynb","exports":[{"format":"ipynb","filename":"grey-radiation-climlab.ipynb","url":"/ClimateLaboratoryBook/_preview/178/build/grey-radiation-climl-36e5017d180b207ea6b2dca83906fe73.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mBMt54m9km"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dn47Wj8OMA"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"tCJneMLHTh"},{"type":"text","value":" by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RpPMf2bmTM"},{"type":"link","url":"https://www.atmos.albany.edu/facstaff/brose/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R6fLwBobJi"}],"urlSource":"https://www.atmos.albany.edu/facstaff/brose/","key":"sxXOdx3D4B"},{"type":"text","value":", University at Albany.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KMnRCEMDLy"}],"key":"HjXhiX85t3"}],"key":"YA1mGpiSSZ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SIXy13oKo3"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"1. Introducing ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SV9oGkoLFv"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Fegxe0xOcE"}],"identifier":"id-1-introducing-climlab","label":"1. Introducing climlab","html_id":"id-1-introducing-climlab","implicit":true,"key":"oLiF98nZph"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LvP6eSGUri"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"About climlab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xmfeMNgqdd"}],"identifier":"about-climlab","label":"About climlab","html_id":"about-climlab","implicit":true,"key":"pLlrAy5GQm"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"climlab is a specialized python package for process-oriented climate modeling.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tezhM3mqoh"}],"key":"zUv5fG94Wz"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"It is based on a very general concept of a model as a collection of individual,\ninteracting processes. climlab defines a base class called ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JltrZODLn4"},{"type":"inlineCode","value":"Process","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sqDjcuvRYt"},{"type":"text","value":", which\ncan contain an arbitrarily complex tree of sub-processes (each also some\nsub-class of ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"th82LciXjx"},{"type":"inlineCode","value":"Process","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"iyALt5jlRO"},{"type":"text","value":"). Every climate process (radiative, dynamical,\nphysical, turbulent, convective, chemical, etc.) can be simu","key":"aeuhjOjGi3"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"yQmv3chJS4"}],"key":"y7SNKg3AqD"},{"type":"text","value":"ed as a stand-a","key":"ZjKRKi4ssA"},{"type":"abbreviation","title":"longitude","children":[{"type":"text","value":"lon","key":"R0iirfBeWT"}],"key":"BzTiGy9f4k"},{"type":"text","value":"e\nprocess model given appropriate input, or as a sub-process of a more complex model.\nNew classes of model can easily be defined and run interactively by putting together an\nappropriate collection of sub-processes.","key":"yThcwGeZk2"}],"key":"d22OIgXtMF"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"climlab is an open-source community project. The ","key":"QySsieZfZr"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"u9wtSnA71b"}],"key":"g4Dq9XzrCN"},{"type":"text","value":"est code can always be found on github:","key":"U7EU4ijLBx"}],"key":"AvRwBeEqz5"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"link","url":"https://github.com/climlab/climlab","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/climlab​/climlab","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mRUZ0cYInc"}],"urlSource":"https://github.com/climlab/climlab","error":true,"key":"S6FhqtzzVG"}],"key":"Ih14ioOEoP"},{"type":"heading","depth":2,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Installing climlab","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"AlCDcix1su"}],"identifier":"installing-climlab","label":"Installing climlab","html_id":"installing-climlab","implicit":true,"key":"bhHHgiDXSV"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"If you’ve followed ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Zg9vVD2mMB"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook/how-to.html","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"these instructions from the Climate Laboratory book","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"wQz4vyjMpN"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook/how-to.html","key":"WbRgLS2kKj"},{"type":"text","value":", then you should be all set -- climlab is automatically installed as part of the suite of tools used in ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"t4BQco2mpE"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"oH7im55Eqo"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"fuIcs0uFcX"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"qTosPYA37d"}],"key":"Sd1ArK1rdf"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"If you are maintaining your own Python instal","key":"hozUWWh0nc"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"bL09Hg06ZW"}],"key":"Kn5yAjm7W1"},{"type":"text","value":"ion (e.g. on a personal laptop), you can always install climlab by doing","key":"XnqIzEej2a"}],"key":"lOeS5eRSsm"},{"type":"code","lang":"","value":"conda install -c conda-forge climlab","position":{"start":{"line":28,"column":1},"end":{"line":30,"column":1}},"key":"itJVLcIitD"}],"key":"d5fRnhflgG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport xarray as xr\nfrom numpy import cos, deg2rad, log\nimport climlab","key":"vUmRgNqFNb"},{"type":"output","id":"YMUDVFeTH0DPQpGaOLbXr","data":[],"key":"kfPz4dHBT4"}],"key":"EqIzXMfQkE"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ms8l1uCtQG"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"2. Using ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wgYhbNrsC9"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UAqvBLQPv7"},{"type":"text","value":" to implement the two-layer leaky greenhouse model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LyqBmDkTsK"}],"identifier":"id-2-using-climlab-to-implement-the-two-layer-leaky-greenhouse-model","label":"2. Using climlab to implement the two-layer leaky greenhouse model","html_id":"id-2-using-climlab-to-implement-the-two-layer-leaky-greenhouse-model","implicit":true,"key":"OswDogR5JS"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oeTxxBszWO"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"One of the things that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jYwR7GVAM5"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pCBcE5dWWD"},{"type":"text","value":" is set up to do is the grey-radiation modeling we have already been discussing.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DOavp7wwU5"}],"key":"ZXyrPkfT6W"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Since we already derived a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KYV6TLKA3h"},{"type":"link","url":"/courseware/elementary-greenhouse","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"complete analytical solution to the two-layer leaky greenhouse model","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"P4AGsfLoAh"}],"urlSource":"elementary-greenhouse","dataUrl":"/courseware.elementary-greenhouse.json","internal":true,"protocol":"file","key":"rEsJLo6JOd"},{"type":"text","value":", we will use this to validate the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r9P4UWsCJh"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nqepCTfzTn"},{"type":"text","value":" code.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OTodkik66O"}],"key":"p16O2Otvcs"}],"key":"EHmmtNvVEW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bLFOcDUtTq"}],"identifier":"validation","label":"Validation","html_id":"validation","implicit":true,"key":"jlx0v0CnIY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We want to verify that the model reproduces the observed ","key":"HuDmnGbvtY"},{"type":"abbreviation","title":"Outgoing Longwave Radiation","children":[{"type":"text","value":"OLR","key":"cUtVEcw8NC"}],"key":"IJ2udg1ezw"},{"type":"text","value":" given observed temperatures, and the absorptivity that we tuned in the analytical model. The target numbers are:","key":"p6onOqh26O"}],"key":"qbW8UVkhXj"},{"type":"math","value":"\\begin{align}\nT_s &= 288 \\text{ K} \\\\\nT_0 &= 275 \\text{ K} \\\\\nT_1 &= 230 \\text{ K} \\\\\n\\end{align}","position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mi>s</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>288</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>275</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>230</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\nT_s &amp;= 288 \\text{ K} \\\\\nT_0 &amp;= 275 \\text{ K} \\\\\nT_1 &amp;= 230 \\text{ K} \\\\\n\\end{align}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.5em;vertical-align:-2em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">288</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">275</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">230</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"q4Dnrt2XYW"},{"type":"math","value":"\\epsilon = 0.586","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0.586</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon = 0.586</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.586</span></span></span></span></span>","enumerator":"2","key":"FQCQ8YQK8L"},{"type":"math","value":"OLR = 238.5 \\text{ W m}^{-2}","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>O</mi><mi>L</mi><mi>R</mi><mo>=</mo><mn>238.5</mn><msup><mtext> W m</mtext><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">OLR = 238.5 \\text{ W m}^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8873em;\"></span><span class=\"mord\">238.5</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> W m</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8873em;\"><span style=\"top:-3.1362em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"K7lSxMuca2"}],"key":"Lee3b06zaR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Initialize a model in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SedgGE5erD"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bCsNhhrb2s"}],"identifier":"initialize-a-model-in-climlab","label":"Initialize a model in climlab","html_id":"initialize-a-model-in-climlab","implicit":true,"key":"smFMFiS1os"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The first thing we do is create a new model.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W811gripV6"}],"key":"ehhwp4bc8i"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The following example code is sparsely commented but will hopefully orient you on the basics of defining and working with a ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bD81piIOl0"},{"type":"inlineCode","value":"climlab Process","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bQnIUFlkxv"},{"type":"text","value":" object.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sX8YbcAnPp"}],"key":"V3AzvfiiKV"}],"key":"DI6hV9TEGw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Test in a 2-layer atmosphere\ncol = climlab.GreyRadiationModel(num_lev=2)\nprint( col)","key":"qPvTOzGi0F"},{"type":"output","id":"BMXnt1iadywlfQrgHsMSu","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.GreyRadiationModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (2,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.GreyRadiationModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n\n"}],"key":"DRnce26fn8"}],"key":"N3yFmHj77d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.subprocess","key":"DeCEkjCaPr"},{"type":"output","id":"yXUrItaR5KcE1wynYah0u","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"AttrDict({'LW': <climlab.radiation.greygas.GreyGas object at 0x175299940>, 'SW': <climlab.radiation.greygas.GreyGasSW object at 0x175299a90>, 'insolation': <climlab.radiation.insolation.FixedInsolation object at 0x175299be0>})","content_type":"text/plain"}}}],"key":"lJTkU5Vh6m"}],"key":"dOjll5JGL1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Every item in the above dictionary is itself an instance of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BmPyPIKJEK"},{"type":"inlineCode","value":"climlab.Process","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MtqaQCIWYw"},{"type":"text","value":" object:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J2JJCEn5nP"}],"key":"H3ifOMrrdR"}],"key":"NPuDBzcrZu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( col.subprocess['LW'])","key":"MzBjfXCBsv"},{"type":"output","id":"SPho4ouyKuYNbCa4GueLg","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.radiation.greygas.GreyGas'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (2,) \nThe subprocess tree: \nUntitled: <class 'climlab.radiation.greygas.GreyGas'>\n\n"}],"key":"iy4iuMqY6i"}],"key":"jFQVK1Jd2x"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DqK0mikdtm"},{"type":"inlineCode","value":"state","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zu0o4aZugY"},{"type":"text","value":" dictionary holds the state variables of the model. In this case, temperatures:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mrnRYB66To"}],"key":"xE0p0blTzU"}],"key":"xczt5quubg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"climlab.to_xarray(col.state)","key":"bYOYXcg23U"},{"type":"output","id":"kyb1NDl1xo937E5-yGbQH","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 88B\nDimensions:       (depth: 1, depth_bounds: 2, lev: 2, lev_bounds: 3)\nCoordinates:\n  * depth         (depth) float64 8B 0.5\n  * depth_bounds  (depth_bounds) float64 16B 0.0 1.0\n  * lev           (lev) float64 16B 250.0 750.0\n  * lev_bounds    (lev_bounds) float64 24B 0.0 500.0 1e+03\nData variables:\n    Ts            (depth) float64 8B 288.0\n    Tatm          (lev) float64 16B 200.0 278.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ec755783-9f21-4f36-8298-975aa6878c67' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ec755783-9f21-4f36-8298-975aa6878c67' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>depth</span>: 1</li><li><span class='xr-has-index'>depth_bounds</span>: 2</li><li><span class='xr-has-index'>lev</span>: 2</li><li><span class='xr-has-index'>lev_bounds</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-94e6748a-78f2-4b4e-a962-5c94ec3e40e8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-94e6748a-78f2-4b4e-a962-5c94ec3e40e8' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5</div><input id='attrs-7660c3f2-6600-4457-82c2-a1614aff68ff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7660c3f2-6600-4457-82c2-a1614aff68ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eaba9e4f-7fd4-4c5a-994e-9197103c8c01' class='xr-var-data-in' type='checkbox'><label for='data-eaba9e4f-7fd4-4c5a-994e-9197103c8c01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><pre>array([0.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth_bounds</span></div><div class='xr-var-dims'>(depth_bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0</div><input id='attrs-a4bc3c56-751f-4443-ad7d-d38a5e44d5dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a4bc3c56-751f-4443-ad7d-d38a5e44d5dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-559e2ac1-3fd5-466e-8097-453e8d17d13a' class='xr-var-data-in' type='checkbox'><label for='data-559e2ac1-3fd5-466e-8097-453e8d17d13a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><pre>array([0., 1.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>250.0 750.0</div><input id='attrs-aa504f49-31c0-41e4-b650-96979839901a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa504f49-31c0-41e4-b650-96979839901a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7302ec06-0973-4955-baa4-26759e693caf' class='xr-var-data-in' type='checkbox'><label for='data-7302ec06-0973-4955-baa4-26759e693caf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mb</dd></dl></div><div class='xr-var-data'><pre>array([250., 750.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev_bounds</span></div><div class='xr-var-dims'>(lev_bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 500.0 1e+03</div><input id='attrs-896bd9e7-fac8-477b-b4c5-f7717822030d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-896bd9e7-fac8-477b-b4c5-f7717822030d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fde8ee55-62ab-4936-b609-0886247c6e1c' class='xr-var-data-in' type='checkbox'><label for='data-fde8ee55-62ab-4936-b609-0886247c6e1c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mb</dd></dl></div><div class='xr-var-data'><pre>array([   0.,  500., 1000.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-466d6b3f-b2ef-4811-85e6-d56fffb9cb7e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-466d6b3f-b2ef-4811-85e6-d56fffb9cb7e' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Ts</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>288.0</div><input id='attrs-7b0a49ce-6ae9-46b4-b887-f5734c1ed1fe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b0a49ce-6ae9-46b4-b887-f5734c1ed1fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5d25ce7-2609-4278-b714-97e5f0c7c03f' class='xr-var-data-in' type='checkbox'><label for='data-a5d25ce7-2609-4278-b714-97e5f0c7c03f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>Field([288.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tatm</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>200.0 278.0</div><input id='attrs-606fc48b-c3ee-4715-905d-93a63fea0e95' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-606fc48b-c3ee-4715-905d-93a63fea0e95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5da0062f-db30-47ec-8ffe-524e49b8cabf' class='xr-var-data-in' type='checkbox'><label for='data-5da0062f-db30-47ec-8ffe-524e49b8cabf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>Field([200., 278.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dcc65899-8722-40ae-ab04-6bcf5871466b' class='xr-section-summary-in' type='checkbox'  ><label for='section-dcc65899-8722-40ae-ab04-6bcf5871466b' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>depth</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8fb9879b-70d3-4960-8b29-d75506aab94b' class='xr-index-data-in' type='checkbox'/><label for='index-8fb9879b-70d3-4960-8b29-d75506aab94b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.5], dtype=&#x27;float64&#x27;, name=&#x27;depth&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>depth_bounds</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2faf1d1c-b599-4992-8b61-9a7889a40976' class='xr-index-data-in' type='checkbox'/><label for='index-2faf1d1c-b599-4992-8b61-9a7889a40976' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.0, 1.0], dtype=&#x27;float64&#x27;, name=&#x27;depth_bounds&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fa90c5a9-2a87-4543-b643-87d811fbe8fa' class='xr-index-data-in' type='checkbox'/><label for='index-fa90c5a9-2a87-4543-b643-87d811fbe8fa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([250.0, 750.0], dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev_bounds</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-738c1a37-1e56-469e-8040-88826003e03a' class='xr-index-data-in' type='checkbox'/><label for='index-738c1a37-1e56-469e-8040-88826003e03a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.0, 500.0, 1000.0], dtype=&#x27;float64&#x27;, name=&#x27;lev_bounds&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0fd6b68d-c685-4b13-89fc-5512dd164ca8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0fd6b68d-c685-4b13-89fc-5512dd164ca8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.Dataset> Size: 88B\nDimensions:       (depth: 1, depth_bounds: 2, lev: 2, lev_bounds: 3)\nCoordinates:\n  * depth         (depth) float64 8B 0.5\n  * depth_bounds  (depth_bounds) float64 16B 0.0 1.0\n  * lev           (lev) float64 16B 250.0 750.0\n  * lev_bounds    (lev_bounds) float64 24B 0.0 500.0 1e+03\nData variables:\n    Ts            (depth) float64 8B 288.0\n    Tatm          (lev) float64 16B 200.0 278.0","content_type":"text/plain"}}}],"key":"uAqT6a0I94"}],"key":"P3B3pvT5Qr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Access these either through dictionary methods or as attributes of the model object:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GMUBwmdcUe"}],"key":"jzOMaAf5T1"}],"key":"C0z60u8V71"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print( col.state['Ts'])\nprint( col.Ts)\ncol.Ts is col.state['Ts']","key":"mdEV22jclx"},{"type":"output","id":"-C2GFkFQW6i7OkOygyDh_","data":[{"name":"stdout","output_type":"stream","text":"[288.]\n[288.]\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"True","content_type":"text/plain"}}}],"key":"iTbvzKclbN"}],"key":"DoOmF2wUBQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we are assigning the “observed” temperatures to our model state:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z0ACNzE2vK"}],"key":"FLvuny0xyU"}],"key":"pbFQKnkEPQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.Ts[:] = 288.\ncol.Tatm[:] = np.array([230., 275.])\nclimlab.to_xarray(col.state)","key":"w5NmL9tdcF"},{"type":"output","id":"tpX8ZyHtDYLnDpvWvq-6W","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 88B\nDimensions:       (depth: 1, depth_bounds: 2, lev: 2, lev_bounds: 3)\nCoordinates:\n  * depth         (depth) float64 8B 0.5\n  * depth_bounds  (depth_bounds) float64 16B 0.0 1.0\n  * lev           (lev) float64 16B 250.0 750.0\n  * lev_bounds    (lev_bounds) float64 24B 0.0 500.0 1e+03\nData variables:\n    Ts            (depth) float64 8B 288.0\n    Tatm          (lev) float64 16B 230.0 275.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5bffb3cb-a5a7-4bf3-a18e-8df02c72d95e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5bffb3cb-a5a7-4bf3-a18e-8df02c72d95e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>depth</span>: 1</li><li><span class='xr-has-index'>depth_bounds</span>: 2</li><li><span class='xr-has-index'>lev</span>: 2</li><li><span class='xr-has-index'>lev_bounds</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f3b77571-f7eb-4e8d-80c5-cf291e0297bd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f3b77571-f7eb-4e8d-80c5-cf291e0297bd' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5</div><input id='attrs-d529d768-b3da-4e8e-84c3-b746d8691ffb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d529d768-b3da-4e8e-84c3-b746d8691ffb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-112feee4-ebe3-4441-8356-f858ec3c5573' class='xr-var-data-in' type='checkbox'><label for='data-112feee4-ebe3-4441-8356-f858ec3c5573' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><pre>array([0.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth_bounds</span></div><div class='xr-var-dims'>(depth_bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0</div><input id='attrs-92823664-323f-412a-9a3c-ee17b1824eb7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92823664-323f-412a-9a3c-ee17b1824eb7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9413d3ea-3442-4754-bb1a-0f5432b557e2' class='xr-var-data-in' type='checkbox'><label for='data-9413d3ea-3442-4754-bb1a-0f5432b557e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><pre>array([0., 1.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>250.0 750.0</div><input id='attrs-f0d9c918-d35a-4a22-a3b9-9be854733268' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f0d9c918-d35a-4a22-a3b9-9be854733268' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3ad1c86-6b2b-4c6f-8367-a024f2f8eb84' class='xr-var-data-in' type='checkbox'><label for='data-a3ad1c86-6b2b-4c6f-8367-a024f2f8eb84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mb</dd></dl></div><div class='xr-var-data'><pre>array([250., 750.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev_bounds</span></div><div class='xr-var-dims'>(lev_bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 500.0 1e+03</div><input id='attrs-454caa75-6e71-4d55-9607-1a794424b60b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-454caa75-6e71-4d55-9607-1a794424b60b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3f6a51a-23c8-4280-bf32-d514aef83437' class='xr-var-data-in' type='checkbox'><label for='data-b3f6a51a-23c8-4280-bf32-d514aef83437' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mb</dd></dl></div><div class='xr-var-data'><pre>array([   0.,  500., 1000.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-99da4a31-85d6-4687-aaeb-060458a223f6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-99da4a31-85d6-4687-aaeb-060458a223f6' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Ts</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>288.0</div><input id='attrs-435e8f68-34c1-443e-9670-43e68adf3340' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-435e8f68-34c1-443e-9670-43e68adf3340' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bbc48da-3558-4df9-b691-66f612b2aa53' class='xr-var-data-in' type='checkbox'><label for='data-4bbc48da-3558-4df9-b691-66f612b2aa53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>Field([288.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tatm</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>230.0 275.0</div><input id='attrs-ee546d4b-64de-4fbd-ad52-3f5daea7e51f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ee546d4b-64de-4fbd-ad52-3f5daea7e51f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0860c12a-ad4d-4915-999d-f6c15fd948bd' class='xr-var-data-in' type='checkbox'><label for='data-0860c12a-ad4d-4915-999d-f6c15fd948bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>Field([230., 275.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fedb2785-c417-4725-86da-878fa1191953' class='xr-section-summary-in' type='checkbox'  ><label for='section-fedb2785-c417-4725-86da-878fa1191953' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>depth</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3ce784c7-e9bb-466d-a6a9-8317576ee829' class='xr-index-data-in' type='checkbox'/><label for='index-3ce784c7-e9bb-466d-a6a9-8317576ee829' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.5], dtype=&#x27;float64&#x27;, name=&#x27;depth&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>depth_bounds</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-35f4a1de-08f9-4c47-b430-6a22b494ea55' class='xr-index-data-in' type='checkbox'/><label for='index-35f4a1de-08f9-4c47-b430-6a22b494ea55' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.0, 1.0], dtype=&#x27;float64&#x27;, name=&#x27;depth_bounds&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4727dbb6-aaf1-40a7-8a5b-c0aeda295382' class='xr-index-data-in' type='checkbox'/><label for='index-4727dbb6-aaf1-40a7-8a5b-c0aeda295382' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([250.0, 750.0], dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev_bounds</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cc735dc2-1c2e-4a98-9fa0-933b0fe59a70' class='xr-index-data-in' type='checkbox'/><label for='index-cc735dc2-1c2e-4a98-9fa0-933b0fe59a70' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.0, 500.0, 1000.0], dtype=&#x27;float64&#x27;, name=&#x27;lev_bounds&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d301e677-0446-4ed3-9536-1a0ce9c11de7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d301e677-0446-4ed3-9536-1a0ce9c11de7' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.Dataset> Size: 88B\nDimensions:       (depth: 1, depth_bounds: 2, lev: 2, lev_bounds: 3)\nCoordinates:\n  * depth         (depth) float64 8B 0.5\n  * depth_bounds  (depth_bounds) float64 16B 0.0 1.0\n  * lev           (lev) float64 16B 250.0 750.0\n  * lev_bounds    (lev_bounds) float64 24B 0.0 500.0 1e+03\nData variables:\n    Ts            (depth) float64 8B 288.0\n    Tatm          (lev) float64 16B 230.0 275.0","content_type":"text/plain"}}}],"key":"xUQAMTpB0B"}],"key":"BGjj9ueGrO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"LW = col.subprocess['LW']\nprint(LW)","key":"QAak1YbhYt"},{"type":"output","id":"0BivEo-OxDRxvsSzdz_de","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.radiation.greygas.GreyGas'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (2,) \nThe subprocess tree: \nUntitled: <class 'climlab.radiation.greygas.GreyGas'>\n\n"}],"key":"TdHQ8algkm"}],"key":"hsmGw0UdKw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"LW.absorptivity","key":"xeUaJ4bIBF"},{"type":"output","id":"SCnUVD5H9M19gWhWoyDnZ","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"Field([0.47737425, 0.47737425])","content_type":"text/plain"}}}],"key":"JFozjwHMFe"}],"key":"WGDz4Z8eQI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  copying the tuned value of epsilon from Lecture 6 notes\nLW.absorptivity = 0.586\nLW.absorptivity","key":"JH7Qt2Naye"},{"type":"output","id":"TlvxaADA4yaONodoA4eU-","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"Field([0.586, 0.586])","content_type":"text/plain"}}}],"key":"gG4KeqLFly"}],"key":"Nd2srVyvIZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  This does all the calculations that would be performed at each time step, \n#  but doesn't actually update the temperatures\ncol.compute_diagnostics()\n#  Print out the dictionary\ncol.diagnostics","key":"OsB2DHZzCU"},{"type":"output","id":"1Z61vuhYpTNJEThPC31oL","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"{'flux_from_sfc': Field([492.15372995]),\n 'flux_to_sfc': Field([569.83426769]),\n 'flux_to_space': Field([340.5734311]),\n 'absorbed': Field([ 20.02990881, -96.98387764]),\n 'absorbed_total': Field([-76.95396883]),\n 'emission': Field([ 92.98664086, 190.03779837]),\n 'emission_sfc': Field([390.10502995]),\n 'insolation': Field([341.3]),\n 'coszen': Field([1.]),\n 'irradiance_factor': Field([0.]),\n 'OLR': Field([238.5247311]),\n 'LW_down_sfc': Field([228.53426769]),\n 'LW_up_sfc': Field([390.10502995]),\n 'LW_absorbed_sfc': Field([-161.57076227]),\n 'ASR': Field([239.2513]),\n 'SW_absorbed_sfc': Field([239.2513]),\n 'SW_up_sfc': Field([102.0487]),\n 'SW_up_TOA': Field([102.0487]),\n 'SW_down_TOA': Field([341.3]),\n 'SW_down_sfc': Field([341.3]),\n 'planetary_albedo': Field([0.299]),\n 'LW_emission': Field([ 92.98664086, 190.03779837]),\n 'LW_absorbed_atm': Field([ 20.02990881, -96.98387764]),\n 'SW_absorbed_atm': Field([0., 0.])}","content_type":"text/plain"}}}],"key":"LoCxOrYCkz"}],"key":"duoxeI94Gf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Check OLR against our analytical solution\ncol.OLR","key":"ZrOZUy5LXR"},{"type":"output","id":"8fyO9pZNMLm7WM4ULmn3U","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"Field([238.5247311])","content_type":"text/plain"}}}],"key":"Gtc5o1osJa"}],"key":"R30ZYMP2vS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Like the state variables, the diagnostics can also be accessed in two different ways\ncol.diagnostics['OLR']","key":"k2JDKCYIkM"},{"type":"output","id":"7G0HKQw1YbHuGYb9my2hh","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"Field([238.5247311])","content_type":"text/plain"}}}],"key":"ugNkx2IH64"}],"key":"RWsZwajXXo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.state","key":"DHdWGDjPsR"},{"type":"output","id":"N3mqbaE1dC2UYma7Gs-k9","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"AttrDict({'Ts': Field([288.]), 'Tatm': Field([230., 275.])})","content_type":"text/plain"}}}],"key":"a35VOCXCVt"}],"key":"ALYGduCoc1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# perform a single time step\ncol.step_forward()","key":"q5Qx1dPYUt"},{"type":"output","id":"ix5uMOxkwIRu58QIBKb-l","data":[],"key":"OTZOl9g7q8"}],"key":"mBVtqo2qsO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.state","key":"zy89URqw6M"},{"type":"output","id":"JlxlT_2Rn_7G59FDLiEdW","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"AttrDict({'Ts': Field([289.60514636]), 'Tatm': Field([230.33784312, 273.3641795 ])})","content_type":"text/plain"}}}],"key":"bhlTboF04c"}],"key":"t8aX9hdNNg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We just stepped forward one discreet unit in time. Because we didn’t specify a timestep when we created the model, it is set to a default value:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tq4OwoiTc4"}],"key":"HXDPgYYz1u"}],"key":"yIBSLZeu8y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.timestep","key":"RrRN2F6n2y"},{"type":"output","id":"fJgyeMual1nW1QqLMzEer","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"86400.0","content_type":"text/plain"}}}],"key":"NQtQq4lHDv"}],"key":"RQ3b8D7o8P"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"which is 1 day (expressed in seconds).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hi3xMTrJx5"}],"key":"PuGzLic6q0"}],"key":"bHLVGYtS0j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will integrate the model out to equilibrium.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i4ndqzURT8"}],"key":"IWFANGrgzG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We could easily write a loop to call the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yySHS9WaPx"},{"type":"inlineCode","value":"step_forward()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GqLUx6iT5E"},{"type":"text","value":" method many times.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"REHoio6bDU"}],"key":"jh2sjMPB80"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Or use a handy shortcut that allows us to specify the integration length in physical time units:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ldZHq5c2J2"}],"key":"NujF7N8IOA"}],"key":"rADCcSwhfF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# integrate out to radiative equilibrium\ncol.integrate_years(2.)","key":"CaOpLGzWOw"},{"type":"output","id":"YDjJYdja4dnN3AWe_WVvL","data":[{"name":"stdout","output_type":"stream","text":"Integrating for 730 steps, 730.4844 days, or 2.0 years.\nTotal elapsed time is 2.0014116660123062 years.\n"}],"key":"w5tOVXkThh"}],"key":"BvujRB8ns6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Check for equilibrium\ncol.ASR - col.OLR","key":"lOcoQqEbtf"},{"type":"output","id":"d1KI9ZNzlVV_AxqEizerr","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"Field([-2.34514459e-07])","content_type":"text/plain"}}}],"key":"wbMVNHwqrH"}],"key":"A69Jh01ZvH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  The temperatures at radiative equilibrium\ncol.state","key":"l5OglrowRn"},{"type":"output","id":"ohBfFZcavsPUXYorTWgFd","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"AttrDict({'Ts': Field([296.38447748]), 'Tatm': Field([233.72131685, 262.28540231])})","content_type":"text/plain"}}}],"key":"HPecSWqdi2"}],"key":"ln1gt4s1Wj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare these to the analytical solutions for radiative equilibrium with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YdeGJslYCJ"},{"type":"inlineMath","value":"\\epsilon = 0.58","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>0.58</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon = 0.58</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.58</span></span></span></span>","key":"iFSTYJlADc"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GOyK5O61HG"}],"key":"dj4MzjREbS"},{"type":"math","value":"\\begin{align}\nT_s &= 296.4 \\text{ K} \\\\\nT_0 &= 262.3 \\text{ K} \\\\\nT_1 &= 233.8 \\text{ K} \\\\\n\\end{align}","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mi>s</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>296.4</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>262.3</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>T</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>233.8</mn><mtext> K</mtext></mrow></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\nT_s &amp;= 296.4 \\text{ K} \\\\\nT_0 &amp;= 262.3 \\text{ K} \\\\\nT_1 &amp;= 233.8 \\text{ K} \\\\\n\\end{align}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.5em;vertical-align:-2em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">296.4</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span><span style=\"top:-3.16em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">262.3</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span><span style=\"top:-1.66em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">233.8</span><span class=\"mord text\"><span class=\"mord\"> K</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5em;\"><span style=\"top:-4.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:2.84em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"SMSB2yb7mF"}],"key":"fXt73gTdfg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So it looks like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c0kNVfawTb"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mjTUH33h6z"},{"type":"text","value":" agrees with our analytical results to within 0.1 K. That’s good.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lW6WVPiepO"}],"key":"aAX3sQsvH6"}],"key":"fociwW71b2"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"omkPr2ML6b"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"3. The observed annual, global mean temperature profile","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NKPyIQ532m"}],"identifier":"id-3-the-observed-annual-global-mean-temperature-profile","label":"3. The observed annual, global mean temperature profile","html_id":"id-3-the-observed-annual-global-mean-temperature-profile","implicit":true,"key":"fzwUlwg2f1"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yZzFJKqXbs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We want to model the ","key":"nmSs1TTmrL"},{"type":"abbreviation","title":"Outgoing Longwave Radiation","children":[{"type":"text","value":"OLR","key":"RQvYHDKwU3"}],"key":"HrhqWPSc1o"},{"type":"text","value":" in a column whose temperatures match observations. As we’ve done before, we’ll calcu","key":"rn3fXg58wQ"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"tC4nqYkqVq"}],"key":"PxhMHhig4T"},{"type":"text","value":"e the global, annual mean air temperature from the ","key":"YyHQIP7Rgz"},{"type":"abbreviation","title":"National Centers for Environmental Prediction","children":[{"type":"text","value":"NCEP","key":"I8KNekzbRF"}],"key":"YQ5xu77rFR"},{"type":"text","value":" Reanalysis data.","key":"V5xmAENibO"}],"key":"VWyTI6aXfw"}],"key":"Kc9UeqR1nD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## The NOAA ESRL server is shutdown! January 2019\n## This will try to read the data over the internet.\nncep_filename = 'air.mon.1981-2010.ltm.nc'\n##  to read over internet\nncep_url = \"http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/ncep.reanalysis.derived/pressure/\"\npath = ncep_url\n##  Open handle to data\nncep_air = xr.open_dataset( path + ncep_filename, decode_times=False )\n\n#url = 'http://apdrc.soest.hawaii.edu:80/dods/public_data/Reanalysis_Data/NCEP/NCEP/clima/pressure/air'\n#air = xr.open_dataset(url)\n# The name of the vertical axis is different than the NOAA ESRL version..\n#ncep_air = air.rename({'lev': 'level'})\nncep_air","key":"QKQ0ldNOvx"},{"type":"output","id":"UiFOCChQ2Z1sWdj3SP71I","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"fe47d2cf4962f86dd31f5bdac5ae2dff","path":"/ClimateLaboratoryBook/_preview/178/build/fe47d2cf4962f86dd31f5bdac5ae2dff.html"},"text/plain":{"content":"<xarray.Dataset> Size: 17MB\nDimensions:             (level: 17, lon: 144, time: 12, lat: 73, nbnds: 2)\nCoordinates:\n  * level               (level) float32 68B 1e+03 925.0 850.0 ... 30.0 20.0 10.0\n  * lon                 (lon) float32 576B 0.0 2.5 5.0 7.5 ... 352.5 355.0 357.5\n  * time                (time) float64 96B -6.571e+05 -6.57e+05 ... -6.567e+05\n  * lat                 (lat) float32 292B 90.0 87.5 85.0 ... -85.0 -87.5 -90.0\nDimensions without coordinates: nbnds\nData variables:\n    climatology_bounds  (time, nbnds) float64 192B ...\n    air                 (time, level, lat, lon) float32 9MB ...\n    valid_yr_count      (time, level, lat, lon) float32 9MB ...\nAttributes:\n    description:                     Data from NCEP initialized reanalysis (4...\n    platform:                       Model\n    Conventions:                    COARDS\n    not_missing_threshold_percent:  minimum 3% values input to have non-missi...\n    history:                        Created 2011/07/12 by doMonthLTM\\nConvert...\n    title:                          monthly ltm air from the NCEP Reanalysis\n    dataset_title:                  NCEP-NCAR Reanalysis 1\n    References:                     http://www.psl.noaa.gov/data/gridded/data...\n    _NCProperties:                  version=2,netcdf=4.6.3,hdf5=1.10.5","content_type":"text/plain"}}}],"key":"chRK7I8HcY"}],"key":"OrbtgAEhgF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Take global, annual average and convert to Kelvin\nweight = cos(deg2rad(ncep_air.lat)) / cos(deg2rad(ncep_air.lat)).mean(dim='lat')\nTglobal = (ncep_air.air * weight).mean(dim=('lat','lon','time'))\nTglobal","key":"jnwacvsD8d"},{"type":"output","id":"EIpcAUbWPn8jGblfvxa3v","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (level: 17)&gt; Size: 68B\narray([ 15.179084  ,  11.207003  ,   7.8383274 ,   0.21994135,\n        -6.4483433 , -14.888848  , -25.570469  , -39.36969   ,\n       -46.797905  , -53.652245  , -60.56356   , -67.006065  ,\n       -65.53293   , -61.48664   , -55.853584  , -51.593952  ,\n       -43.21999   ], dtype=float32)\nCoordinates:\n  * level    (level) float32 68B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>level</span>: 17</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e313d2a2-121c-4a1a-a0ae-4e7c62c2d7fc' class='xr-array-in' type='checkbox' checked><label for='section-e313d2a2-121c-4a1a-a0ae-4e7c62c2d7fc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>15.18 11.21 7.838 0.2199 -6.448 ... -65.53 -61.49 -55.85 -51.59 -43.22</span></div><div class='xr-array-data'><pre>array([ 15.179084  ,  11.207003  ,   7.8383274 ,   0.21994135,\n        -6.4483433 , -14.888848  , -25.570469  , -39.36969   ,\n       -46.797905  , -53.652245  , -60.56356   , -67.006065  ,\n       -65.53293   , -61.48664   , -55.853584  , -51.593952  ,\n       -43.21999   ], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-69ac7b7a-a39f-453c-bed1-665500328572' class='xr-section-summary-in' type='checkbox'  checked><label for='section-69ac7b7a-a39f-453c-bed1-665500328572' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 20.0 10.0</div><input id='attrs-19859f0d-2e4f-4e3e-8788-36edeb422bfc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19859f0d-2e4f-4e3e-8788-36edeb422bfc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae6c9608-1530-44f8-bcd7-0c5bbfade32e' class='xr-var-data-in' type='checkbox'><label for='data-ae6c9608-1530-44f8-bcd7-0c5bbfade32e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>millibar</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.,  250.,  200.,\n        150.,  100.,   70.,   50.,   30.,   20.,   10.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9f8bede0-e258-4b29-9711-cbbfbf0fc6d9' class='xr-section-summary-in' type='checkbox'  ><label for='section-9f8bede0-e258-4b29-9711-cbbfbf0fc6d9' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-eebc7584-4634-45c6-9c1a-e03bb68e81dc' class='xr-index-data-in' type='checkbox'/><label for='index-eebc7584-4634-45c6-9c1a-e03bb68e81dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1000.0,  925.0,  850.0,  700.0,  600.0,  500.0,  400.0,  300.0,  250.0,\n        200.0,  150.0,  100.0,   70.0,   50.0,   30.0,   20.0,   10.0],\n      dtype=&#x27;float32&#x27;, name=&#x27;level&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1023eadd-dfbc-4a15-b530-3e4392029ac8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1023eadd-dfbc-4a15-b530-3e4392029ac8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (level: 17)> Size: 68B\narray([ 15.179084  ,  11.207003  ,   7.8383274 ,   0.21994135,\n        -6.4483433 , -14.888848  , -25.570469  , -39.36969   ,\n       -46.797905  , -53.652245  , -60.56356   , -67.006065  ,\n       -65.53293   , -61.48664   , -55.853584  , -51.593952  ,\n       -43.21999   ], dtype=float32)\nCoordinates:\n  * level    (level) float32 68B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0","content_type":"text/plain"}}}],"key":"jiZFDE1xpn"}],"key":"FbsFqh4Xlk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’re going to convert this to degrees Kelvin, using a handy list of pre-defined constants in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"olNxH2OoLJ"},{"type":"inlineCode","value":"climlab.constants","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EpxO5bq25l"}],"key":"AZLORIR1qu"}],"key":"PT6QTEqhsf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"climlab.constants.tempCtoK","key":"fLABkJ0mFE"},{"type":"output","id":"8kBNbO2HKpfh64cnDLVI9","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"273.15","content_type":"text/plain"}}}],"key":"kkFQExdZT8"}],"key":"Nl70Eqp5kM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Tglobal += climlab.constants.tempCtoK\nTglobal","key":"EHYCT1csO9"},{"type":"output","id":"0S_DNGptuaaiuSHwZ5OOe","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (level: 17)&gt; Size: 68B\narray([288.32907, 284.357  , 280.9883 , 273.36993, 266.70166, 258.26114,\n       247.57953, 233.7803 , 226.35208, 219.49774, 212.58643, 206.14392,\n       207.61707, 211.66336, 217.29642, 221.55605, 229.93001],\n      dtype=float32)\nCoordinates:\n  * level    (level) float32 68B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>level</span>: 17</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-48cbd301-d36c-4e43-982c-d6f709bc0031' class='xr-array-in' type='checkbox' checked><label for='section-48cbd301-d36c-4e43-982c-d6f709bc0031' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>288.3 284.4 281.0 273.4 266.7 258.3 ... 207.6 211.7 217.3 221.6 229.9</span></div><div class='xr-array-data'><pre>array([288.32907, 284.357  , 280.9883 , 273.36993, 266.70166, 258.26114,\n       247.57953, 233.7803 , 226.35208, 219.49774, 212.58643, 206.14392,\n       207.61707, 211.66336, 217.29642, 221.55605, 229.93001],\n      dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-a569f198-6cf1-4c38-8d14-be67c934c368' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a569f198-6cf1-4c38-8d14-be67c934c368' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 925.0 850.0 ... 20.0 10.0</div><input id='attrs-36fa1778-9a44-4575-ac71-9a5ab16dfa7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36fa1778-9a44-4575-ac71-9a5ab16dfa7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da3a60e7-a6e8-48d5-9ee4-a2f571cf61e4' class='xr-var-data-in' type='checkbox'><label for='data-da3a60e7-a6e8-48d5-9ee4-a2f571cf61e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>millibar</dd><dt><span>long_name :</span></dt><dd>Level</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>GRIB_id :</span></dt><dd>100</dd><dt><span>GRIB_name :</span></dt><dd>hPa</dd><dt><span>actual_range :</span></dt><dd>[1000.   10.]</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  925.,  850.,  700.,  600.,  500.,  400.,  300.,  250.,  200.,\n        150.,  100.,   70.,   50.,   30.,   20.,   10.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-730051da-d615-41d8-81e1-41c0b31a19f0' class='xr-section-summary-in' type='checkbox'  ><label for='section-730051da-d615-41d8-81e1-41c0b31a19f0' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3f1d80a7-07e9-4104-a865-fa4f7f2a2268' class='xr-index-data-in' type='checkbox'/><label for='index-3f1d80a7-07e9-4104-a865-fa4f7f2a2268' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1000.0,  925.0,  850.0,  700.0,  600.0,  500.0,  400.0,  300.0,  250.0,\n        200.0,  150.0,  100.0,   70.0,   50.0,   30.0,   20.0,   10.0],\n      dtype=&#x27;float32&#x27;, name=&#x27;level&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-59b8b70e-15a0-44f5-8a15-023f7d1cce09' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-59b8b70e-15a0-44f5-8a15-023f7d1cce09' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (level: 17)> Size: 68B\narray([288.32907, 284.357  , 280.9883 , 273.36993, 266.70166, 258.26114,\n       247.57953, 233.7803 , 226.35208, 219.49774, 212.58643, 206.14392,\n       207.61707, 211.66336, 217.29642, 221.55605, 229.93001],\n      dtype=float32)\nCoordinates:\n  * level    (level) float32 68B 1e+03 925.0 850.0 700.0 ... 50.0 30.0 20.0 10.0","content_type":"text/plain"}}}],"key":"HJS5WanFCs"}],"key":"k0gUjeZjhK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  A handy re-usable routine for making a plot of the temperature profiles\n#  We will plot temperatures with respect to log(pressure) to get a height-like coordinate\n\ndef zstar(lev):\n    return -np.log(lev / climlab.constants.ps)\n\ndef plot_soundings(result_list, name_list, plot_obs=True, fixed_range=True):\n    color_cycle=['r', 'g', 'b', 'y']\n    # col is either a column model object or a list of column model objects\n    #if isinstance(state_list, climlab.Process):\n    #    # make a list with a single item\n    #    collist = [collist]\n    fig, ax = plt.subplots(figsize=(9,9))\n    if plot_obs:\n        ax.plot(Tglobal, zstar(Tglobal.level), color='k', label='Observed')    \n    for i, state in enumerate(result_list):\n        Tatm = state['Tatm']\n        lev = Tatm.domain.axes['lev'].points\n        Ts = state['Ts']\n        ax.plot(Tatm, zstar(lev), color=color_cycle[i], label=name_list[i])\n        ax.plot(Ts, 0, 'o', markersize=12, color=color_cycle[i])\n    #ax.invert_yaxis()\n    yticks = np.array([1000., 750., 500., 250., 100., 50., 20., 10., 5.])\n    ax.set_yticks(-np.log(yticks/1000.))\n    ax.set_yticklabels(yticks)\n    ax.set_xlabel('Temperature (K)', fontsize=14)\n    ax.set_ylabel('Pressure (hPa)', fontsize=14)\n    ax.grid()\n    ax.legend()\n    if fixed_range:\n        ax.set_xlim([200, 300])\n        ax.set_ylim(zstar(np.array([1000., 5.])))\n    #ax2 = ax.twinx()\n    \n    return ax","key":"BkaHvcP2qr"},{"type":"output","id":"LzHoSZeTgeO6DQ3WtmIdW","data":[],"key":"gptwFDIHpa"}],"key":"PIU5e7ZC1v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_soundings([],[] );","key":"rBR6AFPwsn"},{"type":"output","id":"K3VE8idFDJq8Jnghd62di","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc009d0461850eb6034f0f6c6fa8e0ff","path":"/ClimateLaboratoryBook/_preview/178/build/fc009d0461850eb6034f0f6c6fa8e0ff.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"key":"Esr6ZZ8GLp"}],"key":"AZAqqhtXnH"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jpnXljZTEd"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"4. A 30-layer model using the observed temperatures","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Q2ssjE53Ph"}],"identifier":"id-4-a-30-layer-model-using-the-observed-temperatures","label":"4. A 30-layer model using the observed temperatures","html_id":"id-4-a-30-layer-model-using-the-observed-temperatures","implicit":true,"key":"rlI3tEQvO9"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RCEitjpn0q"}],"key":"dALlawTL8N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  initialize a grey radiation model with 30 levels\ncol = climlab.GreyRadiationModel()\nprint(col)","key":"n3vCQI6ev2"},{"type":"output","id":"iBkFDnbRup-uckUkWZ3XF","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.GreyRadiationModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (30,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.GreyRadiationModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n\n"}],"key":"gYCCylO1wu"}],"key":"g4JSSMUaW6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.lev","key":"UDhX9jqhqP"},{"type":"output","id":"cGZxZjfu4GvYi4CsbSuTd","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"array([ 16.66666667,  50.        ,  83.33333333, 116.66666667,\n       150.        , 183.33333333, 216.66666667, 250.        ,\n       283.33333333, 316.66666667, 350.        , 383.33333333,\n       416.66666667, 450.        , 483.33333333, 516.66666667,\n       550.        , 583.33333333, 616.66666667, 650.        ,\n       683.33333333, 716.66666667, 750.        , 783.33333333,\n       816.66666667, 850.        , 883.33333333, 916.66666667,\n       950.        , 983.33333333])","content_type":"text/plain"}}}],"key":"sVUiyx1brt"}],"key":"q4ndcDZDuK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.lev_bounds","key":"x6zdiKEihX"},{"type":"output","id":"4EEeP33_91ywKdefq2qgD","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"array([   0.        ,   33.33333333,   66.66666667,  100.        ,\n        133.33333333,  166.66666667,  200.        ,  233.33333333,\n        266.66666667,  300.        ,  333.33333333,  366.66666667,\n        400.        ,  433.33333333,  466.66666667,  500.        ,\n        533.33333333,  566.66666667,  600.        ,  633.33333333,\n        666.66666667,  700.        ,  733.33333333,  766.66666667,\n        800.        ,  833.33333333,  866.66666667,  900.        ,\n        933.33333333,  966.66666667, 1000.        ])","content_type":"text/plain"}}}],"key":"zV5heHDYev"}],"key":"vwJAJ5lUlj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# interpolate to 30 evenly spaced pressure levels\nlev = col.lev\nTinterp = np.interp(lev, np.flipud(Tglobal.level), np.flipud(Tglobal))\nTinterp\n#  Need to 'flipud' because the interpolation routine \n#  needs the pressure data to be in increasing order","key":"spK8pqIwAn"},{"type":"output","id":"lul3PVJuJa27xE1ekXmcq","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"array([224.34736633, 211.6633606 , 206.96233453, 208.29142253,\n       212.58642578, 217.19396973, 221.78252157, 226.3520813 ,\n       231.30422974, 236.08017476, 240.67991638, 245.279658  ,\n       249.35979716, 252.92033386, 256.48087056, 259.66789246,\n       262.48139954, 265.29490662, 267.81303914, 270.03579712,\n       272.25855509, 274.21642049, 275.90939331, 277.60236613,\n       279.29533895, 280.98831177, 282.48550415, 283.98269653,\n       285.6810201 , 287.4463874 ])","content_type":"text/plain"}}}],"key":"d6fmPdImlK"}],"key":"beLnRSGuoq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Initialize model with observed temperatures\ncol.Ts[:] = Tglobal[0]\ncol.Tatm[:] = Tinterp","key":"pGGM8LShUN"},{"type":"output","id":"BLXYp0lqt-X97OuftdOcR","data":[],"key":"mlVIBCN5KN"}],"key":"NBrDInaubD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# This should look just like the observations\nresult_list = [col.state]\nname_list = ['Observed, interpolated']\nplot_soundings(result_list, name_list);","key":"F3SMhjs96y"},{"type":"output","id":"BeSXwtOtx44A-n7C73dwP","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aabdc96e293daff157c615cf52f683f6","path":"/ClimateLaboratoryBook/_preview/178/build/aabdc96e293daff157c615cf52f683f6.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"key":"t2LmLbwz06"}],"key":"TjfcciL7hc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Tune absorptivity to get observed ","key":"qlFiklqoFE"},{"type":"abbreviation","title":"Outgoing Longwave Radiation","children":[{"type":"text","value":"OLR","key":"vgpwJMeCiB"}],"key":"ha3NMpPxi6"}],"identifier":"tune-absorptivity-to-get-observed-olr","label":"Tune absorptivity to get observed OLR","html_id":"tune-absorptivity-to-get-observed-olr","implicit":true,"key":"K3Wnjfaowo"}],"key":"vQqq7ksp25"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.compute_diagnostics()\ncol.OLR","key":"x2eQDckBMV"},{"type":"output","id":"K7YIcHyusZ7MDJwuLhiWs","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"Field([263.15000104])","content_type":"text/plain"}}}],"key":"ot9m6PICsf"}],"key":"i3bzGRni8u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Need to tune absorptivity to get OLR = 238.5\nepsarray = np.linspace(0.01, 0.1, 100)\nOLRarray = np.zeros_like(epsarray)","key":"pcRTuYOGBO"},{"type":"output","id":"3oacRt_3piwJmL-2-5nBD","data":[],"key":"RAtR6BomgV"}],"key":"OSludDNGm1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for i in range(epsarray.size):\n    col.subprocess['LW'].absorptivity = epsarray[i]\n    col.compute_diagnostics()\n    OLRarray[i] = col.OLR\n\nplt.plot(epsarray, OLRarray)\nplt.grid()\nplt.xlabel('epsilon')\nplt.ylabel('OLR')","key":"L4SgVrSF0e"},{"type":"output","id":"9sjNAjJP8EzX6rvN9zpiA","data":[{"name":"stderr","output_type":"stream","text":"/var/folders/dl/j7hb106d36n501mrm8j646bxpf4y1c/T/ipykernel_73539/877072619.py:4: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)\n  OLRarray[i] = col.OLR\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0094f820b9118f2f8800428bab332dcc","path":"/ClimateLaboratoryBook/_preview/178/build/0094f820b9118f2f8800428bab332dcc.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"WclRP8htwz"}],"key":"FCyjmt12sO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The necessary value seems to lie near 0.055 or so.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mWi3t3ejDv"}],"key":"a0xkoUICfb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can be more precise with a numerical root-finder.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BkpZbhYgkz"}],"key":"zH13eKWc7E"}],"key":"Bc7NXJU3jH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def OLRanom(eps):\n    col.subprocess['LW'].absorptivity = eps\n    col.compute_diagnostics()\n    return col.OLR - 238.5","key":"jhvajd3fbi"},{"type":"output","id":"6FEBQrVjq5z-4IYkB-ieV","data":[],"key":"S4MxtbyzBa"}],"key":"ovwnJctAJQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Use numerical root-finding to get the equilibria\nfrom scipy.optimize import brentq\n# brentq is a root-finding function\n#  Need to give it a function and two end-points\n#  It will look for a zero of the function between those end-points\neps = brentq(OLRanom, 0.01, 0.1)\nprint( eps)","key":"XlUMrNBIX8"},{"type":"output","id":"Lv42Dm0RvscIO5WsyTXll","data":[{"name":"stdout","output_type":"stream","text":"0.05369073166506249\n"}],"key":"dwvM9dNlsy"}],"key":"yqce4KZXvG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.subprocess.LW.absorptivity = eps\ncol.subprocess.LW.absorptivity","key":"pYxa0mKHB9"},{"type":"output","id":"NvaV7uv26n9SBTm4x_TBi","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"Field([0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073,\n       0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073,\n       0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073,\n       0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073,\n       0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073,\n       0.05369073, 0.05369073, 0.05369073, 0.05369073, 0.05369073])","content_type":"text/plain"}}}],"key":"oyGKs9MnkG"}],"key":"MK0IMN25z5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col.compute_diagnostics()\ncol.OLR","key":"pzBKeU4DWy"},{"type":"output","id":"uT6VBIvUSIrquyBL1U0Ve","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"Field([238.5])","content_type":"text/plain"}}}],"key":"GavRmvjCuv"}],"key":"L0IdGajgOU"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ntl5XDO1Jj"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"5. Radiative forcing in the 30-layer model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yBDbUrfpd8"}],"identifier":"id-5-radiative-forcing-in-the-30-layer-model","label":"5. Radiative forcing in the 30-layer model","html_id":"id-5-radiative-forcing-in-the-30-layer-model","implicit":true,"key":"Om5e9LaJvS"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tbsZtDCUpj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Let’s compute radiative forcing for a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iFlZaRaE3M"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2% increase in absorptivity","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jgxpDcRQlu"}],"key":"FA3x5dKOo4"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tbOBvrm02l"}],"key":"yMHWA26dBJ"}],"key":"X9LVjsiXxF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  clone our model using a built-in climlab function\ncol2 = climlab.process_like(col)\nprint(col2)","key":"ooqr32i4Eb"},{"type":"output","id":"mHa6Uy8r4mTw1KDwHjZSo","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.GreyRadiationModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (30,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.GreyRadiationModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n\n"}],"key":"IwQZ2DleLM"}],"key":"ypkcpolKkv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col2.subprocess['LW'].absorptivity *= 1.02\ncol2.subprocess['LW'].absorptivity","key":"Wt7M8fzPz2"},{"type":"output","id":"fnxIa7gr4aX0pJObDk2AE","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"Field([0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455,\n       0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455,\n       0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455,\n       0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455,\n       0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455,\n       0.05476455, 0.05476455, 0.05476455, 0.05476455, 0.05476455])","content_type":"text/plain"}}}],"key":"ZnSzouTbx3"}],"key":"ObBPqSv9Wd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Radiative forcing by definition is the change in TOA radiative flux,\n# HOLDING THE TEMPERATURES FIXED.\ncol2.Ts - col.Ts","key":"ELhlIvG3oS"},{"type":"output","id":"9-GXDS1Dmbp6hO_5FDzVV","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/plain":{"content":"Field([0.])","content_type":"text/plain"}}}],"key":"JER5n3ckYp"}],"key":"hAx7CqTfRd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col2.Tatm - col.Tatm","key":"AIZbd0S4WQ"},{"type":"output","id":"zU_uqe19EDBRBlazf1doN","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"Field([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])","content_type":"text/plain"}}}],"key":"pxfqzcWXpd"}],"key":"kaP2jQE6dG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"col2.compute_diagnostics()\ncol2.OLR","key":"EXsQB953MP"},{"type":"output","id":"bXpUt4wTO2GxjOCjwSeg0","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"Field([236.65384137])","content_type":"text/plain"}}}],"key":"QX9Kru76oz"}],"key":"vYIB32QEtg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","key":"nk9SggS21m"},{"type":"abbreviation","title":"Outgoing Longwave Radiation","children":[{"type":"text","value":"OLR","key":"Qyr9IpKGz1"}],"key":"eRY3l5vrpe"},{"type":"text","value":" decreased after we added the extra absorbers, as we expect. Now we can calcu","key":"q3CzXINqxV"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"WAd8K79mDw"}],"key":"gFGIRdkUeW"},{"type":"text","value":"e the Radiative Forcing:","key":"NU9gaHbKdI"}],"key":"ujtkICPFQq"}],"key":"Tu4vGPkItv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"RF = -(col2.OLR - col.OLR)\nprint( 'The radiative forcing is %.2f W/m2.' %RF)","key":"CAIe20Kj2c"},{"type":"output","id":"45amRonvsT5RVtHAM6uh7","data":[{"name":"stdout","output_type":"stream","text":"The radiative forcing is 1.85 W/m2.\n"},{"name":"stderr","output_type":"stream","text":"/var/folders/dl/j7hb106d36n501mrm8j646bxpf4y1c/T/ipykernel_73539/874560045.py:2: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)\n  print( 'The radiative forcing is %.2f W/m2.' %RF)\n"}],"key":"DKBxq6s0kj"}],"key":"TKZKowWQo2"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lZlEw0bEfJ"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"6. Radiative equilibrium in the 30-layer model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PPjorc7RTR"}],"identifier":"id-6-radiative-equilibrium-in-the-30-layer-model","label":"6. Radiative equilibrium in the 30-layer model","html_id":"id-6-radiative-equilibrium-in-the-30-layer-model","implicit":true,"key":"US4E6eLxf8"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OpsCufXIAY"}],"key":"Ulsmah8ul9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"re = climlab.process_like(col)","key":"NC9Y6pwb6Y"},{"type":"output","id":"0uCgy58F3k_tpoRVxJhLZ","data":[],"key":"qwxUp7HH2t"}],"key":"t2BB12FNgy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  To get to equilibrium, we just time-step the model forward long enough\nre.integrate_years(1.)","key":"Ut2f8U5MZx"},{"type":"output","id":"TEM1u53s6sQZ8TwOc70tL","data":[{"name":"stdout","output_type":"stream","text":"Integrating for 365 steps, 365.2422 days, or 1.0 years.\nTotal elapsed time is 0.9993368783782377 years.\n"}],"key":"QWgedDWWLK"}],"key":"J3H7a6P3k9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Check for energy balance\nprint( 'The net downward radiative flux at TOA is %.4f W/m2.' %(re.ASR - re.OLR))","key":"bC4qGX65HH"},{"type":"output","id":"MbPCPaanXlsVfFxeHoypp","data":[{"name":"stdout","output_type":"stream","text":"The net downward radiative flux at TOA is -0.0015 W/m2.\n"},{"name":"stderr","output_type":"stream","text":"/var/folders/dl/j7hb106d36n501mrm8j646bxpf4y1c/T/ipykernel_73539/4153264715.py:2: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)\n  print( 'The net downward radiative flux at TOA is %.4f W/m2.' %(re.ASR - re.OLR))\n"}],"key":"kfLjL90Cpu"}],"key":"fDaaUVVZuw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result_list.append(re.state)\nname_list.append('Radiative equilibrium (grey gas)')\nplot_soundings(result_list, name_list)","key":"qRPMaHzEtN"},{"type":"output","id":"TXHNUqrZmS6ZTp9E-bLdr","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='Temperature (K)', ylabel='Pressure (hPa)'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7f50758c5b970cd8c8ed44c04a0978a","path":"/ClimateLaboratoryBook/_preview/178/build/b7f50758c5b970cd8c8ed44c04a0978a.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"key":"VFCs28V5hf"}],"key":"xEgHF8Fzic"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some properties of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"woeSrD0XzK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"radiative equilibrium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aktR9jewBX"}],"key":"uEJ3LmegOf"},{"type":"text","value":" temperature profile:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RXPRxoWio6"}],"key":"Mc4ZOWVfO3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The surface is warmer than observed.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gidKIYgzgJ"}],"key":"tJQQmSQsdk"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The lower troposphere is colder than observed.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"g4IzEppKha"}],"key":"r0dr2aoTK2"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Very cold air is sitting immediately above the warm surface.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"F1VMa1tf8b"}],"key":"JE3fDsExEZ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"There is no tropopause, no stratosphere.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VdwESOpSrh"}],"key":"YWUjYUabF5"}],"key":"M4aciMfUZQ"}],"key":"cHOk3T1WnD"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jb5nTKwahB"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"7. Radiative-Convective Equilibrium in the 30-layer model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GpmjwFhbqh"}],"identifier":"id-7-radiative-convective-equilibrium-in-the-30-layer-model","label":"7. Radiative-Convective Equilibrium in the 30-layer model","html_id":"id-7-radiative-convective-equilibrium-in-the-30-layer-model","implicit":true,"key":"ATi2RGdboM"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EFiGLnrMP6"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We recognize that the large drop in temperature just above the surface is unphysical. Parcels of air in direct contact with the ground will be warmed by mechansisms other than radiative transfer.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HwjbgbrpIN"}],"key":"eDVV3xEJ16"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"These warm air parcels will then become buoyant, and will convect upward, mixing their heat content with the environment.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"u5tZfqmrIR"}],"key":"K4T5GN4dfB"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eNEOJpN7TX"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"parameterize","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EWRYbVEEqn"}],"key":"D1cKSJnuZk"},{"type":"text","value":" the statistical effects of this mixing through a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MmnLafmcEi"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"convective adjustment","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BRmBD4Z82L"}],"key":"kcSueohs1S"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fNGiYyCnuN"}],"key":"fYsB7lJmDo"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"At each timestep, our model checks for any locations at which the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Z0WnsUrQfU"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"lapse rate","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CTqC6V14ei"}],"key":"pQcbQWrksF"},{"type":"text","value":" exceeds some threshold. Unstable layers are removed through an energy-conserving mixing formula.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rILroZqWlH"}],"key":"VOJQ76OXRF"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This process is assumed to be fast re","key":"sTpvyibTT1"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"HS9UJAGmjz"}],"key":"vic0fdNiJS"},{"type":"text","value":"ive to radiative heating. In the model, it is instantaneous.","key":"GoOp9kYGN1"}],"key":"kMzZRGGVWU"}],"key":"OmmbDW4pm0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add the convective adjustment as an additional subprocess","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NmMWNEAgYV"}],"identifier":"add-the-convective-adjustment-as-an-additional-subprocess","label":"Add the convective adjustment as an additional subprocess","html_id":"add-the-convective-adjustment-as-an-additional-subprocess","implicit":true,"key":"lxLTmR4ULb"}],"key":"sQuZdolviE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Here is the existing model\nprint(re)","key":"QT6Rq5jLq9"},{"type":"output","id":"f0E-BElcfVNKI3Ph9vz17","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.GreyRadiationModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (30,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.GreyRadiationModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n\n"}],"key":"kJ0dSrvvtC"}],"key":"ohNyfBPUoq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  First we make a new clone\nrce = climlab.process_like(re)\n#  Then create a new ConvectiveAdjustment process\nconv = climlab.convection.ConvectiveAdjustment(state=rce.state, \n                                               adj_lapse_rate=6.)\n#  And add it to our model\nrce.add_subprocess('Convective Adjustment', conv)\nprint(rce)","key":"uWJ9cNFTh8"},{"type":"output","id":"jPJLG5Ssm1ykCQzmnzuoe","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.GreyRadiationModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (30,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.GreyRadiationModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n   Convective Adjustment: <class 'climlab.convection.convadj.ConvectiveAdjustment'>\n\n"}],"key":"ObkLdnhZwV"}],"key":"q6F4KnwXYu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This model is exactly like our previous models, except for one additional subprocess called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RXM3Ogvibm"},{"type":"inlineCode","value":"Convective Adjustment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"osF26RJO9Q"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hyIXZNjmUw"}],"key":"cczaOR0lA2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We passed a parameter ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iH1O8qMAcm"},{"type":"inlineCode","value":"adj_lapse_rate","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BscGFS5pvo"},{"type":"text","value":" (in K / km) that sets the neutrally stable lapse rate -- in this case, 6 K / km.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EJ6BmoxKyP"}],"key":"FtSEAwjE1c"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This number is chosed to very loosely represent the net effect of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pXaB5QRcbZ"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"moist convection","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zg78O6Lu6r"}],"key":"A2ad3eD7hS"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XvvTdVsylA"}],"key":"L4IgzlR02S"}],"key":"fItDrPucyx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Run out to equilibrium\nrce.integrate_years(1.)","key":"vnR30GIkrZ"},{"type":"output","id":"8_NVLinmd79f74h6fnkD6","data":[{"name":"stdout","output_type":"stream","text":"Integrating for 365 steps, 365.2422 days, or 1.0 years.\nTotal elapsed time is 1.9986737567564754 years.\n"}],"key":"sc3ErYXHWt"}],"key":"x6TKpDQjyA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Check for energy balance\nrce.ASR - rce.OLR","key":"vJa3OIUagm"},{"type":"output","id":"emnKQNbRSKru2SqGhj1h0","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/plain":{"content":"Field([0.0007796])","content_type":"text/plain"}}}],"key":"sUaUZ4WHOW"}],"key":"QeLnkOC5dw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result_list.append(rce.state)\nname_list.append('Radiatve-Convective equilibrium (grey gas)')","key":"rmPzgOq2mx"},{"type":"output","id":"P8WisEMwlrWKU3ayO96rg","data":[],"key":"WTikgpDBo8"}],"key":"Y0ExcvNI1v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_soundings(result_list, name_list)","key":"pZsORyRjpU"},{"type":"output","id":"q7HezepHS1-PQnYxG3EiI","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='Temperature (K)', ylabel='Pressure (hPa)'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"865c27945b8cbe426f26e65c04ee8fba","path":"/ClimateLaboratoryBook/_preview/178/build/865c27945b8cbe426f26e65c04ee8fba.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"key":"eNZDz1IlbL"}],"key":"SHITXm79pa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Introducing convective adjustment into the model cools the surface quite a bit (compared to Radiative Equilibrium, in green here) -- and warms the lower troposphere. It gives us a MUCH better fit to observations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kxIAFzaMdb"}],"key":"zQlPx6DHpR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"But of course we still have no stratosphere.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d5Y96Ne5av"}],"key":"EpxfAWcnWz"}],"key":"KHIkvtxYvD"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S2T4RQLwEM"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"8. Putting stratospheric ozone in the grey-gas model","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lUeiJ4ILGv"}],"identifier":"id-8-putting-stratospheric-ozone-in-the-grey-gas-model","label":"8. Putting stratospheric ozone in the grey-gas model","html_id":"id-8-putting-stratospheric-ozone-in-the-grey-gas-model","implicit":true,"key":"hd0GTsTVI1"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JKPFAGrn5N"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Our model has no equivalent of the stratosphere, where temperature increases with height. That’s because our model has been completely transparent to shortwave radiation up until now.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CkCZx0uYua"}],"key":"iG9kOynhZU"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We can load the observed ozone climatology from the input files for the ","key":"u0PDJoWZ3v"},{"type":"abbreviation","title":"Community Earth System Model","children":[{"type":"text","value":"CESM","key":"heAUuPdQYi"}],"key":"VGhgpfNkyi"},{"type":"text","value":" model:","key":"ZtDkfeywKc"}],"key":"WfPBKkalpx"}],"key":"EcpoCLUXO2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"datapath = \"http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/\"\nozone = xr.open_dataset( datapath + \"som_input/ozone_1.9x2.5_L26_2000clim_c091112.nc\")","key":"sD3d620ptd"},{"type":"output","id":"UmDk0Zt7kb4RSZecmtRGq","data":[],"key":"R3yfSEo91P"}],"key":"JO1mgnBx7U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ozone","key":"EmqHuQnL1N"},{"type":"output","id":"WlOmsoSgqLznBuNjMSS7J","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d31decca3126c4b65a731b8bc489ba42","path":"/ClimateLaboratoryBook/_preview/178/build/d31decca3126c4b65a731b8bc489ba42.html"},"text/plain":{"content":"<xarray.Dataset> Size: 18MB\nDimensions:  (time: 12, lat: 96, ilev: 27, lev: 26, lon: 144, slat: 95,\n              slon: 144)\nCoordinates:\n  * ilev     (ilev) float64 216B 2.194 4.895 9.882 18.05 ... 956.0 985.1 1e+03\n  * lat      (lat) float64 768B -90.0 -88.11 -86.21 -84.32 ... 86.21 88.11 90.0\n  * lev      (lev) float64 208B 3.545 7.389 13.97 23.94 ... 929.6 970.6 992.6\n  * lon      (lon) float64 1kB 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5\n  * slat     (slat) float64 760B -89.05 -87.16 -85.26 ... 85.26 87.16 89.05\n  * slon     (slon) float64 1kB -1.25 1.25 3.75 6.25 ... 348.8 351.2 353.8 356.2\n  * time     (time) object 96B 2000-01-15 00:00:00 ... 2000-12-15 00:00:00\nData variables:\n    P0       float64 8B ...\n    date     (time) int32 48B ...\n    datesec  (time) int32 48B ...\n    gw       (lat) float64 768B ...\n    hyai     (ilev) float64 216B ...\n    hyam     (lev) float64 208B ...\n    hybi     (ilev) float64 216B ...\n    hybm     (lev) float64 208B ...\n    w_stag   (slat) float64 760B ...\n    O3       (time, lev, lat, lon) float32 17MB ...\n    PS       (time, lat, lon) float32 664kB ...\nAttributes: (12/14)\n    Conventions:                     CF-1.0\n    source:                          CAM\n    case:                            ar5_cam_1850-2000_03\n    title:                           \n    logname:                         lamar\n    host:                            be0207en.ucar.ed\n    ...                              ...\n    initial_file:                    /ptmp/lamar/cam-inputs/ar5_cam_1850_06.c...\n    topography_file:                 /fs/cgd/csm/inputdata/atm/cam/topo/USGS-...\n    history:                         Wed Jan  5 14:56:28 2011: ncks -d time,1...\n    nco_openmp_thread_number:        1\n    NCO:                             4.0.5\n    DODS_EXTRA.Unlimited_Dimension:  time","content_type":"text/plain"}}}],"key":"Gstpq6kOKM"}],"key":"VmOBlRMAou"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The pressure levels in this dataset are:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPJ3gBHaUs"}],"key":"f5Xcq0r99U"}],"key":"G5xb6gbFDn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ozone.lev","key":"WfoJ9yRieJ"},{"type":"output","id":"5CXHnG1TukC3feRnfItZ6","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lev&#x27; (lev: 26)&gt; Size: 208B\narray([  3.544638,   7.388814,  13.967214,  23.944625,  37.23029 ,  53.114605,\n        70.05915 ,  85.439115, 100.514695, 118.250335, 139.115395, 163.66207 ,\n       192.539935, 226.513265, 266.481155, 313.501265, 368.81798 , 433.895225,\n       510.455255, 600.5242  , 696.79629 , 787.70206 , 867.16076 , 929.648875,\n       970.55483 , 992.5561  ])\nCoordinates:\n  * lev      (lev) float64 208B 3.545 7.389 13.97 23.94 ... 929.6 970.6 992.6\nAttributes:\n    long_name:      hybrid level at midpoints (1000*(A+B))\n    units:          level\n    positive:       down\n    standard_name:  atmosphere_hybrid_sigma_pressure_coordinate\n    formula_terms:  a: hyam b: hybm p0: P0 ps: PS</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lev'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lev</span>: 26</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e2245c5d-6f5d-4ae8-8fe2-ff3074cf2150' class='xr-array-in' type='checkbox' checked><label for='section-e2245c5d-6f5d-4ae8-8fe2-ff3074cf2150' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>3.545 7.389 13.97 23.94 37.23 53.11 ... 787.7 867.2 929.6 970.6 992.6</span></div><div class='xr-array-data'><pre>array([  3.544638,   7.388814,  13.967214,  23.944625,  37.23029 ,  53.114605,\n        70.05915 ,  85.439115, 100.514695, 118.250335, 139.115395, 163.66207 ,\n       192.539935, 226.513265, 266.481155, 313.501265, 368.81798 , 433.895225,\n       510.455255, 600.5242  , 696.79629 , 787.70206 , 867.16076 , 929.648875,\n       970.55483 , 992.5561  ])</pre></div></div></li><li class='xr-section-item'><input id='section-99193872-fc47-4242-ba6d-0713582d2c32' class='xr-section-summary-in' type='checkbox'  checked><label for='section-99193872-fc47-4242-ba6d-0713582d2c32' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.545 7.389 13.97 ... 970.6 992.6</div><input id='attrs-683d6aa8-73c2-47d2-94f4-b8e17ce6cfe8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-683d6aa8-73c2-47d2-94f4-b8e17ce6cfe8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cee1f039-8250-41e6-9864-0d30ab3105ea' class='xr-var-data-in' type='checkbox'><label for='data-cee1f039-8250-41e6-9864-0d30ab3105ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid level at midpoints (1000*(A+B))</dd><dt><span>units :</span></dt><dd>level</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd><dt><span>formula_terms :</span></dt><dd>a: hyam b: hybm p0: P0 ps: PS</dd></dl></div><div class='xr-var-data'><pre>array([  3.544638,   7.388814,  13.967214,  23.944625,  37.23029 ,  53.114605,\n        70.05915 ,  85.439115, 100.514695, 118.250335, 139.115395, 163.66207 ,\n       192.539935, 226.513265, 266.481155, 313.501265, 368.81798 , 433.895225,\n       510.455255, 600.5242  , 696.79629 , 787.70206 , 867.16076 , 929.648875,\n       970.55483 , 992.5561  ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-60275398-e9f1-447e-a651-ac3b88185099' class='xr-section-summary-in' type='checkbox'  ><label for='section-60275398-e9f1-447e-a651-ac3b88185099' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-128c82e8-cd93-4304-bde3-65c1f3b3227c' class='xr-index-data-in' type='checkbox'/><label for='index-128c82e8-cd93-4304-bde3-65c1f3b3227c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([3.5446380000000097, 7.3888135000000075, 13.967214000000006,\n                23.944625,  37.23029000000011,   53.1146050000002,\n        70.05915000000029,  85.43911500000031, 100.51469500000029,\n       118.25033500000026, 139.11539500000046, 163.66207000000043,\n       192.53993500000033, 226.51326500000036,  266.4811550000001,\n        313.5012650000006, 368.81798000000157,  433.8952250000011,\n       510.45525500000167,  600.5242000000027,  696.7962900000033,\n        787.7020600000026,  867.1607600000013,  929.6488750000024,\n        970.5548300000014,  992.5560999999998],\n      dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6e131c04-6c3e-4f2a-9733-3e67fc7ff3eb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6e131c04-6c3e-4f2a-9733-3e67fc7ff3eb' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid level at midpoints (1000*(A+B))</dd><dt><span>units :</span></dt><dd>level</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd><dt><span>formula_terms :</span></dt><dd>a: hyam b: hybm p0: P0 ps: PS</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'lev' (lev: 26)> Size: 208B\narray([  3.544638,   7.388814,  13.967214,  23.944625,  37.23029 ,  53.114605,\n        70.05915 ,  85.439115, 100.514695, 118.250335, 139.115395, 163.66207 ,\n       192.539935, 226.513265, 266.481155, 313.501265, 368.81798 , 433.895225,\n       510.455255, 600.5242  , 696.79629 , 787.70206 , 867.16076 , 929.648875,\n       970.55483 , 992.5561  ])\nCoordinates:\n  * lev      (lev) float64 208B 3.545 7.389 13.97 23.94 ... 929.6 970.6 992.6\nAttributes:\n    long_name:      hybrid level at midpoints (1000*(A+B))\n    units:          level\n    positive:       down\n    standard_name:  atmosphere_hybrid_sigma_pressure_coordinate\n    formula_terms:  a: hyam b: hybm p0: P0 ps: PS","content_type":"text/plain"}}}],"key":"LSuUnwMMfE"}],"key":"lqCl3EtAvZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Take the global average of the ozone climatology, and plot it as a function of pressure (or height)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X2UyTXBEQW"}],"identifier":"take-the-global-average-of-the-ozone-climatology-and-plot-it-as-a-function-of-pressure-or-height","label":"Take the global average of the ozone climatology, and plot it as a function of pressure (or height)","html_id":"take-the-global-average-of-the-ozone-climatology-and-plot-it-as-a-function-of-pressure-or-height","implicit":true,"key":"kIdrpTmvql"}],"key":"lq5AecXCxQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Take global, annual average and convert to Kelvin\nweight_ozone = cos(deg2rad(ozone.lat)) / cos(deg2rad(ozone.lat)).mean(dim='lat')\nO3_global = (ozone.O3 * weight_ozone).mean(dim=('lat','lon','time'))\nO3_global","key":"JAWub10LSW"},{"type":"output","id":"vd_dOWlIiYGOsIWJV-mlh","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lev: 26)&gt; Size: 208B\narray([7.82792878e-06, 8.64150529e-06, 7.58940028e-06, 5.24567145e-06,\n       3.17761574e-06, 1.82320006e-06, 9.80756960e-07, 6.22870516e-07,\n       4.47620550e-07, 3.34481169e-07, 2.62570302e-07, 2.07898125e-07,\n       1.57074555e-07, 1.12425545e-07, 8.06004999e-08, 6.27826498e-08,\n       5.42990561e-08, 4.99506089e-08, 4.60075681e-08, 4.22977789e-08,\n       3.80559071e-08, 3.38768568e-08, 3.12171619e-08, 2.97807119e-08,\n       2.87980968e-08, 2.75429934e-08])\nCoordinates:\n  * lev      (lev) float64 208B 3.545 7.389 13.97 23.94 ... 929.6 970.6 992.6</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lev</span>: 26</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6089d4ea-fa41-4fc3-ba69-ae7974fa0305' class='xr-array-in' type='checkbox' checked><label for='section-6089d4ea-fa41-4fc3-ba69-ae7974fa0305' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>7.828e-06 8.642e-06 7.589e-06 ... 2.978e-08 2.88e-08 2.754e-08</span></div><div class='xr-array-data'><pre>array([7.82792878e-06, 8.64150529e-06, 7.58940028e-06, 5.24567145e-06,\n       3.17761574e-06, 1.82320006e-06, 9.80756960e-07, 6.22870516e-07,\n       4.47620550e-07, 3.34481169e-07, 2.62570302e-07, 2.07898125e-07,\n       1.57074555e-07, 1.12425545e-07, 8.06004999e-08, 6.27826498e-08,\n       5.42990561e-08, 4.99506089e-08, 4.60075681e-08, 4.22977789e-08,\n       3.80559071e-08, 3.38768568e-08, 3.12171619e-08, 2.97807119e-08,\n       2.87980968e-08, 2.75429934e-08])</pre></div></div></li><li class='xr-section-item'><input id='section-f28417ee-befc-47aa-9666-453037cdf13a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f28417ee-befc-47aa-9666-453037cdf13a' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.545 7.389 13.97 ... 970.6 992.6</div><input id='attrs-7bc94aa0-855d-4435-a072-2e359a5e3f25' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7bc94aa0-855d-4435-a072-2e359a5e3f25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-866b64e2-7421-48e6-983a-150f8405e90c' class='xr-var-data-in' type='checkbox'><label for='data-866b64e2-7421-48e6-983a-150f8405e90c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid level at midpoints (1000*(A+B))</dd><dt><span>units :</span></dt><dd>level</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>standard_name :</span></dt><dd>atmosphere_hybrid_sigma_pressure_coordinate</dd><dt><span>formula_terms :</span></dt><dd>a: hyam b: hybm p0: P0 ps: PS</dd></dl></div><div class='xr-var-data'><pre>array([  3.544638,   7.388814,  13.967214,  23.944625,  37.23029 ,  53.114605,\n        70.05915 ,  85.439115, 100.514695, 118.250335, 139.115395, 163.66207 ,\n       192.539935, 226.513265, 266.481155, 313.501265, 368.81798 , 433.895225,\n       510.455255, 600.5242  , 696.79629 , 787.70206 , 867.16076 , 929.648875,\n       970.55483 , 992.5561  ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3f6ad29a-1a40-4dfc-9572-f5cfa041cbc0' class='xr-section-summary-in' type='checkbox'  ><label for='section-3f6ad29a-1a40-4dfc-9572-f5cfa041cbc0' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8c2153a5-af07-4e33-98c1-4f57824fb2d9' class='xr-index-data-in' type='checkbox'/><label for='index-8c2153a5-af07-4e33-98c1-4f57824fb2d9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([3.5446380000000097, 7.3888135000000075, 13.967214000000006,\n                23.944625,  37.23029000000011,   53.1146050000002,\n        70.05915000000029,  85.43911500000031, 100.51469500000029,\n       118.25033500000026, 139.11539500000046, 163.66207000000043,\n       192.53993500000033, 226.51326500000036,  266.4811550000001,\n        313.5012650000006, 368.81798000000157,  433.8952250000011,\n       510.45525500000167,  600.5242000000027,  696.7962900000033,\n        787.7020600000026,  867.1607600000013,  929.6488750000024,\n        970.5548300000014,  992.5560999999998],\n      dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b26a638d-948f-4011-a233-19d19df29093' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b26a638d-948f-4011-a233-19d19df29093' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (lev: 26)> Size: 208B\narray([7.82792878e-06, 8.64150529e-06, 7.58940028e-06, 5.24567145e-06,\n       3.17761574e-06, 1.82320006e-06, 9.80756960e-07, 6.22870516e-07,\n       4.47620550e-07, 3.34481169e-07, 2.62570302e-07, 2.07898125e-07,\n       1.57074555e-07, 1.12425545e-07, 8.06004999e-08, 6.27826498e-08,\n       5.42990561e-08, 4.99506089e-08, 4.60075681e-08, 4.22977789e-08,\n       3.80559071e-08, 3.38768568e-08, 3.12171619e-08, 2.97807119e-08,\n       2.87980968e-08, 2.75429934e-08])\nCoordinates:\n  * lev      (lev) float64 208B 3.545 7.389 13.97 23.94 ... 929.6 970.6 992.6","content_type":"text/plain"}}}],"key":"MrwFT3tMRf"}],"key":"HCNS8LOuJd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ax = plt.figure(figsize=(10,8)).add_subplot(111)\nax.plot( O3_global * 1.E6, -np.log(ozone.lev/climlab.constants.ps) )\nax.set_xlabel('Ozone (ppm)', fontsize=16)\nax.set_ylabel('Pressure (hPa)', fontsize=16 )\nyticks = np.array([1000., 750., 500., 250., 100., 50., 20., 10., 5.])\nax.set_yticks(-np.log(yticks/1000.))\nax.set_yticklabels(yticks)\nax.grid()\nax.set_title('Global, annual mean ozone concentration', fontsize = 24);","key":"zskfcIjUIR"},{"type":"output","id":"4fGf2Q4o0hLlZlTBdARcz","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3ea47968fb51bc9f2a0d796d0d936711","path":"/ClimateLaboratoryBook/_preview/178/build/3ea47968fb51bc9f2a0d796d0d936711.png"},"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"}}}],"key":"FXJbPzyWgL"}],"key":"Lj9E7XylNI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This shows that most of the ozone is indeed in the stratosphere, and peaks near the top of the stratosphere.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IwiWxIDzOB"}],"key":"LO2nstZZ3k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now create a new column model object ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BzNobcKm5c"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"on the same pressure levels as the ozone data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BixyQXW04A"}],"key":"PMfPhXlgKP"},{"type":"text","value":".  We are also going set an adjusted lapse rate of 6 K / km.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zl8KaCm3ig"}],"key":"RAHKtjUWt2"}],"key":"IzkdUbqRLZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# the RadiativeConvectiveModel is pre-defined in climlab\n#  It contains the same components are our previous model\n#   But here we are specifying a different set of vertical levels.\noz_col = climlab.RadiativeConvectiveModel(lev = ozone.lev, adj_lapse_rate=6)\nprint(oz_col)","key":"Ifmftpa8eu"},{"type":"output","id":"jIbFOGgleoJ2NunjMcr-V","data":[{"name":"stdout","output_type":"stream","text":"climlab Process of type <class 'climlab.model.column.RadiativeConvectiveModel'>. \nState variables and domain shapes: \n  Ts: (1,) \n  Tatm: (26,) \nThe subprocess tree: \nUntitled: <class 'climlab.model.column.RadiativeConvectiveModel'>\n   LW: <class 'climlab.radiation.greygas.GreyGas'>\n   SW: <class 'climlab.radiation.greygas.GreyGasSW'>\n   insolation: <class 'climlab.radiation.insolation.FixedInsolation'>\n   convective adjustment: <class 'climlab.convection.convadj.ConvectiveAdjustment'>\n\n"}],"key":"pIC5LqlIBm"}],"key":"D4QqKcEUC9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will do something new: let the column absorb some shortwave radiation. We will assume that the shortwave absorptivity is proportional to the ozone concentration we plotted above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iSvC5rhNHH"}],"key":"K2Sj8poQtR"}],"key":"c6knevfZfa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we need to weight the absorptivity by the pressure (mass) of each layer.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WW3CE7S3T4"}],"key":"hfugv58m6X"}],"key":"o5dMrgAILV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# This number is an arbitrary parameter that scales how absorptive we are making the ozone\n# in our grey gas model\nozonefactor = 75\ndp = oz_col.Tatm.domain.lev.delta\nepsSW = O3_global.values * dp * ozonefactor","key":"zRZ8uTvDq4"},{"type":"output","id":"RSwq91kOn4G7K-dzTUVKP","data":[],"key":"z9v81tYXVD"}],"key":"NCthkv8Dtq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We want to use the field ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GX3A2M82Bc"},{"type":"inlineCode","value":"epsSW","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FcKvdsXplu"},{"type":"text","value":" as the absorptivity for our ","key":"kHtm2w5z9j"},{"type":"abbreviation","title":"Shortwave","children":[{"type":"text","value":"SW","key":"rHmOe2pKvC"}],"key":"iFCp3Exx7B"},{"type":"text","value":" radiation model.","key":"nNKkbgT7WH"}],"key":"xDqUPryb9m"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s see what the absorptivity is current set to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UdlgMdO6Ie"}],"key":"T8GWuRsnz2"}],"key":"XvDpP6lROh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(oz_col.subprocess['SW'].absorptivity)","key":"RVWSTQpaoA"},{"type":"output","id":"j3FlzXvTF36R-fAb_-gNR","data":[{"name":"stdout","output_type":"stream","text":"[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.\n 0. 0.]\n"}],"key":"DB008LqWGw"}],"key":"kh5i8Opd8A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It defaults to zero.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T2p8ZmSDzE"}],"key":"lQq30m9Ltx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before changing this (putting in the ozone), let’s take a look at the shortwave absorption in the column:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mXugRxtVKL"}],"key":"iZxXXZ4642"}],"key":"UBb8NHHGN4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"oz_col.compute_diagnostics()","key":"l7CKEIMASx"},{"type":"output","id":"1zkGOC_BMeRcFG4t7Wbdb","data":[],"key":"JlGeDGeZEu"}],"key":"e9DDRKnt6r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"oz_col.diagnostics['SW_absorbed_atm']","key":"qPK26Yderj"},{"type":"output","id":"OEyZZbbR7NWmhRx0GaNbd","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/plain":{"content":"Field([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,\n       0., 0., 0., 0., 0., 0., 0., 0., 0.])","content_type":"text/plain"}}}],"key":"v56ASZwTkH"}],"key":"fxgoIp1IUT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s now put in the ozone:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5egcHrDVo"}],"key":"Jz150BwZn9"}],"key":"rKA5E6fPqq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"oz_col.subprocess['SW'].absorptivity = epsSW\nprint(oz_col.subprocess['SW'].absorptivity)","key":"L7sfU7EMSn"},{"type":"output","id":"AllRvo6SmvrUJF4jIP7Tm","data":[{"name":"stdout","output_type":"stream","text":"[3.20948549e-03 3.37750296e-03 4.71182551e-03 4.57614201e-03\n 3.47591203e-03 2.24450924e-03 1.18884331e-03 7.11369788e-04\n 5.50761612e-04 4.84170273e-04 4.47141487e-04 4.16507314e-04\n 3.70212131e-04 3.11733073e-04 2.62922861e-04 2.40936639e-04\n 2.45147939e-04 2.65307555e-04 2.87482272e-04 2.95567946e-04\n 2.67120872e-04 2.16427978e-04 1.66169127e-04 1.15468088e-04\n 6.79353134e-05 3.81013280e-05]\n"}],"key":"GIuTGtFsrf"}],"key":"Erb1VMyRPi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s check how this changes the ","key":"WMQ5gwlnkQ"},{"type":"abbreviation","title":"Shortwave","children":[{"type":"text","value":"SW","key":"LLcVVdDMR7"}],"key":"Zoart3O7Gc"},{"type":"text","value":" absorption:","key":"VtoJpvop9A"}],"key":"JTwzxem6JH"}],"key":"P8KB6CU0SK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"oz_col.compute_diagnostics()\noz_col.SW_absorbed_atm","key":"yE59NdGnQR"},{"type":"output","id":"8d0XfCcluGmOlNAMImw-o","data":[{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/plain":{"content":"Field([1.40571621, 1.47671285, 2.05685574, 1.99236565, 1.50916587,\n       0.97239284, 0.51429089, 0.30750441, 0.23797743, 0.20913838,\n       0.19309134, 0.17981756, 0.1597929 , 0.13452308, 0.11343944,\n       0.10393806, 0.10574109, 0.11442201, 0.12396838, 0.12743553,\n       0.11515129, 0.09328389, 0.07161233, 0.04975714, 0.02927232,\n       0.01641659])","content_type":"text/plain"}}}],"key":"pwbd1M7c0w"}],"key":"acpmmat6gf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It is now non-zero, and largest near the top of the column (also top of the array) where the ozone concentration is highest.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YwBaVEVmgU"}],"key":"L89TWvAxeo"}],"key":"t4GFtan5Nq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now it’s time to run the model out to radiative-convective equilibrium","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aMhV2afcnL"}],"key":"Ptbum2Ktn4"}],"key":"piLZ3iYbFO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"oz_col.integrate_years(1.)","key":"PK09SsPK7V"},{"type":"output","id":"JqaDiep6xnU57l6H3jY0R","data":[{"name":"stdout","output_type":"stream","text":"Integrating for 365 steps, 365.2422 days, or 1.0 years.\nTotal elapsed time is 0.9993368783782377 years.\n"}],"key":"YgVajPpqQw"}],"key":"J55FjIPFxE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(oz_col.ASR - oz_col.OLR)","key":"iObCEuUim9"},{"type":"output","id":"ZTl_7t3QFFyU38KNzjrdh","data":[{"name":"stdout","output_type":"stream","text":"[-0.00396053]\n"}],"key":"eFpVPzKluN"}],"key":"n7o7qlTgHa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And let’s now see what we got!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XlWpPxss0t"}],"key":"bMhJITIUcb"}],"key":"oOqc7TW2SH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result_list.append(oz_col.state)\nname_list.append('Radiative-Convective equilibrium with O3')","key":"ZWDBLqoel4"},{"type":"output","id":"OagbdNBbS50_MQD3jpsQk","data":[],"key":"fjSohvs38Z"}],"key":"tByzxaD1nG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Make a plot to compare observations, Radiative Equilibrium, Radiative-Convective Equilibrium, and RCE with ozone!\nplot_soundings(result_list, name_list)","key":"fxC1zwrhvg"},{"type":"output","id":"JmM-u0gbR7aUiqssfvBO6","data":[{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='Temperature (K)', ylabel='Pressure (hPa)'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b591c6929d2526ffd9d19e72be98900d","path":"/ClimateLaboratoryBook/_preview/178/build/b591c6929d2526ffd9d19e72be98900d.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"key":"cPvFUZwC3r"}],"key":"y8tlxMJb17"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And we finally have something that looks looks like the tropopause, with temperature increasing above at approximately the correct rate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YEZRCosPgn"}],"key":"xana9iD20w"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"There are still plenty of discrepancies between this model solution and the observations, including:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YHnMB4wpmj"}],"key":"PDGowtfExh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Tropopause temperature is too warm, by about 15 degrees.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vUrsaKaw3K"}],"key":"edDXR6I6M8"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Surface temperature is too cold","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BJ7SDu65jj"}],"key":"CH7y55grRi"}],"key":"OZg8gX4zi8"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"There are a number of parameters we might adjust if we wanted to improve the fit, including:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"iLWoGUBCsV"}],"key":"KEq049HSg2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Longwave absorptivity","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"PTILdvvOmv"}],"key":"glGf1MglbZ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Surface albedo","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yKeWRftn5f"}],"key":"a8vp2WFnRT"}],"key":"rCLMe9fqZS"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Feel free to experiment! (That’s what models are for, after all).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OOynRTQINJ"}],"key":"XcxMGMXOkW"}],"key":"vJHj9FgIoU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The take home message","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oH7DML0PbR"}],"identifier":"the-take-home-message","label":"The take home message","html_id":"the-take-home-message","implicit":true,"key":"mAvkrUCRlR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The dominant effect of stratospheric ozone is to vastly increase the radiative equilibrium temperature in the ozone layer. The temperature needs to be higher so that the ","key":"FR95gPyMnc"},{"type":"abbreviation","title":"longitude","children":[{"type":"text","value":"lon","key":"lmDZQI5B42"}],"key":"TZGZYBOFqu"},{"type":"text","value":"gwave emission can balance the shortwave absorption.","key":"VZdrm9t8Zj"}],"key":"G3jbNOETqL"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Without ozone to absorb incoming solar radiation, the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zh8J3SjoEf"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"temperature does not increase with height","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KLgYFjuABq"}],"key":"gx4iILwIDt"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"omhDlhbiO2"}],"key":"z2KbwCDQuo"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This simple grey-gas model illustrates this principle very clearly.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bCwxJeMG1x"}],"key":"VYm91qhoLB"}],"key":"B4KtniuNFU"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pxgKl7L0WS"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YtMM3gpiJn"}],"identifier":"credits","label":"Credits","html_id":"credits","implicit":true,"key":"uqTTSPI402"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wP3ZsZTjad"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tlFtGKRzO5"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"x1zZHkO15o"},{"type":"text","value":", an open-source textbook developed and maintained by ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jlNYq2xdKB"},{"type":"link","url":"https://www.atmos.albany.edu/facstaff/brose/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hamrHqukOK"}],"urlSource":"https://www.atmos.albany.edu/facstaff/brose/","key":"Y43jbUnPYB"},{"type":"text","value":", University at Albany.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PKGdpGOi75"}],"key":"iPBd4b5MZY"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"It is licensed for free and open consumption under the\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T3Fo2D0qeh"},{"type":"link","url":"https://creativecommons.org/licenses/by/4.0/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Creative Commons Attribution 4.0 International (CC BY 4.0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LgydkrjKE6"}],"urlSource":"https://creativecommons.org/licenses/by/4.0/","key":"H51fj3ue7d"},{"type":"text","value":" license.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gZYwluULAA"}],"key":"iFtCItYFC1"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Development of these notes and the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vrJRygeyOv"},{"type":"link","url":"https://github.com/climlab/climlab","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"climlab software","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"K7Y3Ag1TZA"}],"urlSource":"https://github.com/climlab/climlab","error":true,"key":"Wak02shxkd"},{"type":"text","value":" is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"nFPTPsXPYF"}],"key":"E4zBaduMfe"},{"type":"thematicBreak","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CoQWqY5fS0"}],"key":"mQVrnx4hKU"}],"key":"uXfT8JZK11"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Advanced topic: Solving the two-layer grey gas model analytically with sympy","url":"/courseware/sympy-greenhouse","group":"The Climate Laboratory"},"next":{"title":"Modeling non-scattering radiative transfer","url":"/courseware/radiative-transfer","group":"The Climate Laboratory"}}},"domain":"http://localhost:3000"}