
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Advanced topic: Heat transport decomposition &#8212; The Climate Laboratory</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/advanced-heat-transport.html" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="20. The one-dimensional energy balance model" href="one-dim-ebm.html" />
    <link rel="prev" title="19. Heat transport" href="heat-transport.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-43758959-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The Climate Laboratory</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    The Climate Laboratory
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preamble
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about.html">
   About this Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../who-for.html">
   Who is the book for?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../how-to.html">
   How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution.html">
   How to cite and reuse this material
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="models-budgets-fun.html">
   1. Climate models, the global energy budget, and Fun with Python
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="zero-dim-ebm.html">
   2. Modeling the global energy budget
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="analytical-efolding.html">
     Advanced topic: Analytical solution of the global Energy Balance Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="climate-system-models.html">
   3. The climate system and climate models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introducing-cesm.html">
   4. Introducing the Community Earth System Model (CESM)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="climlab-intro.html">
   5. Building simple climate models using climlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiation.html">
   6. A Brief Review of Radiation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="elementary-greenhouse.html">
   7. Elementary greenhouse models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sympy-greenhouse.html">
     Advanced topic: Solving the two-layer grey gas model analytically with sympy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="grey-radiation-climlab.html">
   8. Grey radiation modeling with climlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiative-transfer.html">
   9. Modeling non-scattering radiative transfer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spectral-bands.html">
   10. Who needs spectral bands? We do. Some baby steps…
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radeq.html">
   11. Radiative Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rce.html">
   12. Radiative-Convective Equilibrium
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="sensitivity-feedback.html">
   13. Climate sensitivity and feedback
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-sensitivity-feedback.html">
     Advanced topic: Climate sensitivity and feedback
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transient-cesm.html">
   14. Examing the transient and equilibrium CO2 response in the CESM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transient-toy.html">
   15. Toy models of transient warming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clouds.html">
   16. Clouds and cloud feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="insolation.html">
   17. Insolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="orbital.html">
   18. Orbital variations, insolation, and the ice ages
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="heat-transport.html">
   19. Heat transport
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Advanced topic: Heat transport decomposition
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="one-dim-ebm.html">
   20. The one-dimensional energy balance model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="seasonal-cycle.html">
   21. Modeling the seasonal cycle of surface temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-diffusion.html">
   22. A peek at numerical methods for diffusion models
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="albedo-snowball.html">
   23. Ice-albedo feedback and Snowball Earth in the EBM
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-albedo-feedback.html">
     Advanced topic: Ice albedo feedback in the EBM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="advanced-snowball-earth.html">
     Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surface-energy-balance.html">
   24. The surface energy balance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="land-ocean-contrast.html">
   25. Land-Ocean contrasts under climate change
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="water-water-everywhere.html">
   26. Water, water everywhere!
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about-assignments.html">
   About the assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-zero-dim-ebm.html">
   Assignment: Climate change in the zero-dimensional EBM
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="assignment-cesm-control.html">
   Assignment: Global average budgets in the CESM pre-industrial control simulation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="assignment-cesm-control-hints.html">
     Additional hints and guidance for CESM budgets assignment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-simple-clouds.html">
   Assignment: Clouds in the Leaky Greenhouse Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-rcm-feedback.html">
   Assignment: Feedbacks in the Radiative-Convective Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-cesm-climate-change.html">
   Assignment: Climate change in the CESM simulations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assignment-insolation-orbit.html">
   Assignment: Insolation and orbital parameters
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Postamble
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/brian-rose/ClimateLaboratoryBook/main?urlpath=tree/courseware/advanced-heat-transport.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://lore.atmos.albany.edu:8000/hub/user-redirect/git-pull?repo=https%3A//github.com/brian-rose/ClimateLaboratoryBook&urlpath=tree/ClimateLaboratoryBook/courseware/advanced-heat-transport.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/courseware/advanced-heat-transport.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatial-patterns-of-insolation-and-surface-temperature">
   1. Spatial patterns of insolation and surface temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-radiative-convective-equilibrium-as-a-function-of-latitude">
   2. Calculating Radiative-Convective Equilibrium as a function of latitude
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#putting-realistic-insolation-into-an-rcm">
     Putting realistic insolation into an RCM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-the-steady-seasonal-cycle-of-temperature-in-radiative-convective-equilibrium">
     Find the steady seasonal cycle of temperature in radiative-convective equilibrium
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-annual-average-temperature-in-rce-to-the-zonal-annual-mean-observations">
     Compare annual average temperature in RCE to the zonal-, annual mean observations.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vertical-structure-of-temperature-comparing-rce-to-observations">
     Vertical structure of temperature: comparing RCE to observations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-energy-budget-in-rce-equilibrium">
     TOA energy budget in RCE equilibrium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observed-and-modeled-toa-radiation-budget">
   3. Observed and modeled TOA radiation budget
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-budget-from-ncep-reanalysis">
     TOA budget from NCEP Reanalysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-budget-from-the-control-cesm-simulation">
     TOA budget from the control CESM simulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-energy-budget-for-a-zonal-band">
   4. The energy budget for a zonal band
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basic-idea">
     The basic idea
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-careful-budget">
     A more careful budget
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-heat-transport-from-the-steady-state-energy-budget">
     Calculating heat transport from the steady-state energy budget
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observed-and-modeled-poleward-heat-transport">
   5. Observed and modeled poleward heat transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-example-of-a-recently-published-observational-estimate-of-meridional-heat-transport">
     An example of a recently published observational estimate of meridional heat transport
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#energy-budgets-for-the-atmosphere-and-ocean">
   6. Energy budgets for the atmosphere and ocean
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#surface-fluxes">
     Surface fluxes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-budget-for-the-ocean">
     Energy budget for the ocean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-budget-for-the-atmosphere">
     Energy budget for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atmospheric-water-budget-and-latent-heat-transport">
     Atmospheric water budget and latent heat transport
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-the-partitioning-of-poleward-energy-transport-into-different-components">
   7. Calculating the partitioning of poleward energy transport into different components
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mechanisms-of-heat-transport">
   8. Mechanisms of heat transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mechanisms-of-energy-transport-in-the-ocean">
     Mechanisms of energy transport in the ocean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#these-notes-are-not-really-finished">
     <em>
      These notes are not really finished…
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#credits">
   Credits
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Advanced topic: Heat transport decomposition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatial-patterns-of-insolation-and-surface-temperature">
   1. Spatial patterns of insolation and surface temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-radiative-convective-equilibrium-as-a-function-of-latitude">
   2. Calculating Radiative-Convective Equilibrium as a function of latitude
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#putting-realistic-insolation-into-an-rcm">
     Putting realistic insolation into an RCM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-the-steady-seasonal-cycle-of-temperature-in-radiative-convective-equilibrium">
     Find the steady seasonal cycle of temperature in radiative-convective equilibrium
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-annual-average-temperature-in-rce-to-the-zonal-annual-mean-observations">
     Compare annual average temperature in RCE to the zonal-, annual mean observations.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vertical-structure-of-temperature-comparing-rce-to-observations">
     Vertical structure of temperature: comparing RCE to observations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-energy-budget-in-rce-equilibrium">
     TOA energy budget in RCE equilibrium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observed-and-modeled-toa-radiation-budget">
   3. Observed and modeled TOA radiation budget
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-budget-from-ncep-reanalysis">
     TOA budget from NCEP Reanalysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toa-budget-from-the-control-cesm-simulation">
     TOA budget from the control CESM simulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-energy-budget-for-a-zonal-band">
   4. The energy budget for a zonal band
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basic-idea">
     The basic idea
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-careful-budget">
     A more careful budget
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-heat-transport-from-the-steady-state-energy-budget">
     Calculating heat transport from the steady-state energy budget
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#observed-and-modeled-poleward-heat-transport">
   5. Observed and modeled poleward heat transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-example-of-a-recently-published-observational-estimate-of-meridional-heat-transport">
     An example of a recently published observational estimate of meridional heat transport
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#energy-budgets-for-the-atmosphere-and-ocean">
   6. Energy budgets for the atmosphere and ocean
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#surface-fluxes">
     Surface fluxes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-budget-for-the-ocean">
     Energy budget for the ocean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-budget-for-the-atmosphere">
     Energy budget for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atmospheric-water-budget-and-latent-heat-transport">
     Atmospheric water budget and latent heat transport
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-the-partitioning-of-poleward-energy-transport-into-different-components">
   7. Calculating the partitioning of poleward energy transport into different components
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mechanisms-of-heat-transport">
   8. Mechanisms of heat transport
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mechanisms-of-energy-transport-in-the-ocean">
     Mechanisms of energy transport in the ocean
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#these-notes-are-not-really-finished">
     <em>
      These notes are not really finished…
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#credits">
   Credits
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="advanced-topic-heat-transport-decomposition">
<h1>Advanced topic: Heat transport decomposition<a class="headerlink" href="#advanced-topic-heat-transport-decomposition" title="Permalink to this headline">#</a></h1>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a> by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p><em>This notebook is an extension of the <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/heat-transport.html">Heat transport notes</a> containing some additional advanced material on the decomposition of total heat transport in components. The advanced notes are unfinished but may be useful.</em></p>
<hr class="docutils" />
<p><a id='section1'></a></p>
<section id="spatial-patterns-of-insolation-and-surface-temperature">
<h2>1. Spatial patterns of insolation and surface temperature<a class="headerlink" href="#spatial-patterns-of-insolation-and-surface-temperature" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Let’s take a look at seasonal and spatial pattern of insolation and compare this to the zonal average surface temperatures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">climlab</span>
<span class="kn">from</span> <span class="nn">climlab</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Calculate daily average insolation as function of latitude and time of year</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span> <span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mi">500</span> <span class="p">)</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">days_per_year</span><span class="p">,</span> <span class="mi">365</span> <span class="p">)</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">solar</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">daily_insolation</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">days</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##  daily surface temperature from  NCEP reanalysis</span>
<span class="n">ncep_url</span> <span class="o">=</span> <span class="s2">&quot;http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/ncep.reanalysis.derived/&quot;</span>
<span class="n">ncep_temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span> <span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;surface_gauss/skt.sfc.day.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#url = &#39;http://apdrc.soest.hawaii.edu:80/dods/public_data/Reanalysis_Data/NCEP/NCEP/clima/&#39;</span>
<span class="c1">#skt_path = &#39;surface_gauss/skt&#39;</span>
<span class="c1">#ncep_temp = xr.open_dataset(url+skt_path)</span>
<span class="n">ncep_temp_zon</span> <span class="o">=</span> <span class="n">ncep_temp</span><span class="o">.</span><span class="n">skt</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span> <span class="n">days</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">Q</span> <span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">600.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Daily average insolation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span> <span class="p">(</span> <span class="n">days</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span> <span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span> <span class="p">(</span><span class="n">ncep_temp</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="n">ncep_temp</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">const</span><span class="o">.</span><span class="n">hours_per_day</span><span class="p">,</span> <span class="n">ncep_temp</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> 
                 <span class="n">ncep_temp_zon</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">210.</span><span class="p">,</span> <span class="mf">310.</span><span class="p">,</span> <span class="mf">10.</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Observed zonal average surface temperature&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Days since January 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_6_0.png" src="../_images/advanced-heat-transport_6_0.png" />
</div>
</div>
<p>This figure reveals something fairly obvious, but still worth thinking about:</p>
<p><strong>Warm temperatures are correlated with high insolation</strong>. It’s warm where the sun shines.</p>
<p>More specifically, we can see a few interesting details here:</p>
<ul class="simple">
<li><p>The seasonal cycle is weakest in the tropics and strongest in the high latitudes.</p></li>
<li><p>The warmest temperatures occur slighly NORTH of the equator</p></li>
<li><p>The highest insolation occurs at the poles at summer solstice.</p></li>
</ul>
<p>The local surface temperature does not correlate perfectly with local insolation for two reasons:</p>
<ul class="simple">
<li><p>the climate system has heat capacity, which buffers some of the seasonal variations</p></li>
<li><p>the climate system moves energy around in space!</p></li>
</ul>
<hr class="docutils" />
<p><a id='section2'></a></p>
</section>
<section id="calculating-radiative-convective-equilibrium-as-a-function-of-latitude">
<h2>2. Calculating Radiative-Convective Equilibrium as a function of latitude<a class="headerlink" href="#calculating-radiative-convective-equilibrium-as-a-function-of-latitude" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>As a first step to understanding the effects of <strong>heat transport by fluid motions</strong> in the atmosphere and ocean, we can calculate <strong>what the surface temperature would be without any motion</strong>.</p>
<p>Let’s calculate a <strong>radiative-convective equilibrium</strong> state for every latitude band.</p>
<section id="putting-realistic-insolation-into-an-rcm">
<h3>Putting realistic insolation into an RCM<a class="headerlink" href="#putting-realistic-insolation-into-an-rcm" title="Permalink to this headline">#</a></h3>
<p>This code demonstrates how to create a model with both latitude and vertical dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A two-dimensional domain</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">column_state</span><span class="p">(</span><span class="n">num_lev</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">num_lat</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">water_depth</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="c1">#  Specified relative humidity distribution</span>
<span class="n">h2o</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">ManabeWaterVapor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fixed Relative Humidity&#39;</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
<span class="c1">#  Hard convective adjustment</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">convection</span><span class="o">.</span><span class="n">ConvectiveAdjustment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Convective Adjustment&#39;</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">adj_lapse_rate</span><span class="o">=</span><span class="mf">6.5</span><span class="p">)</span>
<span class="c1">#  Daily insolation as a function of latitude and time of year</span>
<span class="n">sun</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">DailyInsolation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Insolation&#39;</span><span class="p">,</span> <span class="n">domains</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span>
<span class="c1">#  Couple the radiation to insolation and water vapor processes</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">RRTMG</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Radiation&#39;</span><span class="p">,</span>
                             <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> 
                             <span class="n">specific_humidity</span><span class="o">=</span><span class="n">h2o</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> 
                             <span class="n">albedo</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span>
                             <span class="n">insolation</span><span class="o">=</span><span class="n">sun</span><span class="o">.</span><span class="n">insolation</span><span class="p">,</span>
                             <span class="n">coszen</span><span class="o">=</span><span class="n">sun</span><span class="o">.</span><span class="n">coszen</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">climlab</span><span class="o">.</span><span class="n">couple</span><span class="p">([</span><span class="n">rad</span><span class="p">,</span><span class="n">sun</span><span class="p">,</span><span class="n">h2o</span><span class="p">,</span><span class="n">conv</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;RCM&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climlab Process of type &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;. 
State variables and domain shapes: 
  Ts: (40, 1) 
  Tatm: (40, 30) 
The subprocess tree: 
RCM: &lt;class &#39;climlab.process.time_dependent_process.TimeDependentProcess&#39;&gt;
   Radiation: &lt;class &#39;climlab.radiation.rrtm.rrtmg.RRTMG&#39;&gt;
      SW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_sw.RRTMG_SW&#39;&gt;
      LW: &lt;class &#39;climlab.radiation.rrtm.rrtmg_lw.RRTMG_LW&#39;&gt;
   Insolation: &lt;class &#39;climlab.radiation.insolation.DailyInsolation&#39;&gt;
   Fixed Relative Humidity: &lt;class &#39;climlab.radiation.water_vapor.ManabeWaterVapor&#39;&gt;
   Convective Adjustment: &lt;class &#39;climlab.convection.convadj.ConvectiveAdjustment&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compute_diagnostics</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">insolation</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Insolation (W/m2)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_13_0.png" src="../_images/advanced-heat-transport_13_0.png" />
</div>
</div>
<p>This new insolation process uses the same code we’ve already been working with to compute realistic distributions of insolation. Here we are using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">DailyInsolation</span>
</pre></div>
</div>
<p>but there is also</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">climlab</span><span class="o">.</span><span class="n">radiation</span><span class="o">.</span><span class="n">AnnualMeanInsolation</span>
</pre></div>
</div>
<p>for models in which you prefer to suppress the seasonal cycle and prescribe a time-invariant insolation.</p>
<p>The following code will just integrate the model forward in four steps in order to get snapshots of insolation at the solstices and equinoxes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  model is initialized on Jan. 1</span>

<span class="c1">#  integrate forward just under 1/4 year... should get about to the NH spring equinox</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_days</span><span class="p">(</span><span class="mi">31</span><span class="o">+</span><span class="mi">28</span><span class="o">+</span><span class="mi">22</span><span class="p">)</span>
<span class="n">Q_spring</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#  Then forward to NH summer solstice</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_days</span><span class="p">(</span><span class="mi">31</span><span class="o">+</span><span class="mi">30</span><span class="o">+</span><span class="mi">31</span><span class="p">)</span>
<span class="n">Q_summer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#  and on to autumnal equinox</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_days</span><span class="p">(</span><span class="mi">30</span><span class="o">+</span><span class="mi">31</span><span class="o">+</span><span class="mi">33</span><span class="p">)</span>
<span class="n">Q_fall</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#  and finally to NH winter solstice</span>
<span class="n">model</span><span class="o">.</span><span class="n">integrate_days</span><span class="p">(</span><span class="mi">30</span><span class="o">+</span><span class="mi">31</span><span class="o">+</span><span class="mi">30</span><span class="p">)</span>
<span class="n">Q_winter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">insolation</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 81 steps, 81.0 days, or 0.22177064972229385 years.
Total elapsed time is 0.22177064972229385 years.
Integrating for 91 steps, 91.99999999999999 days, or 0.2518876515364325 years.
Total elapsed time is 0.4709203920028956 years.
Integrating for 94 steps, 94.00000000000001 days, or 0.2573634700480941 years.
Total elapsed time is 0.7282838620509897 years.
Integrating for 91 steps, 91.0 days, or 0.24914974228060174 years.
Total elapsed time is 0.9774336043315914 years.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Q_spring</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Spring&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Q_summer</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Summer&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Q_fall</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fall&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Q_winter</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Winter&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Insolation (W/m2)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_17_0.png" src="../_images/advanced-heat-transport_17_0.png" />
</div>
</div>
<p>This just serves to demonstrate that the <code class="docutils literal notranslate"><span class="pre">DailyInsolation</span></code> process is doing something sensible.</p>
<p>Note that we could also pass different orbital parameters to this subprocess. They default to present-day values, which is what we are using here.</p>
</section>
<section id="find-the-steady-seasonal-cycle-of-temperature-in-radiative-convective-equilibrium">
<h3>Find the steady seasonal cycle of temperature in radiative-convective equilibrium<a class="headerlink" href="#find-the-steady-seasonal-cycle-of-temperature-in-radiative-convective-equilibrium" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 1460 steps, 1460.9688 days, or 4.0 years.
Total elapsed time is 4.974781117844542 years.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">integrate_years</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Integrating for 365 steps, 365.2422 days, or 1.0 years.
Total elapsed time is 5.97411799622278 years.
</pre></div>
</div>
</div>
</div>
<p>All climlab <code class="docutils literal notranslate"><span class="pre">Process</span></code> objects have an attribute called <code class="docutils literal notranslate"><span class="pre">timeave</span></code>.</p>
<p>This is a dictionary of time-averaged diagnostics, which are automatically calculated during the most recent call to <code class="docutils literal notranslate"><span class="pre">integrate_years()</span></code> or <code class="docutils literal notranslate"><span class="pre">integrate_days()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;Ts&#39;, &#39;Tatm&#39;, &#39;OLR&#39;, &#39;OLRclr&#39;, &#39;OLRcld&#39;, &#39;TdotLW&#39;, &#39;TdotLW_clr&#39;, &#39;LW_sfc&#39;, &#39;LW_sfc_clr&#39;, &#39;LW_flux_up&#39;, &#39;LW_flux_down&#39;, &#39;LW_flux_net&#39;, &#39;LW_flux_up_clr&#39;, &#39;LW_flux_down_clr&#39;, &#39;LW_flux_net_clr&#39;, &#39;ASR&#39;, &#39;ASRclr&#39;, &#39;ASRcld&#39;, &#39;TdotSW&#39;, &#39;TdotSW_clr&#39;, &#39;SW_sfc&#39;, &#39;SW_sfc_clr&#39;, &#39;SW_flux_up&#39;, &#39;SW_flux_down&#39;, &#39;SW_flux_net&#39;, &#39;SW_flux_up_clr&#39;, &#39;SW_flux_down_clr&#39;, &#39;SW_flux_net_clr&#39;, &#39;insolation&#39;, &#39;coszen&#39;, &#39;q&#39;])
</pre></div>
</div>
</div>
</div>
<p>Here we use the <code class="docutils literal notranslate"><span class="pre">timeave['insolation']</span></code> to plot the annual mean insolation.</p>
<p>(We know it is the <em>annual</em> average because the last call to <code class="docutils literal notranslate"><span class="pre">model.integrate_years</span></code> was for exactly 1 year)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;insolation&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Insolation (W/m2)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Insolation (W/m2)&#39;)
</pre></div>
</div>
<img alt="../_images/advanced-heat-transport_26_1.png" src="../_images/advanced-heat-transport_26_1.png" />
</div>
</div>
</section>
<section id="compare-annual-average-temperature-in-rce-to-the-zonal-annual-mean-observations">
<h3>Compare annual average temperature in RCE to the zonal-, annual mean observations.<a class="headerlink" href="#compare-annual-average-temperature-in-rce-to-the-zonal-annual-mean-observations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot annual mean surface temperature in the model,</span>
<span class="c1">#   compare to observed annual mean surface temperatures</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Ts&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;RCE&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ncep_temp_zon</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">ncep_temp_zon</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_28_0.png" src="../_images/advanced-heat-transport_28_0.png" />
</div>
</div>
<p>Our modeled RCE state is <strong>far too warm in the tropics</strong>, and <strong>too cold in the mid- to high latitudes.</strong></p>
</section>
<section id="vertical-structure-of-temperature-comparing-rce-to-observations">
<h3>Vertical structure of temperature: comparing RCE to observations<a class="headerlink" href="#vertical-structure-of-temperature-comparing-rce-to-observations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Observed air temperature from NCEP reanalysis</span>
<span class="c1">## The NOAA ESRL server is shutdown! January 2019</span>
<span class="n">ncep_air</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span> <span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;pressure/air.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#air = xr.open_dataset(url+&#39;pressure/air&#39;)</span>
<span class="c1">#ncep_air = air.rename({&#39;lev&#39;:&#39;level&#39;})</span>
<span class="n">level_ncep_air</span> <span class="o">=</span> <span class="n">ncep_air</span><span class="o">.</span><span class="n">level</span>
<span class="n">lat_ncep_air</span> <span class="o">=</span> <span class="n">ncep_air</span><span class="o">.</span><span class="n">lat</span>
<span class="n">Tzon</span> <span class="o">=</span> <span class="n">ncep_air</span><span class="o">.</span><span class="n">air</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Compare temperature profiles in RCE and observations</span>
<span class="n">contours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">350.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cax1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lat_ncep_air</span><span class="p">,</span> <span class="n">level_ncep_air</span><span class="p">,</span> <span class="n">Tzon</span><span class="o">+</span><span class="n">const</span><span class="o">.</span><span class="n">tempCtoK</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Observered temperature (K)&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">field</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;Tatm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">cax2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">lev</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;RCE temperature (K)&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_32_0.png" src="../_images/advanced-heat-transport_32_0.png" />
</div>
</div>
<p>Again, this plot reveals temperatures that are too warm in the tropics, too cold at the poles throughout the troposphere.</p>
<p>Note however that the <strong>vertical temperature gradients</strong> are largely dictated by the convective adjustment in our model. We have parameterized this gradient, and so we can change it by changing our parameter for the adjustment.</p>
<p>We have (as yet) no parameterization for the <strong>horizontal</strong> redistribution of energy in the climate system.</p>
</section>
<section id="toa-energy-budget-in-rce-equilibrium">
<h3>TOA energy budget in RCE equilibrium<a class="headerlink" href="#toa-energy-budget-in-rce-equilibrium" title="Permalink to this headline">#</a></h3>
<p>Because there is no horizontal energy transport in this model, the TOA radiation budget should be closed (net flux is zero) at all latitudes.</p>
<p>Let’s check this by plotting time-averaged shortwave and longwave radiation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;ASR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ASR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">timeave</span><span class="p">[</span><span class="s1">&#39;OLR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OLR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_35_0.png" src="../_images/advanced-heat-transport_35_0.png" />
</div>
</div>
<p>Indeed, the budget is (very nearly) closed everywhere. Each latitude is in energy balance, independent of every other column.</p>
<hr class="docutils" />
<p><a id='section3'></a></p>
</section>
</section>
<section id="observed-and-modeled-toa-radiation-budget">
<h2>3. Observed and modeled TOA radiation budget<a class="headerlink" href="#observed-and-modeled-toa-radiation-budget" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>We are going to look at the (time average) TOA budget as a function of latitude to see how it differs from the RCE state we just plotted.</p>
<p>Ideally we would look at actual satellite observations of SW and LW fluxes. Instead, here we will use the NCEP Reanalysis for convenience.</p>
<p>But bear in mind that the radiative fluxes in the reanalysis are a model-generated product, they are not really observations.</p>
<section id="toa-budget-from-ncep-reanalysis">
<h3>TOA budget from NCEP Reanalysis<a class="headerlink" href="#toa-budget-from-ncep-reanalysis" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get TOA radiative flux data from NCEP reanalysis</span>
<span class="c1"># downwelling SW</span>
<span class="n">dswrf</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s1">&#39;/other_gauss/dswrf.ntat.mon.1981-2010.ltm.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#dswrf = xr.open_dataset(url + &#39;other_gauss/dswrf&#39;)</span>
<span class="c1">#  upwelling SW</span>
<span class="n">uswrf</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s1">&#39;/other_gauss/uswrf.ntat.mon.1981-2010.ltm.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#uswrf = xr.open_dataset(url + &#39;other_gauss/uswrf&#39;)</span>
<span class="c1">#  upwelling LW</span>
<span class="n">ulwrf</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s1">&#39;/other_gauss/ulwrf.ntat.mon.1981-2010.ltm.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#ulwrf = xr.open_dataset(url + &#39;other_gauss/ulwrf&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ASR</span> <span class="o">=</span> <span class="n">dswrf</span><span class="o">.</span><span class="n">dswrf</span> <span class="o">-</span> <span class="n">uswrf</span><span class="o">.</span><span class="n">uswrf</span>
<span class="n">OLR</span> <span class="o">=</span> <span class="n">ulwrf</span><span class="o">.</span><span class="n">ulwrf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ASRzon</span> <span class="o">=</span> <span class="n">ASR</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
<span class="n">OLRzon</span> <span class="o">=</span> <span class="n">OLR</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ASRzon</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">ASRzon</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ASR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">OLRzon</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">OLRzon</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OLR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">310</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Observed annual mean radiation at TOA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_43_0.png" src="../_images/advanced-heat-transport_43_0.png" />
</div>
</div>
<p>We find that ASR does NOT balance OLR in most locations.</p>
<p>Across the tropics the absorbed solar radiation exceeds the longwave emission to space.  The tropics have a <strong>net gain of energy by radiation</strong>.</p>
<p>The opposite is true in mid- to high latitudes: <strong>the Earth is losing energy by net radiation to space</strong> at these latitudes.</p>
</section>
<section id="toa-budget-from-the-control-cesm-simulation">
<h3>TOA budget from the control CESM simulation<a class="headerlink" href="#toa-budget-from-the-control-cesm-simulation" title="Permalink to this headline">#</a></h3>
<p>Load data from the fully coupled CESM control simulation that we’ve used before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">casenames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">:</span> <span class="s1">&#39;cpl_1850_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">:</span> <span class="s1">&#39;cpl_CO2ramp_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;som_control&#39;</span><span class="p">:</span> <span class="s1">&#39;som_1850_f19&#39;</span><span class="p">,</span>
             <span class="s1">&#39;som_2xCO2&#39;</span><span class="p">:</span>   <span class="s1">&#39;som_1850_2xCO2&#39;</span><span class="p">,</span>
            <span class="p">}</span>
<span class="c1"># The path to the THREDDS server, should work from anywhere</span>
<span class="n">basepath</span> <span class="o">=</span> <span class="s1">&#39;http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/&#39;</span>
<span class="c1"># For better performance if you can access the roselab_rit filesystem (e.g. from JupyterHub)</span>
<span class="c1">#basepath = &#39;/roselab_rit/cesm_archive/&#39;</span>
<span class="n">casepaths</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">casenames</span><span class="p">:</span>
    <span class="n">casepaths</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">basepath</span> <span class="o">+</span> <span class="n">casenames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/concatenated/&#39;</span>

<span class="c1"># make a dictionary of all the CAM atmosphere output</span>
<span class="n">atm</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">casenames</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">casepaths</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">casenames</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.cam.h0.nc&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting to open the dataset &#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
    <span class="n">atm</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_1850_f19/concatenated/cpl_1850_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_CO2ramp_f19/concatenated/cpl_CO2ramp_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_f19/concatenated/som_1850_f19.cam.h0.nc
Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_2xCO2/concatenated/som_1850_2xCO2.cam.h0.nc
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_cesm</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span>
<span class="n">ASR_cesm</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">FSNT</span>
<span class="n">OLR_cesm</span> <span class="o">=</span> <span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">FLNT</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the last 10 years from the slab ocean control simulation</span>
<span class="c1"># and the last 20 years from the coupled control</span>
<span class="n">nyears_slab</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">nyears_cpl</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">clim_slice_slab</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">nyears_slab</span><span class="o">*</span><span class="mi">12</span><span class="p">),</span><span class="kc">None</span><span class="p">)</span>
<span class="n">clim_slice_cpl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">nyears_cpl</span><span class="o">*</span><span class="mi">12</span><span class="p">),</span><span class="kc">None</span><span class="p">)</span>

<span class="c1">#  For now we&#39;re just working with the coupled control simulation</span>
<span class="c1">#  Take the time and zonal average</span>
<span class="n">ASR_cesm_zon</span> <span class="o">=</span> <span class="n">ASR_cesm</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_slab</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
<span class="n">OLR_cesm_zon</span> <span class="o">=</span> <span class="n">OLR_cesm</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">clim_slice_slab</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can make the same plot of ASR and OLR that we made for the observations above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">ASR_cesm_zon</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ASR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">OLR_cesm_zon</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OLR&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;W/m2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">310</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CESM control simulation: Annual mean radiation at TOA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_50_0.png" src="../_images/advanced-heat-transport_50_0.png" />
</div>
</div>
<p>Essentially the same story as the reanalysis data: there is a <strong>surplus of energy across the tropics</strong> and a net <strong>energy deficit in mid- to high latitudes</strong>.</p>
<p>There are two locations where ASR = OLR, near about 35º in both hemispheres.</p>
</section>
</section>
<hr class="docutils" />
<section id="the-energy-budget-for-a-zonal-band">
<h2>4. The energy budget for a zonal band<a class="headerlink" href="#the-energy-budget-for-a-zonal-band" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<section id="the-basic-idea">
<h3>The basic idea<a class="headerlink" href="#the-basic-idea" title="Permalink to this headline">#</a></h3>
<p>Through most of the previous notes we have been thinking about <strong>global averages</strong>.</p>
<p>We’ve been working with an energy budget that looks something like this:</p>
<p><img alt="Column sketch" src="../_images/column_sketch.pdf" /></p>
<p>When we start thinking about regional climates, we need to modify our budget to account for the <strong>additional heating or cooling</strong> due to <strong>transport</strong> in and out of the column:</p>
<p><img alt="Column sketch 2" src="../_images/column_sketch2.pdf" /></p>
<p>Conceptually, the additional energy source is the difference between what’s coming in and what’s going out:</p>
<div class="math notranslate nohighlight">
\[ h = \mathcal{H}_{in}  - \mathcal{H}_{out} \]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is a <strong>dynamic heating rate</strong> in W m<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
</section>
<section id="a-more-careful-budget">
<h3>A more careful budget<a class="headerlink" href="#a-more-careful-budget" title="Permalink to this headline">#</a></h3>
<p>Let’s now consider a thin band of the climate system, of width <span class="math notranslate nohighlight">\(\delta \phi\)</span> , and write down a careful energy budget for it.</p>
<p><img alt="Zonal energy budget sketch" src="../_images/ZonalEnergyBudget_sketch.png" /></p>
<p>Let <span class="math notranslate nohighlight">\(\mathcal{H}(\phi)\)</span> be the total rate of northward energy transport across the latitude line <span class="math notranslate nohighlight">\(\phi\)</span>, measured in Watts (usually PW).</p>
<p>Let <span class="math notranslate nohighlight">\(T(\phi,t)\)</span> be the zonal average surface temperature (“zonal average” = average around latitude circle).</p>
<p>We can write the energy budget as</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E}{\partial t} = \text{energy in} - \text{energy out} \]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> is the total energy content of the column, which is useful to write as</p>
<div class="math notranslate nohighlight">
\[ E = \int_{bottom}^{top} \rho ~ e ~ dz \]</div>
<p>and <span class="math notranslate nohighlight">\(e\)</span> is the local <strong>enthalpy</strong> of the fluid, in units of J kg<span class="math notranslate nohighlight">\(^{-1}\)</span>. The integral energy content <span class="math notranslate nohighlight">\(E\)</span> thus has units of J m<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
<p>We have written the time tendency as a partial derivative now because <span class="math notranslate nohighlight">\(E\)</span> varies in both space and time.</p>
<p>Now there are two energy sources and two energy sinks to think about:
Radiation and dynamics (horizontal transport)</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E}{\partial t} = R_{TOA} - (\text{transport out} - \text{transport in})~/ ~\text{area of band} \]</div>
<p>where we define the net incoming radiation at the top of atmosphere as</p>
<div class="math notranslate nohighlight">
\[ R_{TOA} = \text{ASR} - \text{OLR} = (1-\alpha) Q - \text{OLR} \]</div>
<p>The surface area of the latitude band is</p>
<div class="math notranslate nohighlight">
\[ A = \text{Circumference} ~\times ~ \text{north-south width} \]</div>
<div class="math notranslate nohighlight">
\[ A = 2 \pi a \cos \phi  ~ \times ~  a \delta \phi  \]</div>
<div class="math notranslate nohighlight">
\[ A = 2 \pi a^2  \cos⁡\phi ~ \delta\phi \]</div>
<p>We will denote the energy transport in and out of the band respectively as <span class="math notranslate nohighlight">\(\mathcal{H}(\phi), \mathcal{H}(\phi + \delta\phi)\)</span></p>
<p>Then the budget can be written</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E}{\partial t} = \text{ASR} - \text{OLR} - \frac{1}{2 \pi a^2  \cos⁡\phi ~ \delta\phi} \Big( \mathcal{H}(\phi + \delta\phi) - \mathcal{H}(\phi) \Big) \]</div>
<p>For thin bands where <span class="math notranslate nohighlight">\(\delta\phi\)</span> is very small, we can write</p>
<div class="math notranslate nohighlight">
\[ \frac{1}{\delta\phi} \Big( \mathcal{H}(\phi + \delta\phi) - \mathcal{H}(\phi) \Big) = \frac{\partial \mathcal{H}}{\partial \phi} \]</div>
<p>So the local budget at any latitude <span class="math notranslate nohighlight">\(\phi\)</span> is</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E}{\partial t} = \text{ASR} - \text{OLR} - \frac{1}{2 \pi a^2  \cos⁡\phi } \frac{\partial \mathcal{H}}{\partial \phi} \]</div>
<p>The <strong>dynamical heating rate</strong> in W m<span class="math notranslate nohighlight">\(^{-2}\)</span> is thus</p>
<div class="math notranslate nohighlight">
\[ h = - \frac{1}{2 \pi a^2  \cos⁡\phi } \frac{\partial \mathcal{H}}{\partial \phi} \]</div>
<p>which is the <strong>convergence of energy transport</strong> into this latitude band: the difference between what’s coming in and what’s going out.</p>
</section>
<section id="calculating-heat-transport-from-the-steady-state-energy-budget">
<h3>Calculating heat transport from the steady-state energy budget<a class="headerlink" href="#calculating-heat-transport-from-the-steady-state-energy-budget" title="Permalink to this headline">#</a></h3>
<p>Notice that if the above budget is in <strong>equilibrium</strong> then <span class="math notranslate nohighlight">\(\partial E/ \partial t = 0\)</span> and the budget says that <strong>divergence of heat transport balances the net radiative heating</strong> at every latitude.</p>
<p>If we can <strong>assume that the budget is balanced</strong>, i.e. assume that the system is at equilibrium and there is negligible heat storage, then we can use the budget to infer <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> from a measured (or modeled) TOA radiation imbalance.</p>
<p>Setting <span class="math notranslate nohighlight">\(\partial E/ \partial t = 0\)</span> and rearranging:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial \mathcal{H}}{\partial \phi}  = 2 \pi ~a^2  \cos⁡\phi ~ R_{TOA} \]</div>
<p>Now integrate from the South Pole (<span class="math notranslate nohighlight">\(\phi = -\pi/2\)</span>):</p>
<div class="math notranslate nohighlight">
\[ \int_{-\pi/2}^{\phi} \frac{\partial \mathcal{H}}{\partial \phi^\prime}  d\phi^\prime = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} \cos⁡\phi^\prime ~ R_{TOA} d\phi^\prime  \]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{H}(\phi) - \mathcal{H}(-\pi/2) = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} \cos⁡\phi^\prime ~ R_{TOA} d\phi^\prime  \]</div>
<p>Our boundary condition is that the transport must go to zero at the pole. We therefore have a formula for calculating the heat transport at any latitude, by integrating the imbalance from the South Pole:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}(\phi) = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} \cos⁡\phi^\prime ~ R_{TOA} d\phi^\prime  \]</div>
<p>What about the boundary condition at the other pole? We must have <span class="math notranslate nohighlight">\(\mathcal{H}(\pi/2) = 0\)</span> as well, because a non-zero transport at the pole is not physically meaningful.</p>
<p>Notice that if we apply the above formula and integrate all the way to the other pole, we then have</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}(\pi/2) = 2 \pi ~a^2 \int_{-\pi/2}^{\pi/2} \cos⁡\phi^\prime ~ R_{TOA} d\phi^\prime  \]</div>
<p>This is an integral of the radiation imbalance weighted by cosine of latitude. In other words, this is <strong>proportional to the area-weighted global average energy imbalance</strong>.</p>
<p>We started by assuming that this imbalance is zero.</p>
<p>If the <strong>global budget is balanced</strong>, then the physical boundary condition of no-flux at the poles is satisfied.</p>
<hr class="docutils" />
<p><a id='section5'></a></p>
</section>
</section>
<section id="observed-and-modeled-poleward-heat-transport">
<h2>5. Observed and modeled poleward heat transport<a class="headerlink" href="#observed-and-modeled-poleward-heat-transport" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Here we will code up a function that performs the above integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inferred_heat_transport</span><span class="p">(</span><span class="n">energy_in</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Compute heat transport as integral of local energy imbalance.</span>
<span class="sd">    Required input:</span>
<span class="sd">        energy_in: energy imbalance in W/m2, positive in to domain</span>
<span class="sd">    As either numpy array or xarray.DataArray</span>
<span class="sd">    If using plain numpy, need to supply these arguments:</span>
<span class="sd">        lat: latitude in degrees</span>
<span class="sd">        latax: axis number corresponding to latitude in the data</span>
<span class="sd">            (axis over which to integrate)</span>
<span class="sd">    returns the heat transport in PW.</span>
<span class="sd">    Will attempt to return data in xarray.DataArray if possible.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
    <span class="kn">from</span> <span class="nn">climlab</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
    <span class="k">if</span> <span class="n">lat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">energy_in</span><span class="o">.</span><span class="n">lat</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Need to supply latitude array if input data is not self-describing.&#39;</span><span class="p">)</span>
    <span class="n">lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">)</span>
    <span class="n">field</span> <span class="o">=</span> <span class="n">coslat</span><span class="o">*</span><span class="n">energy_in</span>
    <span class="k">if</span> <span class="n">latax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">latax</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get_axis_num</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Need to supply axis number for integral over latitude.&#39;</span><span class="p">)</span>
    <span class="c1">#  result as plain numpy array</span>
    <span class="n">integral</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">lat_rad</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">latax</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1E-15</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">integral</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">):</span>
        <span class="n">result_xarray</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">result_xarray</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result_xarray</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now use this to calculate the total northward heat transport from our control simulation with the CESM:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">ASR_cesm_zon</span> <span class="o">-</span> <span class="n">OLR_cesm_zon</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Total northward heat transport inferred from CESM control simulation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Total northward heat transport inferred from CESM control simulation&#39;)
</pre></div>
</div>
<img alt="../_images/advanced-heat-transport_77_1.png" src="../_images/advanced-heat-transport_77_1.png" />
</div>
</div>
<p>The total heat transport is very nearly symmetric about the equator, with poleward transport of about 5 to 6 PW in both hemispheres.</p>
<p>The transport peaks in magnitude near 35º latitude, the same latitude where we found that ASR = OLR. This is no coincidence!</p>
<p>Equatorward of 35º (across the tropics) there is <strong>net heating by radiation</strong> and <strong>net cooling by dynamics</strong>. The opposite is true poleward of 35º.</p>
<p>What about the “observations”, i.e. the reanalysis data?</p>
<p>We can try to do the same calculation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Need to flip the arrays because we want to start from the south pole</span>
<span class="n">Rtoa_ncep</span> <span class="o">=</span> <span class="n">ASRzon</span><span class="o">-</span><span class="n">OLRzon</span>
<span class="n">lat_ncep</span> <span class="o">=</span> <span class="n">ASRzon</span><span class="o">.</span><span class="n">lat</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_ncep</span><span class="p">,</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Rtoa_ncep</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Total northward heat transport inferred from NCEP reanalysis&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Total northward heat transport inferred from NCEP reanalysis&#39;)
</pre></div>
</div>
<img alt="../_images/advanced-heat-transport_80_1.png" src="../_images/advanced-heat-transport_80_1.png" />
</div>
</div>
<p>Our integral <strong>does NOT go to zero at the North Pole!</strong>. This means that the global energy budget is NOT balanced in the reanalysis data.</p>
<p>Let’s look at the global imbalance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  global average of TOA radiation in reanalysis data</span>
<span class="n">weight_ncep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat_ncep</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat_ncep</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="n">imbal_ncep</span> <span class="o">=</span> <span class="p">(</span><span class="n">Rtoa_ncep</span> <span class="o">*</span> <span class="n">weight_ncep</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;The net downward TOA radiation flux in NCEP renalysis data is </span><span class="si">%0.1f</span><span class="s1"> W/m2.&#39;</span> <span class="o">%</span><span class="k">imbal_ncep</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The net downward TOA radiation flux in NCEP renalysis data is -12.0 W/m2.
</pre></div>
</div>
</div>
</div>
<p>Evidently there is a substantial net flux out to space in this dataset.</p>
<p>Before we can compute heat transport from this data, we need to <strong>balance the global data</strong>.</p>
<p>To do this requires making assumptions about the spatial distribution of the imbalance.</p>
<p>The simplest assumption we can make is that the imbalance is uniform across the Earth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rtoa_ncep_balanced</span> <span class="o">=</span> <span class="n">Rtoa_ncep</span> <span class="o">-</span> <span class="n">imbal_ncep</span>
<span class="n">newimbalance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">Rtoa_ncep_balanced</span> <span class="o">*</span> <span class="n">weight_ncep</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;The net downward TOA radiation flux after balancing the data is </span><span class="si">%0.2e</span><span class="s1"> W/m2.&#39;</span> <span class="o">%</span><span class="k">newimbalance</span>)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The net downward TOA radiation flux after balancing the data is -1.89e-06 W/m2.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_ncep</span><span class="p">,</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Rtoa_ncep_balanced</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PW&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Total northward heat transport inferred from NCEP reanalysis (after global balancing)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Total northward heat transport inferred from NCEP reanalysis (after global balancing)&#39;)
</pre></div>
</div>
<img alt="../_images/advanced-heat-transport_85_1.png" src="../_images/advanced-heat-transport_85_1.png" />
</div>
</div>
<p>We now get a physically sensible result (zero at both poles).</p>
<p>The heat transport is poleward everywhere, and very nearly anti-symmetric across the equator. The shape is very similar to what we found from the CESM simulation, with peaks near 35º.</p>
<p>However the magnitude of the peaks is substantially smaller. <strong>Does this indicate a shortcoming of the CESM simulation?</strong></p>
<p><strong>Probably not!</strong></p>
<p>It turns out that our result here is <strong>very sensitive to the details</strong> of how we balance the radiation data.</p>
<p>As an exercise, you might try applying different corrections other than the globally uniform correction we used above. E.g. try weighting the tropics or the mid-latitudes more strongly.</p>
<section id="an-example-of-a-recently-published-observational-estimate-of-meridional-heat-transport">
<h3>An example of a recently published observational estimate of meridional heat transport<a class="headerlink" href="#an-example-of-a-recently-published-observational-estimate-of-meridional-heat-transport" title="Permalink to this headline">#</a></h3>
<p><img alt="Fasullo and Trenberth 2008b, Figure 7" src="../_images/Fasullo_Trenberth_2008b_Fig7.jpg" /></p>
<blockquote>
<div><p>The ERBE period zonal mean annual cycle of the meridional energy transport in PW by (a) the atmosphere and ocean as inferred from ERBE <span class="math notranslate nohighlight">\(R_T\)</span>, NRA <span class="math notranslate nohighlight">\(\delta\)</span>A_E/<span class="math notranslate nohighlight">\(\delta\)</span>t, and GODAS <span class="math notranslate nohighlight">\(\delta\)</span>O_E/<span class="math notranslate nohighlight">\(\delta\)</span>t; (b) the atmosphere based on NRA; and (c) by the ocean as implied by ERBE + NRA <span class="math notranslate nohighlight">\(F_S\)</span> and GODAS <span class="math notranslate nohighlight">\(\delta\)</span>O_E/<span class="math notranslate nohighlight">\(\delta\)</span>t. Stippling and hatching in (a)–(c) represent regions and times of year in which the standard deviation of the monthly mean values among estimates, some of which include the CERES period (see text), exceeds 0.5 and 1.0 PW, respectively. (d) The median annual mean transport by latitude for the total (gray), atmosphere (red), and ocean (blue) accompanied with the associated <span class="math notranslate nohighlight">\(\pm2\sigma\)</span> range (shaded).</p>
</div></blockquote>
<p>This is a reproduction of Figure 7 from Fasullo and Trenberth (2008), “The Annual Cycle of the Energy Budget. Part II: Meridional Structures and Poleward Transports”, J. Climate 21, doi:10.1175/2007JCLI1936.1</p>
<p>This figure shows the breakdown of the heat transport by <strong>season</strong> as well as the <strong>partition between the atmosphere and ocean</strong>.</p>
<p>Focussing just on the total, annual transport in panel (d) (black curve), we see that is quite consistent with what we computed from the CESM simulation.</p>
<hr class="docutils" />
<p><a id='section6'></a></p>
</section>
</section>
<section id="energy-budgets-for-the-atmosphere-and-ocean">
<h2>6. Energy budgets for the atmosphere and ocean<a class="headerlink" href="#energy-budgets-for-the-atmosphere-and-ocean" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>The total transport (which we have been inferring from the TOA radiation imbalance) includes contributions from both the <strong>atmosphere</strong> and the <strong>ocean</strong>:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = \mathcal{H}_{a} + \mathcal{H}_{o} \]</div>
<p>We have used the <strong>TOA imbalance</strong> to infer the total transport because TOA radiation is the only significant energy source / sink to the climate system as a whole.</p>
<p>However, if we want to study (or model) the individual contributions from the atmosphere and ocean, we need to consider the energy budgets for <strong>each individual domain</strong>.</p>
<p>We will therefore need to broaden our discussion to include the <strong>net surface heat flux</strong>, i.e. the total flux of energy between the surface and the atmosphere.</p>
<section id="surface-fluxes">
<h3>Surface fluxes<a class="headerlink" href="#surface-fluxes" title="Permalink to this headline">#</a></h3>
<p>Let’s denote the <strong>net upward energy flux at the surface</strong> as <span class="math notranslate nohighlight">\(F_S\)</span>.</p>
<p>There are four principal contributions to <span class="math notranslate nohighlight">\(F_S\)</span>:</p>
<ol class="simple">
<li><p>Shortwave radiation</p></li>
<li><p>Longwave radiation</p></li>
<li><p>Sensible heat flux</p></li>
<li><p>Evaporation or latent heat flux</p></li>
</ol>
<p>Sensible and latent heat fluxes involve turbulent exchanges in the planetary boundary layer. We will look at these in more detail later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># monthly climatologies for surface flux data from reanalysis</span>
<span class="c1">#  all defined as positive UP</span>
<span class="n">ncep_nswrs</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;surface_gauss/nswrs.sfc.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ncep_nlwrs</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;surface_gauss/nlwrs.sfc.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ncep_shtfl</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;surface_gauss/shtfl.sfc.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ncep_lhtfl</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ncep_url</span> <span class="o">+</span> <span class="s2">&quot;surface_gauss/lhtfl.sfc.mon.1981-2010.ltm.nc&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#ncep_nswrs = xr.open_dataset(url + &#39;surface_gauss/nswrs&#39;)</span>
<span class="c1">#ncep_nlwrs = xr.open_dataset(url + &#39;surface_gauss/nlwrs&#39;)</span>
<span class="c1">#ncep_shtfl = xr.open_dataset(url + &#39;surface_gauss/shtfl&#39;)</span>
<span class="c1">#ncep_lhtfl = xr.open_dataset(url + &#39;surface_gauss/lhtfl&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Calculate ANNUAL AVERAGE net upward surface flux</span>
<span class="n">ncep_net_surface_up</span> <span class="o">=</span> <span class="p">(</span><span class="n">ncep_nlwrs</span><span class="o">.</span><span class="n">nlwrs</span>
                     <span class="o">+</span> <span class="n">ncep_nswrs</span><span class="o">.</span><span class="n">nswrs</span>
                     <span class="o">+</span> <span class="n">ncep_shtfl</span><span class="o">.</span><span class="n">shtfl</span>
                     <span class="o">+</span> <span class="n">ncep_lhtfl</span><span class="o">.</span><span class="n">lhtfl</span>
                      <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lon_ncep</span> <span class="o">=</span> <span class="n">ncep_net_surface_up</span><span class="o">.</span><span class="n">lon</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_ncep</span><span class="p">,</span> <span class="n">lat_ncep</span><span class="p">,</span> <span class="n">ncep_net_surface_up</span><span class="p">,</span> 
               <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">seismic</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">200.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">200.</span> <span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Net upward surface energy flux in NCEP Reanalysis data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-34-7044f10ef929&gt;:3: MatplotlibDeprecationWarning: shading=&#39;flat&#39; when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading=&#39;auto&#39;, &#39;nearest&#39; or &#39;gouraud&#39;, or set rcParams[&#39;pcolor.shading&#39;].  This will become an error two minor releases later.
  cax = ax.pcolormesh(lon_ncep, lat_ncep, ncep_net_surface_up,
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Net upward surface energy flux in NCEP Reanalysis data&#39;)
</pre></div>
</div>
<img alt="../_images/advanced-heat-transport_99_2.png" src="../_images/advanced-heat-transport_99_2.png" />
</div>
</div>
<p>Discuss…  Large net fluxes over ocean, not over land.</p>
</section>
<section id="energy-budget-for-the-ocean">
<h3>Energy budget for the ocean<a class="headerlink" href="#energy-budget-for-the-ocean" title="Permalink to this headline">#</a></h3>
<p>Using exactly the same reasoning we used for the whole climate system, we can write a budget for the OCEAN ONLY:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E_o}{\partial t} = -F_S - \frac{1}{2 \pi a^2  \cos⁡\phi } \frac{\partial \mathcal{H_o}}{\partial \phi} \]</div>
<p>In principle it is possible to calculate <span class="math notranslate nohighlight">\(\mathcal{H}_o\)</span> from this budget, analagously to how we calculated the total <span class="math notranslate nohighlight">\(\mathcal{H}\)</span>.</p>
<p>Assuming that</p>
<ul class="simple">
<li><p>surface fluxes are well-known</p></li>
<li><p>the ocean heat storage is negligible (a big assumption!)</p></li>
</ul>
<p>we can write</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}_o(\phi) = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} - \cos⁡\phi^\prime ~ F_S d\phi^\prime  \]</div>
<p>where the minus sign account for the fact that we defined <span class="math notranslate nohighlight">\(F_S\)</span> as <strong>positive up</strong> (out of the ocean).</p>
</section>
<section id="energy-budget-for-the-atmosphere">
<h3>Energy budget for the atmosphere<a class="headerlink" href="#energy-budget-for-the-atmosphere" title="Permalink to this headline">#</a></h3>
<p>The net energy source to the atmosphere is the sum of the TOA flux and the surface flux. Thus we can write</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial E_a}{\partial t} = R_{TOA} + F_S - \frac{1}{2 \pi a^2  \cos⁡\phi } \frac{\partial \mathcal{H_a}}{\partial \phi} \]</div>
<p>and we can similarly integrate to get the transport:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}_a(\phi) = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} \cos⁡\phi^\prime ~ \big( R_{TOA} + F_S \big) d\phi^\prime  \]</div>
<p>Note that these formulas ensure that <span class="math notranslate nohighlight">\(\mathcal{H} = \mathcal{H}_a + \mathcal{H}_o\)</span>.</p>
</section>
<section id="atmospheric-water-budget-and-latent-heat-transport">
<h3>Atmospheric water budget and latent heat transport<a class="headerlink" href="#atmospheric-water-budget-and-latent-heat-transport" title="Permalink to this headline">#</a></h3>
<p>Water vapor contributes to the atmopsheric energy transport because <strong>energy consumed through evaporation</strong> is converted back to <strong>sensible heat</strong> wherever the vapor subsequently condenses.</p>
<p>If the evaporation and the condensation occur at different latitudes then there is a net transport of energy due to the <strong>movement of water vapor</strong>.</p>
<p>We can use the same kind of budget reasoning to compute this <strong>latent heat transport</strong>. But this time we will make a budget for water vapor only.</p>
<p>The only sources and sinks of water vapor to the atmosphere are surface evaporation and precipitation:</p>
<div class="math notranslate nohighlight">
\[ L_v \frac{\partial Q}{\partial t} = L_v \big( Evap - Precip \big) - \frac{1}{2 \pi a^2  \cos⁡\phi } \frac{\partial \mathcal{H}_{LH}}{\partial \phi} \]</div>
<p>Here we are using</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q\)</span> is the depth-integrated water vapor (the “precipitable water”) in kg m<span class="math notranslate nohighlight">\(^{-2}\)</span></p></li>
<li><p>Evap and Precip are in kg m<span class="math notranslate nohighlight">\(^{-2}\)</span> s<span class="math notranslate nohighlight">\(^{-1}\)</span> (equivalent to mm/s)</p></li>
<li><p><span class="math notranslate nohighlight">\(L_v = 2.5 \times 10^6\)</span> J kg<span class="math notranslate nohighlight">\(^{-1}\)</span> is the latent heat of vaporization</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{H}_{LH}\)</span> is the northward latent heat transport</p></li>
</ul>
<p>All terms in the above equation thus have units of W m<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
<p>Using the now-familiar equilibrium reasoning, we can use this water balance to compute the latent heat transport from the net surface evaporation minus precipitation:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}_{LH}(\phi) = 2 \pi ~a^2 \int_{-\pi/2}^{\phi} \cos⁡\phi^\prime ~ L_v ~\big( Evap - Precip \big) d\phi^\prime  \]</div>
<p>From this we can then infer all the energy transport associated with the motion of dry air as a residual:</p>
<div class="math notranslate nohighlight">
\[\mathcal{H}_{Dry} = \mathcal{H}_a - \mathcal{H}_{LH} \]</div>
<hr class="docutils" />
<p><a id='section7'></a></p>
</section>
</section>
<section id="calculating-the-partitioning-of-poleward-energy-transport-into-different-components">
<h2>7. Calculating the partitioning of poleward energy transport into different components<a class="headerlink" href="#calculating-the-partitioning-of-poleward-energy-transport-into-different-components" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>This function implements the above formulas to calculate the following quantities from CESM simulation output:</p>
<ul class="simple">
<li><p>Total heat transport, <span class="math notranslate nohighlight">\(\mathcal{H}\)</span></p></li>
<li><p>Ocean heat transport, <span class="math notranslate nohighlight">\(\mathcal{H}_o\)</span></p></li>
<li><p>Atmospheric heat transport, <span class="math notranslate nohighlight">\(\mathcal{H}_a\)</span></p></li>
<li><p>Atmospheric latent heat transport, <span class="math notranslate nohighlight">\(\mathcal{H}_{LH}\)</span></p></li>
<li><p>Atmospheric dry heat transport, <span class="math notranslate nohighlight">\(\mathcal{H}_{Dry}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CESM_heat_transport</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="n">timeslice</span><span class="o">=</span><span class="n">clim_slice_cpl</span><span class="p">):</span>
    <span class="c1">#  Take zonal and time averages of the necessary input fields</span>
    <span class="n">fieldlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FLNT&#39;</span><span class="p">,</span><span class="s1">&#39;FSNT&#39;</span><span class="p">,</span><span class="s1">&#39;LHFLX&#39;</span><span class="p">,</span><span class="s1">&#39;SHFLX&#39;</span><span class="p">,</span><span class="s1">&#39;FLNS&#39;</span><span class="p">,</span><span class="s1">&#39;FSNS&#39;</span><span class="p">,</span><span class="s1">&#39;PRECSC&#39;</span><span class="p">,</span><span class="s1">&#39;PRECSL&#39;</span><span class="p">,</span><span class="s1">&#39;QFLX&#39;</span><span class="p">,</span><span class="s1">&#39;PRECC&#39;</span><span class="p">,</span><span class="s1">&#39;PRECL&#39;</span><span class="p">]</span>
    <span class="n">zon</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="n">fieldlist</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">timeslice</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
    <span class="n">OLR</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">FLNT</span>
    <span class="n">ASR</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">FSNT</span>
    <span class="n">Rtoa</span> <span class="o">=</span> <span class="n">ASR</span> <span class="o">-</span> <span class="n">OLR</span>  <span class="c1"># net downwelling radiation</span>
    <span class="c1">#  surface energy budget terms, all defined as POSITIVE UP</span>
    <span class="c1">#    (from ocean to atmosphere)</span>
    <span class="n">LHF</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">LHFLX</span>
    <span class="n">SHF</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">SHFLX</span>
    <span class="n">LWsfc</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">FLNS</span>
    <span class="n">SWsfc</span> <span class="o">=</span> <span class="o">-</span><span class="n">zon</span><span class="o">.</span><span class="n">FSNS</span>
    <span class="n">SnowFlux</span> <span class="o">=</span>  <span class="p">((</span><span class="n">zon</span><span class="o">.</span><span class="n">PRECSC</span> <span class="o">+</span> <span class="n">zon</span><span class="o">.</span><span class="n">PRECSL</span><span class="p">)</span> <span class="o">*</span>
                      <span class="n">const</span><span class="o">.</span><span class="n">rho_w</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">Lhfus</span><span class="p">)</span>
    <span class="c1"># net upward radiation from surface</span>
    <span class="n">SurfaceRadiation</span> <span class="o">=</span> <span class="n">LWsfc</span> <span class="o">+</span> <span class="n">SWsfc</span>
    <span class="c1"># net upward surface heat flux</span>
    <span class="n">SurfaceHeatFlux</span> <span class="o">=</span> <span class="n">SurfaceRadiation</span> <span class="o">+</span> <span class="n">LHF</span> <span class="o">+</span> <span class="n">SHF</span> <span class="o">+</span> <span class="n">SnowFlux</span>
    <span class="c1"># net heat flux into atmosphere</span>
    <span class="n">Fatmin</span> <span class="o">=</span> <span class="n">Rtoa</span> <span class="o">+</span> <span class="n">SurfaceHeatFlux</span>
    <span class="c1">#  hydrological cycle, all terms in  kg/m2/s or mm/s</span>
    <span class="n">Evap</span> <span class="o">=</span> <span class="n">zon</span><span class="o">.</span><span class="n">QFLX</span>
    <span class="n">Precip</span> <span class="o">=</span> <span class="p">(</span><span class="n">zon</span><span class="o">.</span><span class="n">PRECC</span> <span class="o">+</span> <span class="n">zon</span><span class="o">.</span><span class="n">PRECL</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">rho_w</span>
    <span class="n">EminusP</span> <span class="o">=</span> <span class="n">Evap</span> <span class="o">-</span> <span class="n">Precip</span>
        
    <span class="c1"># heat transport terms</span>
    <span class="n">HT</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Rtoa</span><span class="p">)</span>
    <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">Fatmin</span><span class="p">)</span>
    <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;ocean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="o">-</span><span class="n">SurfaceHeatFlux</span><span class="p">)</span>
    <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inferred_heat_transport</span><span class="p">(</span><span class="n">EminusP</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">Lhvap</span><span class="p">)</span> <span class="c1"># atm. latent heat transport from moisture imbal.</span>
    <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;dse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">]</span>  <span class="c1"># dry static energy transport as residual</span>

    <span class="k">return</span> <span class="n">HT</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Compute heat transport partition for both control and 2xCO2 simulations</span>
<span class="n">HT_control</span> <span class="o">=</span> <span class="n">CESM_heat_transport</span><span class="p">(</span><span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_control&#39;</span><span class="p">])</span>
<span class="n">HT_2xCO2</span> <span class="o">=</span> <span class="n">CESM_heat_transport</span><span class="p">(</span><span class="n">atm</span><span class="p">[</span><span class="s1">&#39;cpl_CO2ramp&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">runs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HT_control</span><span class="p">,</span> <span class="n">HT_2xCO2</span><span class="p">]</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">HT</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">HT_control</span><span class="p">,</span> <span class="n">HT_2xCO2</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">],</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;atm&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;dse&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dry&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">],</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;latent&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lat_cesm</span><span class="p">,</span> <span class="n">HT</span><span class="p">[</span><span class="s1">&#39;ocean&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ocean&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/advanced-heat-transport_116_0.png" src="../_images/advanced-heat-transport_116_0.png" />
</div>
</div>
<p>Discuss the shape of these curves, before and after the global warming.</p>
<hr class="docutils" />
<p><a id='section8'></a></p>
</section>
<section id="mechanisms-of-heat-transport">
<h2>8. Mechanisms of heat transport<a class="headerlink" href="#mechanisms-of-heat-transport" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Energy is transported across latitude lines whenever there is an exchange of fluids with different energy content: e.g. warm fluid moving northward while colder fluid moves southward.</p>
<p>Thus energy transport always involves <strong>correlations between northward component of velocity <span class="math notranslate nohighlight">\(v\)</span> and energy <span class="math notranslate nohighlight">\(e\)</span></strong></p>
<p>The transport is an integral of these correlations, around a latitude circle and over the depth of the fluid:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = \int_0^{2\pi} \int_{\text{bottom}}^{\text{top}} \rho ~ v ~ e ~ dz ~ a \cos\phi ~ d\lambda\]</div>
<p>The total transport (which we have been inferring from the TOA radiation imbalance) includes contributions from both the <strong>atmosphere</strong> and the <strong>ocean</strong>:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = \mathcal{H}_{a} + \mathcal{H}_{o} \]</div>
<p>We can apply the above definition to both fluids (with appropriate values for bottom and top in the depth integral).</p>
<p>The appropriate measure of energy content is different for the atmosphere and ocean.</p>
<p>For the ocean, we usually use the <strong>enthalpy for an incompressible fluid</strong>:</p>
<div class="math notranslate nohighlight">
\[ e_o \approx c_w ~ T \]</div>
<p>where <span class="math notranslate nohighlight">\(c_w \approx 4.2 \times 10^{3}\)</span> J kg<span class="math notranslate nohighlight">\(^{-1}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span> is the specific heat for seawater.</p>
<p>For the atmosphere, it’s a bit more complicated. We need to account for both the compressibility of air, and for its water vapor content. This is because of the latent energy associated with evaporation and condensation of vapor.</p>
<p>It is convenient to define the <strong>moist static energy</strong> for the atmosphere:</p>
<div class="math notranslate nohighlight">
\[ MSE = c_p ~T + g~ Z + L_v ~q  \]</div>
<p>whose terms are respectively the internal energy, the potential energy, and the latent heat of water vapor (see texts on atmopsheric thermodynamics for details).</p>
<p>We will assume that <span class="math notranslate nohighlight">\(MSE\)</span> is a good approximation to the total energy content of the atmosphere, so</p>
<div class="math notranslate nohighlight">
\[ e_a \approx MSE \]</div>
<p>Note that in both cases we have <strong>neglected the kinetic energy</strong> from this budget.</p>
<p>The kinetic energy per unit mass is <span class="math notranslate nohighlight">\(e_k = |\vec{v}|^2/2\)</span>, where <span class="math notranslate nohighlight">\(\vec{v} = (u,v,w)\)</span> is the velocity vector.</p>
<p>In practice it is a very small component of the total energy content of the fluid and is usually neglected in analyses of poleward energy transport.</p>
<p>As we have seen, we can further divide the atmospheric transport into transports due to the movement of <strong>dry air</strong> (the tranport of <strong>dry static energy</strong>) and transport associated with evaporation and condensation of <strong>water vapor</strong> (the <strong>latent heat transport</strong>)</p>
<section id="mechanisms-of-energy-transport-in-the-ocean">
<h3>Mechanisms of energy transport in the ocean<a class="headerlink" href="#mechanisms-of-energy-transport-in-the-ocean" title="Permalink to this headline">#</a></h3>
<p>Assuming the ocean extends from <span class="math notranslate nohighlight">\(z=-H\)</span> to <span class="math notranslate nohighlight">\(z=0\)</span> we can then write</p>
<div class="math notranslate nohighlight">
\[ \mathcal{H}_o \approx a \cos\phi \int_0^{2\pi} \int_{-H}^{0}  c_w ~\rho ~ v ~ T ~ dz  ~ d\lambda\]</div>
<p>setting <span class="math notranslate nohighlight">\(v ~ T = 0\)</span> at all land locations around the latitude circle.</p>
<p>The northward transport <span class="math notranslate nohighlight">\(\mathcal{H}_o\)</span> is positive if there is a net northward flow of warm water and southward flow of cold water.</p>
<p>This can occur due to <strong>horizontal</strong> differences in currents and temperatures.</p>
<p>The classic example is flow in the subtropical gyres and western boundary currents. In the subtropical North Atlantic, there is rapid northward flow of warm water in the Gulf Stream. This is compensated by a slow southward flow of cooler water across the interior of the basin.</p>
<p><strong>Because the water masses are at different temperatures, equal and opposite north-south exchanges of mass result in net northward transport of energy.</strong></p>
<p>Energy transport can also result from <strong>vertical</strong> structure of the currents.</p>
<p>There is a large-scale <strong>overturning circulation</strong> in the Atlantic that involves near-surface northward flow of warmer water, compensated by deeper southward flow of colder water.</p>
<p>Again, equal exchange of water but net transport of energy.</p>
</section>
<section id="these-notes-are-not-really-finished">
<h3><em>These notes are not really finished…</em><a class="headerlink" href="#these-notes-are-not-really-finished" title="Permalink to this headline">#</a></h3>
</section>
</section>
<hr class="docutils" />
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Permalink to this headline">#</a></h2>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a>, an open-source textbook developed and maintained by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p>It is licensed for free and open consumption under the
<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> license.</p>
<p>Development of these notes and the <a class="reference external" href="https://github.com/brian-rose/climlab">climlab software</a> is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.</p>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./courseware"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="heat-transport.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">19. </span>Heat transport</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="one-dim-ebm.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">20. </span>The one-dimensional energy balance model</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Brian E. J. Rose<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>