{"version":2,"kind":"Notebook","sha256":"fa06c9432748d453240614a85664445f0fbdeab189b53c09a57c33e36929b57c","slug":"courseware.rce","location":"/courseware/rce.ipynb","dependencies":[],"frontmatter":{"title":"Radiative-Convective Equilibrium","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"}],"doi":"https://doi.org/10.5281/zenodo.4265097","open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/brian-rose/ClimateLaboratoryBook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"}],"abbreviations":{"TOA":"Top of Atmosphere","SW":"Shortwave","LW":"Longwave","UV":"Ultraviolet","IR":"Infrared","OLR":"Outgoing Longwave Radiation","ASR":"Absorbed Shortwave Radiation","CC":"Clausius-Clapeyron","LWP":"Liquid Water Path","CRE":"Cloud Radiative Effect","ECS":"Equilibrium Climate Sensitivity","TCR":"Transient Climate Response","WV":"Water Vapor","LR":"Lapse Rate","LCL":"Lifting Condensation Level","LGM":"Last Glacial Maximum","MSE":"Moist Static Energy","AHT":"Atmospheric Heat Transport","OHT":"Ocean Heat Transport","THT":"Total Heat Transport","1D":"One-dimensional","2D":"Two-dimensional","3D":"Three-dimensional","lat":"latitude","lon":"longitude","ppm":"parts per million","ppmv":"parts per million by volume","hPa":"hectoPascals","Ma":"Millions of years","LHS":"Left hand side","RHS":"Right hand side","EBM":"Energy Balance Model","GCM":"Global Circulation Model","OGCM":"Ocean Global Circulation Model","AGCM":"Atmospheric Global Circulation Model","AOGCM":"Atmosphere-Ocean Global Circulation Model","CGCM":"Coupled Global Circulation Model","RC":"Radiative-Convective","RCM":"Radiative-Convective Model","RCE":"Radiative-Convective Equilibrium","SCM":"Single-Column Model","ESM":"Earth System Model","SD":"Statistical-Dynamical","EMIC":"Earth System Model of Intermediate Complexity","IAM":"Integrated Asessment Model","SOM":"Slab Ocean Model","CESM":"Community Earth System Model","CAM":"Community Atmosphere Model","POP":"Parallel Ocean Program","CLM":"Community Land Model","CICE":"Community Ice CodE","RRTMG":"Rapid Radiative Transfer Model","ODE":"Ordinary Differential Equation","PDE":"Partial Differential Equation","FTCS":"Forward Time, Centered Space","URL":"Uniform Research Locator","CMIP":"Coupled Model Intercomparison Project","IPCC":"Intergovernmental Panel on Climate Change","AR5":"Fifth Assessment Report","AR6":"Sixth Assessment Report","WG1":"Working Group 1","NCAR":"National Center for Atmospheric Research","AMS":"American Meteorological Society","NCEP":"National Centers for Environmental Prediction"},"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/brian-rose/ClimateLaboratoryBook/blob/main/courseware/rce.ipynb","exports":[{"format":"ipynb","filename":"rce.ipynb","url":"/ClimateLaboratoryBook/build/rce-89348d92962d9cb3783b424d88cfdf55.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"slide"}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WckW7fsvQD"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gsH1oQMdwZ"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"grgM2uyuJZ"},{"type":"text","value":" by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"phMah3vMVc"},{"type":"link","url":"http://www.atmos.albany.edu/facstaff/brose/index.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X84QBpqkEc"}],"urlSource":"http://www.atmos.albany.edu/facstaff/brose/index.html","key":"pzBrUWMr6S"},{"type":"text","value":", University at Albany.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m4eqzE04tw"}],"key":"yodLLkG8Ko"}],"key":"FsjtlOFD33"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vKZtHQ5nGO"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1. Recap of radiative equilibrium results","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JH5rCPbDlO"}],"identifier":"id-1-recap-of-radiative-equilibrium-results","label":"1. Recap of radiative equilibrium results","html_id":"id-1-recap-of-radiative-equilibrium-results","implicit":true,"key":"VVAfQ1PZ4K"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CiHhI0U4nf"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Here we summarize results we generated in the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lBqwyNlbgK"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook/courseware/radeq.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Lecture on radiative equilibrium","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AhvDI6HcLt"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook/courseware/radeq.html","key":"WCNbQig2bI"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"h4lf2kVbrY"}],"key":"oKY8Kfzosh"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"For Python details, click to expand the code","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"u0b3oAq3Sb"}],"key":"EgXlcPLCqs"}],"key":"gUn9iJRdMS"}],"key":"Byv5mF9FTj"},{"type":"block","kind":"notebook-code","data":{"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport xarray as xr\nfrom metpy.plots import SkewT\n#  This code is used just to create the skew-T plot of global, annual mean air temperature\nncep_url = \"http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/ncep.reanalysis.derived/\"\ntime_coder = xr.coders.CFDatetimeCoder(use_cftime=True)\nncep_air = xr.open_dataset( ncep_url + \"pressure/air.mon.1981-2010.ltm.nc\", decode_times=time_coder)\n#  Take global, annual average \ncoslat = np.cos(np.deg2rad(ncep_air.lat))\nweight = coslat / coslat.mean(dim='lat')\nTglobal = (ncep_air.air * weight).mean(dim=('lat','lon','time'))\n#  Resuable function to plot the temperature data on a Skew-T chart\ndef make_skewT():\n    fig = plt.figure(figsize=(9, 9))\n    skew = SkewT(fig, rotation=30)\n    skew.plot(Tglobal.level, Tglobal, color='black', linestyle='-', linewidth=2, label='Observations')\n    skew.ax.set_ylim(1050, 10)\n    skew.ax.set_xlim(-90, 45)\n    # Add the relevant special lines\n    skew.plot_dry_adiabats(linewidth=0.5)\n    skew.plot_moist_adiabats(linewidth=0.5)\n    #skew.plot_mixing_lines()\n    skew.ax.legend()\n    skew.ax.set_xlabel('Temperature (degC)', fontsize=14)\n    skew.ax.set_ylabel('Pressure (hPa)', fontsize=14)\n    return skew\n#  and a function to add extra profiles to this chart\ndef add_profile(skew, model, linestyle='-', color=None):\n    line = skew.plot(model.lev, model.Tatm - climlab.constants.tempCtoK,\n             label=model.name, linewidth=2)[0]\n    skew.plot(1000, model.Ts - climlab.constants.tempCtoK, 'o', \n              markersize=8, color=line.get_color())\n    skew.ax.legend()\n\n# Get the water vapor data from CESM output\ncesm_data_path = \"http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/\"\natm_control = xr.open_dataset(cesm_data_path + \"cpl_1850_f19/concatenated/cpl_1850_f19.cam.h0.nc\")\n# Take global, annual average of the specific humidity\nweight_factor = atm_control.gw / atm_control.gw.mean(dim='lat')\nQglobal = (atm_control.Q * weight_factor).mean(dim=('lat','lon','time'))\n#  Create the single-column model domain\nimport climlab\n#  Make a model on same vertical domain as the GCM\nmystate = climlab.column_state(lev=Qglobal.lev, water_depth=2.5)\n#  Create the model itself -- radiation only!\nrad = climlab.radiation.RRTMG(name='Radiation (all gases)',  # give our model a name!\n                              state=mystate,   # give our model an initial condition!\n                              specific_humidity=Qglobal.values,  # tell the model how much water vapor there is\n                              albedo = 0.25,  # this the SURFACE shortwave albedo\n                              timestep = climlab.constants.seconds_per_day,  # set the timestep to one day (measured in seconds)\n                             )\n\n#  remove ozone\nrad_noO3 = climlab.process_like(rad)\nrad_noO3.absorber_vmr['O3'] *= 0.\nrad_noO3.name = 'no O3'\n#  remove water vapor\nrad_noH2O = climlab.process_like(rad)\nrad_noH2O.specific_humidity *= 0.\nrad_noH2O.name = 'no H2O'\n#  remove both\nrad_noO3_noH2O = climlab.process_like(rad_noO3)\nrad_noO3_noH2O.specific_humidity *= 0.\nrad_noO3_noH2O.name = 'no O3, no H2O'\n#  put all models together in a list\nrad_models = [rad, rad_noO3, rad_noH2O, rad_noO3_noH2O]\n\n#  Loop through the models and integrate each one out to equilibrium\nfor model in rad_models:\n    for n in range(100):\n        model.step_forward()\n    while (np.abs(model.ASR-model.OLR)>0.01):\n        model.step_forward()\n        \n# Plot all the results\nskew = make_skewT()\nfor model in rad_models:\n    add_profile(skew, model)\nskew.ax.set_title('Pure radiative equilibrium', fontsize=18);","visibility":"show","key":"h5kYiOxgW7"},{"type":"output","id":"BrJOFJzx_5N1I1k4esodM","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3e44dbc7f4a15a00f12a5fe534862f24","path":"/ClimateLaboratoryBook/build/3e44dbc7f4a15a00f12a5fe534862f24.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"k7fUhZE2pv"}],"visibility":"show","key":"s25NU4MGD9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As we have already discussed, none of these profiles really looks anything like the observations in the troposphere. This strongly suggests that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g9Xf7q6wJ5"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"other physical processes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LYMo5ReaY2"}],"key":"GklJwT17jr"},{"type":"text","value":" (aside from radiation) are important in determining the observed temperature profile.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xnkzTgQgnj"}],"key":"JE2qItSMI7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Plotting on the skew-T diagram makes it clear that ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZYVfXCbwip"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"all the radiative equilibrium profiles are statically unstable near the surface","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uCAr7QqHIa"}],"key":"ptoKrImn7S"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pw6tv0rWY0"}],"key":"DI8KBJ8Prx"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"So we’re now going to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xllXM5KGjE"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"add a representation of the effects of convective mixing","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jdQ35z6N7g"}],"key":"Lpl46VG29d"},{"type":"text","value":" to the single-column model.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NfQ8HzH9IF"}],"key":"CGFIN3j5P1"}],"key":"USFF9KhsMK"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GmffJulxNH"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"2. Building a radiative-convection model in climlab","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"azQZxz3USe"}],"identifier":"id-2-building-a-radiative-convection-model-in-climlab","label":"2. Building a radiative-convection model in climlab","html_id":"id-2-building-a-radiative-convection-model-in-climlab","implicit":true,"key":"C4n5YMRO4R"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bydGNMD5UN"}],"key":"B4Pd9MYFsn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To make a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"al4YzS38M3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Radiative-Convective model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UlqTLItHdb"}],"key":"xXqBAY55iz"},{"type":"text","value":", we just take a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KeyUUuCwfF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"radiation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nO2LQIx7mW"}],"key":"cYiFhjsojX"},{"type":"text","value":" model and couple it to a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bt7ncd8dbC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"convection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"taKRnpmKk9"}],"key":"pz321cfx6x"},{"type":"text","value":" model!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pDMKfMwmAI"}],"key":"oxEDfHIq3z"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The “convection” model we’re going to use here is available as","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Btx9CWJqPZ"}],"key":"nbB0p2Fsw3"},{"type":"code","lang":"","value":"climlab.convection.ConvectiveAdjustment","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"key":"t4ZvPFSUvu"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"It is a simple process that looks for ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Zv1vROWgrn"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"lapse rates exceeding a critical threshold","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rX2rplqCOH"}],"key":"oAEMhTV1Gm"},{"type":"text","value":" and performs an ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"b7398bXke9"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"instantaneous adjustment","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ubCwlVwFww"}],"key":"k55GkdEMsW"},{"type":"text","value":" that mixes temperatures to the critical lapse rate while conserving energy.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JDr6laYgdq"}],"key":"OJbqFXgDvB"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"This is a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ijEJ7DBphP"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"parameterization","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"cvzgQmHVZ7"}],"key":"X4ZEcOc6VH"},{"type":"text","value":" of the complex, rapid mixing processes that actually occur in an unstable air column!","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kOcD77kYoI"}],"key":"jfBFOTOXLA"}],"key":"JoQTV7g93j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is some code to put this model together in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z24Un5VbFZ"},{"type":"inlineCode","value":"climlab","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ww3TMsMQDs"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ge8Rhnv4kY"}],"key":"GtqoEmpnvI"}],"key":"j2yT0h4UwI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Make a model on same vertical domain as the GCM\nmystate = climlab.column_state(lev=Qglobal.lev, water_depth=2.5)\n#  Build the radiation model -- just like we already did\nrad = climlab.radiation.RRTMG(name='Radiation (net)',\n                              state=mystate, \n                              specific_humidity=Qglobal.values,\n                              timestep = climlab.constants.seconds_per_day,\n                              albedo = 0.25,  # surface albedo, tuned to give reasonable ASR for reference cloud-free model\n                             )\n#  Now create the convection model\nconv = climlab.convection.ConvectiveAdjustment(name='Convection',\n                                               state=mystate,\n                                               adj_lapse_rate=6.5, # this is the key parameter! We'll discuss below\n                                               timestep=rad.timestep,  # same timestep!\n                                              )\n#  Here is where we build the model by coupling together the two components\nrcm = climlab.couple([rad, conv], name='Radiative-Convective Model')","key":"wvpnYmZFxF"},{"type":"output","id":"NXVcnKyV17x_yuz9fZD95","data":[],"key":"StOuRYiwBT"}],"key":"c271rDBxqq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rcm","key":"wf9evIoSJX"},{"type":"output","id":"isDvZn69D99I6JaiG6NwH","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<climlab.process.time_dependent_process.TimeDependentProcess at 0x17729b770>","content_type":"text/plain"}}}],"key":"pWqCo2QYHM"}],"key":"fLvBuRaoFC"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YzRJBU80DL"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"3. Adjustment toward radiative-convective equilibrium","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dIVkJmYTDG"}],"identifier":"id-3-adjustment-toward-radiative-convective-equilibrium","label":"3. Adjustment toward radiative-convective equilibrium","html_id":"id-3-adjustment-toward-radiative-convective-equilibrium","implicit":true,"key":"E0niObzPeE"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RC2xJRi3hy"}],"key":"yZ28vOtRZO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adjustment from isothermal initial conditions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s1RxiZLY47"}],"identifier":"adjustment-from-isothermal-initial-conditions","label":"Adjustment from isothermal initial conditions","html_id":"adjustment-from-isothermal-initial-conditions","implicit":true,"key":"Gft6LyifvU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To get some insight into the interaction between radiation and convection, it’s useful to look at the adjustment process from a non-equilibrium initial condition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QF0igyNcYI"}],"key":"BAydiW6y4I"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Let’s make an animation!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qZ3dXwmy72"}],"key":"mOocnOPg36"}],"key":"qlTsxR0XYO"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The code below is complicated but it is mostly for generating the animation. Focus on the results, not the code here.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kaNR6YFFj2"}],"key":"rylr8NLJW7"}],"key":"oiiL4y5pCU"}],"key":"HGQDmB9pDm"},{"type":"block","kind":"notebook-code","data":{"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"#  Some imports needed to make and display animations\nfrom IPython.display import HTML\nfrom matplotlib import animation\n\ndef get_tendencies(model):\n    '''Pack all the subprocess tendencies into xarray.Datasets\n    and convert to units of K / day'''\n    tendencies_atm = xr.Dataset()\n    tendencies_sfc = xr.Dataset()\n    for name, proc, top_proc in climlab.utils.walk.walk_processes(model, topname='Total', topdown=False):\n        tendencies_atm[name] = proc.tendencies['Tatm'].to_xarray()\n        tendencies_sfc[name] = proc.tendencies['Ts'].to_xarray()\n    for tend in [tendencies_atm, tendencies_sfc]:\n        #  convert to K / day\n        tend *= climlab.constants.seconds_per_day\n    return tendencies_atm, tendencies_sfc\n\ndef initial_figure(model):\n    fig = plt.figure(figsize=(14,6))\n    lines = []\n    \n    skew = SkewT(fig, subplot=(1,2,1), rotation=30)\n    #  plot the observations\n    skew.plot(Tglobal.level, Tglobal, color='black', linestyle='-', linewidth=2, label='Observations')    \n    lines.append(skew.plot(model.lev, model.Tatm - climlab.constants.tempCtoK, \n              linestyle='-', linewidth=2, color='C0', label='RC model (all gases)')[0])\n    skew.ax.legend()\n    skew.ax.set_ylim(1050, 10)\n    skew.ax.set_xlim(-60, 75)\n    # Add the relevant special lines\n    skew.plot_dry_adiabats(linewidth=0.5)\n    skew.plot_moist_adiabats(linewidth=0.5)\n    skew.ax.set_xlabel('Temperature (°C)', fontsize=14)\n    skew.ax.set_ylabel('Pressure (hPa)', fontsize=14)\n    lines.append(skew.plot(1000, model.Ts - climlab.constants.tempCtoK, 'o', \n                  markersize=8, color='C0', )[0])\n\n    ax = fig.add_subplot(1,2,2, sharey=skew.ax)\n    ax.set_ylim(1050, 10)\n    ax.set_xlim(-8,8)\n    ax.grid()\n    ax.set_xlabel(r'Temperature tendency (°C day$^{-1}$)', fontsize=14)\n\n    color_cycle=['g','b','r','y','k']\n    #color_cycle=['y', 'r', 'b', 'g', 'k']\n    tendencies_atm, tendencies_sfc = get_tendencies(rcm)\n    for i, name in enumerate(tendencies_atm.data_vars):\n        lines.append(ax.plot(tendencies_atm[name], model.lev, label=name, color=color_cycle[i])[0])\n    for i, name in enumerate(tendencies_sfc.data_vars):\n        lines.append(ax.plot(tendencies_sfc[name], 1000, 'o', markersize=8, color=color_cycle[i])[0])\n    ax.legend(loc='center right');\n    lines.append(skew.ax.text(-100, 50, 'Day {}'.format(int(model.time['days_elapsed'])), fontsize=12)) \n    return fig, lines\n\ndef animate(day, model, lines):\n    lines[0].set_xdata(np.array(model.Tatm)-climlab.constants.tempCtoK)\n    lines[1].set_xdata(np.array(model.Ts)-climlab.constants.tempCtoK)\n    #lines[2].set_xdata(np.array(model.q)*1E3)\n    tendencies_atm, tendencies_sfc = get_tendencies(model)\n    for i, name in enumerate(tendencies_atm.data_vars):\n        lines[2+i].set_xdata(tendencies_atm[name])\n    for i, name in enumerate(tendencies_sfc.data_vars):\n        lines[2+5+i].set_xdata(tendencies_sfc[name])\n    lines[-1].set_text('Day {}'.format(int(model.time['days_elapsed'])))\n    # This is kind of a hack, but without it the initial frame doesn't appear\n    if day != 0:\n        model.step_forward()\n    return lines","visibility":"show","key":"OPUiaMkHRt"},{"type":"output","id":"8I3s6yqt5jHqNtpUNxRxG","data":[],"visibility":"show","key":"azsXe8TDp5"}],"visibility":"show","key":"u0OYF39oTM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We are going to start from an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O6UtkdF5zK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"isothermal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AsCo0cqpTP"}],"key":"PXQk5nJb2C"},{"type":"text","value":" initial state, and let the model drift toward equilibrium.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iVzBerOFpB"}],"key":"lyqj7hZvRR"}],"key":"dZEGyHT5zO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Start from isothermal state\nrcm.state.Tatm[:] = rcm.state.Ts\n#  Call the diagnostics once for initial plotting\nrcm.compute_diagnostics()\n#  Plot initial data\nfig, lines = initial_figure(rcm)","key":"gp252k3lOS"},{"type":"output","id":"oH-kfYBHbw4ecn4oTFJYR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5a2a1428d4a6f6e7e10b99bdc796505e","path":"/ClimateLaboratoryBook/build/5a2a1428d4a6f6e7e10b99bdc796505e.png"},"text/plain":{"content":"<Figure size 1400x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"T2a5Ulopq2"}],"key":"C5gu8tcg5k"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice several things here:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w9VzLRle65"}],"key":"HgiKpHJYrW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The initial profile is isothermal at 15ºC. This is an arbitrary choice we made.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O82oaClQy5"}],"key":"dytOuWaxUh"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The initial tendency from ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eAhnxYxZXI"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"convection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nbcs3BGOf2"}],"key":"h03oSMKcxu"},{"type":"text","value":" is zero everywhere. Why?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X3h6MX73hV"}],"key":"Gqbtn0EZrx"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Shortwave radiation tends to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BLXBsNADL8"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"warm everywhere","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LufvIrASis"}],"key":"deLYlcMv7P"},{"type":"text","value":". Why?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fIuJFYZsX5"}],"key":"TtLnSKZTIq"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Longwave radiation tends to ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G5K8S4dJoY"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"cool everywhere","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GEQmlvDDL2"}],"key":"PQP7odQUxy"},{"type":"text","value":". The cooling is very strong especially aloft. Why?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xXZaOGxplQ"}],"key":"mpHuKaZpIw"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The total tendency (black) is warming at the surface and cooling in the atmosphere. What should happen next? What are the implications for convective instability?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PBTYJTUER2"}],"key":"GlQF5V6C6Z"}],"key":"akb55ttCb4"}],"key":"qGRUElW4ld"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s look at how the model actually adjusts:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CsKa5zLhbK"}],"key":"cWTV1ABC9A"}],"key":"bvX33Q04Ow"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  This is where we make a loop over many timesteps and create an animation in the notebook\nani = animation.FuncAnimation(fig, animate, 150, fargs=(rcm, lines))\nHTML(ani.to_html5_video())","key":"Vz3F2FjmtM"},{"type":"output","id":"M4lVCT8pJjyy3Z91UJGos","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"679a9500f18ef3d5de24d4b9d885af33","path":"/ClimateLaboratoryBook/build/679a9500f18ef3d5de24d4b9d885af33.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"TM6vwv5PDK"}],"key":"iFta2ZgLJD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Discuss.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eSNuGrp6Cp"}],"key":"o2AYNl1qLL"}],"key":"TeKmGQpSHe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What if instead we start out from pure Radiative equilibrium?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zGKQLUjw3R"}],"identifier":"what-if-instead-we-start-out-from-pure-radiative-equilibrium","label":"What if instead we start out from pure Radiative equilibrium?","html_id":"what-if-instead-we-start-out-from-pure-radiative-equilibrium","implicit":true,"key":"JbBxJKEuxd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This will represent the effect of a sudden “switching on” of convective processes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R2k9oxL2Sj"}],"key":"ABnDSCqETT"}],"key":"JMZd7MMRVo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Here we take JUST THE RADIATION COMPONENT of the full model and run it out to (near) equilibrium\n#  This is just to get the initial condition for our animation\nfor n in range(1000):\n    rcm.subprocess['Radiation (net)'].step_forward()","key":"UwqmYH8aK2"},{"type":"output","id":"SMDwlNFnMhZkjQ2uKJXx0","data":[],"key":"G3CkEOPY6b"}],"key":"Cp58nDWvRP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Call the diagnostics once for initial plotting\nrcm.compute_diagnostics()\n#  Plot initial data\nfig, lines = initial_figure(rcm)","key":"XaShPhoYrQ"},{"type":"output","id":"svCgNX5e75N6pO0oHYFPN","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3b55aae86b658599fe2ec8660928f3df","path":"/ClimateLaboratoryBook/build/3b55aae86b658599fe2ec8660928f3df.png"},"text/plain":{"content":"<Figure size 1400x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"FBiRXnhzSg"}],"key":"XfumZqn5dn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  This is where we make a loop over many timesteps and create an animation in the notebook\nani = animation.FuncAnimation(fig, animate, 100, fargs=(rcm, lines))\nHTML(ani.to_html5_video())","key":"cXWaaJdJGN"},{"type":"output","id":"69qe4FByvw6bQeINXsjKj","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"bf070765b416a2eb82276bbe21864ace","path":"/ClimateLaboratoryBook/build/bf070765b416a2eb82276bbe21864ace.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}}],"key":"uwV7lqLA3m"}],"key":"wZpWb6A029"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This animation is not as exciting because the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZZvDwc3Kff"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"instability is destroyed immediately","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TSgpFVEcGN"}],"key":"oFTEPXNhSr"},{"type":"text","value":" in the first timestep!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gkKZLbe3tG"}],"key":"XlgZYgncKf"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"That is because the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"peTh0XL5yb"},{"type":"inlineCode","value":"ConvectiveAdjustment","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vbd2ZUrk5J"},{"type":"text","value":" process operates instantaneously whenever there is any instability. It is a parameterization taking advantage of the fact that, in nature, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y1yIrnsXuX"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"convection processes are fast compared to radiative processes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zHOvpQ7bB4"}],"key":"Ixuk7LOKH0"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zy2iVnrlxr"}],"key":"yXOMwJ9PP9"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"But notice that the final state is pretty much the same as in the first animation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E96Tjofvmb"}],"key":"AmKMwBfAXP"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The column tends toward the same equilibrium state regardless of where it starts.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HdKMssVaCh"}],"key":"jVECw9zkWw"}],"key":"gtSgz6OPrL"}],"key":"NDoZczfivX"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KOIUY9KFzs"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"4. Compare Radiative- and Radiative-Convective Equilibrium","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uyFzMux3e2"}],"identifier":"id-4-compare-radiative-and-radiative-convective-equilibrium","label":"4. Compare Radiative- and Radiative-Convective Equilibrium","html_id":"id-4-compare-radiative-and-radiative-convective-equilibrium","implicit":true,"key":"VewsfEkX5V"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Sizl4l9YAG"}],"key":"qJN6TreeKL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s repeat our experiment with removing certain absorbing gases from the model, but use the Radiative-Convective model.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IOewjILBKh"}],"key":"PkUGPa3JP7"}],"key":"hqjB93OzSs"},{"type":"block","kind":"notebook-code","data":{"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"#  Make a model on same vertical domain as the GCM\nmystate = climlab.column_state(lev=Qglobal.lev, water_depth=2.5)\n\nrad = climlab.radiation.RRTMG(name='all gases',\n                              state=mystate, \n                              specific_humidity=Qglobal.values,\n                              timestep = climlab.constants.seconds_per_day,\n                              albedo = 0.25,  # tuned to give reasonable ASR for reference cloud-free model\n                             )\n#  remove ozone\nrad_noO3 = climlab.process_like(rad)\nrad_noO3.absorber_vmr['O3'] *= 0.\nrad_noO3.name = 'no O3'\n#  remove water vapor\nrad_noH2O = climlab.process_like(rad)\nrad_noH2O.specific_humidity *= 0.\nrad_noH2O.name = 'no H2O'\n#  remove both\nrad_noO3_noH2O = climlab.process_like(rad_noO3)\nrad_noO3_noH2O.specific_humidity *= 0.\nrad_noO3_noH2O.name = 'no O3, no H2O'\n#  put all models together in a list\nrad_models = [rad, rad_noO3, rad_noH2O, rad_noO3_noH2O]\n\nrc_models = []\nfor r in rad_models:\n    newrad = climlab.process_like(r)\n    conv = climlab.convection.ConvectiveAdjustment(name='Convective Adjustment',\n                                               state=newrad.state,\n                                               adj_lapse_rate=6.5,  # the key parameter in the convection model!\n                                               timestep=newrad.timestep,)\n    rc = newrad + conv\n    rc.name = newrad.name\n    rc_models.append(rc)\n\nfor model in rad_models:\n    for n in range(100):\n        model.step_forward()\n    while (np.abs(model.ASR-model.OLR)>0.01):\n        model.step_forward()    \n    \nfor model in rc_models:\n    for n in range(100):\n        model.step_forward()\n    while (np.abs(model.ASR-model.OLR)>0.01):\n        model.step_forward()","visibility":"show","key":"Dtzt21vZvb"},{"type":"output","id":"Rmt6DSLDp1RyuhVg4cXne","data":[],"visibility":"show","key":"wT8RwUjG6L"}],"visibility":"show","key":"AGM5ep9mt4"},{"type":"block","kind":"notebook-code","data":{"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"skew = make_skewT()\nfor model in rad_models:\n    add_profile(skew, model)\nskew.ax.set_title('Pure radiative equilibrium', fontsize=18);","visibility":"show","key":"gLx8jWJKCl"},{"type":"output","id":"x5_TIMMpS5---yLO5MqFu","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2eeee5a8927c4a96f3b0eb0dd9c7d088","path":"/ClimateLaboratoryBook/build/2eeee5a8927c4a96f3b0eb0dd9c7d088.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"X9vKYmK2fA"}],"visibility":"show","key":"jEakhm1M9I"},{"type":"block","kind":"notebook-code","data":{"tags":["hide_input"]},"children":[{"type":"code","lang":"python","executable":true,"value":"skew2 = make_skewT()\nfor model in rc_models:\n    add_profile(skew2, model)\nskew2.ax.set_title('Radiative-convective equilibrium', fontsize=18);","visibility":"show","key":"eOXf0bxFWW"},{"type":"output","id":"Nn80vMRgqeEKRHdA-uNI1","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8a1c05a0bb64e7fd502a5f74fddff88e","path":"/ClimateLaboratoryBook/build/8a1c05a0bb64e7fd502a5f74fddff88e.png"},"text/plain":{"content":"<Figure size 900x900 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"BKB0yDRtxF"}],"visibility":"show","key":"tsbAyXbwyj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lots to discuss here.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X6CLvqXiXo"}],"key":"NlI0dPE29A"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The overall message is that equilibrium temperature profile results from a competition between radiation and convection. Essentially:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fy5bJWDmph"}],"key":"jXe022AYRK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Radiation is always trying to push temperatures toward radiative equilibrium, which means","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ei2Td03GdP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"warm surface","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AScghInYgG"}],"key":"EmG8px6Nqs"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"cold troposphere","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qArC4pWzh0"}],"key":"GZBfueKOho"}],"key":"OZwvO49XSV"}],"key":"ogtCjmtI96"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Convection cools the surface and warms the troposphere","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kMZ2lwiKKQ"}],"key":"hbHVpqWgBN"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The troposphere can be defined here as the layer over which convection is active.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IA1QaW4R9m"}],"key":"xhGKWjHkjw"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This is true whether or not we have the radiative effects of water vapor.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MiccovdpXT"}],"key":"bImVtcD05n"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"When we remove the water vapor (and its warming greenhouse effect), the surface temperature becomes much colder and the troposphere is much shallower -- but it is still there.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UP6T7srvDL"}],"key":"QKmCBwYUhy"}],"key":"dbSKCgK621"}],"key":"Vp7cy7bD6S"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oDGKyjJSbN"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"5. The role of the critical lapse rate","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KgNfEVlDSA"}],"identifier":"id-5-the-role-of-the-critical-lapse-rate","label":"5. The role of the critical lapse rate","html_id":"id-5-the-role-of-the-critical-lapse-rate","implicit":true,"key":"uPtP57yDv0"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HQszhKOM3R"}],"key":"m9MhKuz5ew"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What have we done above","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SOGtZ8HGtq"}],"identifier":"what-have-we-done-above","label":"What have we done above","html_id":"what-have-we-done-above","implicit":true,"key":"qJlhz5BC5k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"These calcu","key":"zCvSdTR5Jx"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"CE1lEbRLRQ"}],"key":"Wo9ERB5QU3"},{"type":"text","value":"ions all used a critical lapse rate of 6.5 K / km, which is a reasonable approximation to observations.","key":"ggk0y9floe"}],"key":"lZ4pCBB6gV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We set this with the input argument","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Gv6sPdsdaq"}],"key":"UXWCgsWbtS"},{"type":"code","lang":"","value":"adj_lapse_rate","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"key":"X32onlPvKn"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"to the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Bx72tXE0yd"},{"type":"inlineCode","value":"ConvectiveAdjustment","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zvJj3M3v9k"},{"type":"text","value":" process.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"u9cnT9QFsv"}],"key":"nX8AJtu2NO"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The idea is that we are trying to represent the statistical effects of many episodes of moist convection.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"v9pJ5EBeF4"}],"key":"TDJM1mLNWx"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"An air column that is perfectly neutral to moist instability would follow the blue ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"o62bbWYemQ"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"moist adiabats","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ShkzmTo9Cu"}],"key":"iYK2ZxZi8i"},{"type":"text","value":" on the skew-T diagrams.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"L61XbTNJjf"}],"key":"XiCNt3aFCs"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"We can force the model to behave this way by setting","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"yZWTybWcCy"}],"key":"PbxfBsiD3A"},{"type":"code","lang":"","value":"adj_lapse_rate = 'pseudoadiabat'","position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"key":"CYsNl8RDQr"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"However the real atmosphere, on average, does not exactly follow these adiabats for several reasons:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"TrcGP6ahdA"}],"key":"Aiqw6VTjM6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"the slope of the moist adiabat depends strongly on temperature (as we can see on these diagrams)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"kslJ2bRBi1"}],"key":"vUpUBkvONc"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"We are looking at temperatures averaged over the whole planet, including regions that are warm and moist, warm and dry, and cold.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"N8gUq3VsCb"}],"key":"YHZQoqQm9b"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Heat fluxes by mid-","key":"MEom1AYWgz"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"Icm9ilvLRc"}],"key":"jwboui2s43"},{"type":"text","value":"itude eddies play an important role in ","key":"cwq5KtHo3g"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"stabilizing","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"RXBUllzpZ8"}],"key":"Wkw5onxhEY"},{"type":"text","value":" the extra-tropical atmosphere.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"kJDIYW7dcK"}],"key":"uHfcglkeQS"}],"key":"x5vK9Osjs8"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"So here we sweep all this complexity under the rug and just choose a single critical lapse rate for our convective adjustment model.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"mWYw5K4W2S"}],"key":"RPIxLGcSHK"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"But this is a ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"SVqBjBhLFF"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"parameter","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"bOfr1kTqpr"}],"key":"grjNOsfIKr"},{"type":"text","value":" that is uncertain and could be interesting to explore.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"vNd9Fo93qC"}],"key":"Wp90b6A1mq"}],"key":"JMkfc7U0Mp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Python exercise: change the critical lapse rate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sS7A63ViKT"}],"identifier":"python-exercise-change-the-critical-lapse-rate","label":"Python exercise: change the critical lapse rate","html_id":"python-exercise-change-the-critical-lapse-rate","implicit":true,"key":"teOEXyQOlr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Repeat the whole series of calcu","key":"vyhLjw7c9H"},{"type":"abbreviation","title":"latitude","children":[{"type":"text","value":"lat","key":"RpmNeRvkTx"}],"key":"NphHdhV1uh"},{"type":"text","value":"ions for the different combinations of absorbing gases above, but with different critical lapse rates:","key":"OFZ6NZkPtH"}],"key":"VzR8oVlisR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"adj_lapse_rate = 9.8","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xGBcVn3z1w"},{"type":"text","value":" (in K/km, the dry adiabatic lapse rate, suitable for an atmosphere where condensation does not impact the buoyancy of air parcels)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mtAz9lQIxj"}],"key":"AOT9gIfUFH"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineCode","value":"adj_lapse_rate = 'pseudoadiabat'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qWuktbDrXV"},{"type":"text","value":" (more suitable for the tropical atmosphere)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"o4HIWKyKrE"}],"key":"gYASwZcd4n"}],"key":"qA1zQ0HiVz"}],"key":"gs3WYt3cgv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"PwILSCJndt"},{"type":"output","id":"ZysOrLsA5TYP51y5nEVUh","data":[],"key":"Ii7xC4O2sv"}],"key":"P7zMEPTatF"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FDGJ1Cld7A"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"6. Summary of radiative-convection equilibrium results","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dooiKXXxsl"}],"identifier":"id-6-summary-of-radiative-convection-equilibrium-results","label":"6. Summary of radiative-convection equilibrium results","html_id":"id-6-summary-of-radiative-convection-equilibrium-results","implicit":true,"key":"Tvhzb5WlpO"},{"type":"thematicBreak","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"o4MJudj50Q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We noted that pure radiative equilibrium is ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kV5UP599NN"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"C3dvF2KP7p"}],"key":"WnxoKY6aNE"},{"type":"text","value":" a good model for the observed temperature profile.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XKK2GuTIpK"}],"key":"vwcgXRA1lK"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"An air column in radiative equilibrium has a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nHmu7UrTVu"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"warm surface","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZEX1X4rJKA"}],"key":"rPRbyZNhiZ"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kzVHQuD6V6"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"cold troposphere","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"irPJ5ylse8"}],"key":"YkkMqU4JyS"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nll0ok6boB"}],"key":"Xa5yzx3Q7G"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"In reality this would tend to become ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KiuKeFslAn"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"unstable","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zgEUsjAj5X"}],"key":"crcpTufap1"},{"type":"text","value":" and cause vertical mixing.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"INtp1e9brz"}],"key":"R0buyck8EP"}],"key":"fMuTOLpEMi"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"To account for this shortcoming of the radiation model, we coupled our single-column radiation model (using the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c4zqtuHkPe"},{"type":"inlineCode","value":"RRTMG","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zfesO7nSxZ"},{"type":"text","value":" radiation model) to a simple ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cAu3rpzwL9"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"convection","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XZEyR6zBH2"}],"key":"pAzgbybmxJ"},{"type":"text","value":" model.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kHiHT8qASM"}],"key":"JwoVt6uOKv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lPMhmq1ZIc"},{"type":"inlineCode","value":"ConvectiveAdjustment","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"n4ETWZ6Ck2"},{"type":"text","value":" model instantly mixes out any profiles where the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XE4wWG0vsl"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"lapse rate","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"babCjhHCkI"}],"key":"FARQxCOlwH"},{"type":"text","value":" exceeds some critical threshold value.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"C8EHw1Obji"}],"key":"gPJmAJJApN"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"This critical lapse rate is the tunable parameter in our combined ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dMDc5DDvP6"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Radiative-Convective Model","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Vq3PV5iAIq"}],"key":"vd2jxFZtGo"},{"type":"text","value":" or ","key":"BjK6pQFxRO"},{"type":"abbreviation","title":"Radiative-Convective Model","children":[{"type":"text","value":"RCM","key":"JMPlWBbE9p"}],"key":"EQdTWRzeJj"},{"type":"text","value":".","key":"EeqVahljHP"}],"key":"OhHNP9XYF1"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Using a value of 6.5 K / km and realistic gas profiles gives a reasonable (not perfect) fit to the observed air temperatures.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tzYm9ukM5Y"}],"key":"SOfixzwCXn"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fbJ2RWpGa8"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"abbreviation","title":"Radiative-Convective Model","children":[{"type":"text","value":"RCM","key":"D5fSRNYUcd"}],"key":"nV7pcCa4Iy"},{"type":"text","value":" represents the “tug-of-war”","key":"NvVc9FN1g0"}],"key":"kU1HX9qqL9"},{"type":"text","value":" between ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"FQN1ESMgsf"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"radiation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"A3tzUCfV3Z"}],"key":"laas9FtyJy"},{"type":"text","value":" (trying to warm the surface and cool the troposphere) and ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZUvubYFgTd"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"convection","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kTvUyWm4x6"}],"key":"meWzL6sQRU"},{"type":"text","value":" (cool the surface and warm the troposphere).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"G6rd3G4sck"}],"key":"m81AZ1EVFZ"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"The convectively mixed layer extends up to near the top of the troposphere.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Q3THwE8Obd"}],"key":"RppU28KAko"}],"key":"i5WpkwFmHK"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Our experiments with removing certain absorbing gases show something interesting: the height of the tropopause (boundary bewteen troposphere and stratosphere) changes when we remove absorbers. Warmer columns also appear to have higher tropopause.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"m8N9j1gFC4"}],"key":"vc3uKkLn6d"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Now that we know how to build and use this ","key":"LgD2uiIbWe"},{"type":"abbreviation","title":"Radiative-Convective Model","children":[{"type":"text","value":"RCM","key":"ajyeodqW6B"}],"key":"fHfcfQiZ2k"},{"type":"text","value":", we’ll be able to use to study some climate change processes in more detail.","key":"cgKTraJtr0"}],"key":"rkY6gpZPaM"}],"key":"LutZEbcxod"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jvWnBKO0zY"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hHMdxXKecO"}],"identifier":"credits","label":"Credits","html_id":"credits","implicit":true,"key":"hvTUBy7HfP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jHZEkbFEec"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rnEDcXQcEt"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"CQezh0fUCQ"},{"type":"text","value":", an open-source textbook developed and maintained by ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kQxyn8mpJg"},{"type":"link","url":"http://www.atmos.albany.edu/facstaff/brose/index.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QkAVa1Rrt6"}],"urlSource":"http://www.atmos.albany.edu/facstaff/brose/index.html","key":"u1GudaJg2h"},{"type":"text","value":", University at Albany.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tROIi5m0PD"}],"key":"UTGvGYDauj"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"It is licensed for free and open consumption under the\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GaITCRVJ29"},{"type":"link","url":"https://creativecommons.org/licenses/by/4.0/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Creative Commons Attribution 4.0 International (CC BY 4.0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QMB9NrS6MK"}],"urlSource":"https://creativecommons.org/licenses/by/4.0/","key":"M3AQwynmWw"},{"type":"text","value":" license.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YY7QGQ9nBj"}],"key":"bqFMOOVQ0j"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Development of these notes and the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"m7nj9er4qj"},{"type":"link","url":"https://github.com/climlab/climlab","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"climlab software","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"T4DIO8gv75"}],"urlSource":"https://github.com/climlab/climlab","error":true,"key":"zNzGWWH4OF"},{"type":"text","value":" is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Pp8WtLRh3e"}],"key":"xDfJIws4F2"},{"type":"thematicBreak","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zuGIByAimp"}],"key":"hFLKV7PUUB"}],"key":"BtqlbC9HnH"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Radiative Equilibrium","url":"/courseware/radeq","group":"The Climate Laboratory"},"next":{"title":"Climate sensitivity and feedback","url":"/courseware/sensitivity-feedback","group":"The Climate Laboratory"}}},"domain":"http://localhost:3000"}