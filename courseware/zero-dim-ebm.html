
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2. Modeling the global energy budget &#8212; The Climate Laboratory</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-43758959-2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-43758959-2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-43758959-2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'courseware/zero-dim-ebm';</script>
    <link rel="canonical" href="https://brian-rose.github.io/ClimateLaboratoryBook/courseware/zero-dim-ebm.html" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced topic: Analytical solution of the global Energy Balance Model" href="analytical-efolding.html" />
    <link rel="prev" title="1. Climate models, the global energy budget, and Fun with Python" href="models-budgets-fun.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
  
    <p class="title logo__title">The Climate Laboratory</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    The Climate Laboratory
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About this Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../who-for.html">Who is the book for?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to.html">How to use this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../attribution.html">How to cite and reuse this material</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="models-budgets-fun.html">1. Climate models, the global energy budget, and Fun with Python</a></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">2. Modeling the global energy budget</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="analytical-efolding.html">Advanced topic: Analytical solution of the global Energy Balance Model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="climate-system-models.html">3. The climate system and climate models</a></li>
<li class="toctree-l1"><a class="reference internal" href="introducing-cesm.html">4. Introducing the Community Earth System Model (CESM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="climlab-intro.html">5. Building simple climate models using climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiation.html">6. A Brief Review of Radiation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="elementary-greenhouse.html">7. Elementary greenhouse models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="sympy-greenhouse.html">Advanced topic: Solving the two-layer grey gas model analytically with sympy</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="grey-radiation-climlab.html">8. Grey radiation modeling with climlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="radiative-transfer.html">9. Modeling non-scattering radiative transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectral-bands.html">10. Who needs spectral bands? We do. Some baby steps…</a></li>
<li class="toctree-l1"><a class="reference internal" href="radeq.html">11. Radiative Equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="rce.html">12. Radiative-Convective Equilibrium</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sensitivity-feedback.html">13. Climate sensitivity and feedback</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-sensitivity-feedback.html">Advanced topic: Climate sensitivity and feedback</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="transient-cesm.html">14. Examing the transient and equilibrium CO2 response in the CESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="transient-toy.html">15. Toy models of transient warming</a></li>
<li class="toctree-l1"><a class="reference internal" href="clouds.html">16. Clouds and cloud feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="insolation.html">17. Insolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="orbital.html">18. Orbital variations, insolation, and the ice ages</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="heat-transport.html">19. Heat transport</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-heat-transport.html">Advanced topic: Heat transport decomposition</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="one-dim-ebm.html">20. The one-dimensional energy balance model</a></li>
<li class="toctree-l1"><a class="reference internal" href="seasonal-cycle.html">21. Modeling the seasonal cycle of surface temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical-diffusion.html">22. A peek at numerical methods for diffusion models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="albedo-snowball.html">23. Ice-albedo feedback and Snowball Earth in the EBM</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-albedo-feedback.html">Advanced topic: Ice albedo feedback in the EBM</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-snowball-earth.html">Advanced topic: Snowball Earth and Large Ice Cap Instability in the EBM</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="surface-energy-balance.html">24. The surface energy balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="land-ocean-contrast.html">25. Land-Ocean contrasts under climate change</a></li>
<li class="toctree-l1"><a class="reference internal" href="water-water-everywhere.html">26. Water, water everywhere!</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about-assignments.html">About the assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-zero-dim-ebm.html">Assignment: Climate change in the zero-dimensional EBM</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="assignment-cesm-control.html">Assignment: Global average budgets in the CESM pre-industrial control simulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="assignment-cesm-control-hints.html">Additional hints and guidance for CESM budgets assignment</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-simple-clouds.html">Assignment: Clouds in the Leaky Greenhouse Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-rcm-feedback.html">Assignment: Feedbacks in the Radiative-Convective Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-cesm-climate-change.html">Assignment: Climate change in the CESM simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-insolation-orbit.html">Assignment: Insolation and orbital parameters</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Postamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://binder.projectpythia.org/v2/gh/brian-rose/ClimateLaboratoryBook/main?urlpath=tree/courseware/zero-dim-ebm.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://lore.atmos.albany.edu:8000/hub/user-redirect/git-pull?repo=https%3A//github.com/brian-rose/ClimateLaboratoryBook&urlpath=tree/ClimateLaboratoryBook/courseware/zero-dim-ebm.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/courseware/zero-dim-ebm.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modeling the global energy budget</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-the-global-energy-budget">1. Recap of the global energy budget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-radiative-fluxes-to-the-observations">2. Tuning radiative fluxes to the observations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-our-simple-greenhouse-model">Recap of our simple greenhouse model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-shortwave-radiation-asr-and-planetary-albedo">Absorbed Shortwave Radiation (ASR) and Planetary Albedo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-mean-insolation">Global mean insolation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#planetary-albedo">Planetary albedo</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-shortwave-radiation">Absorbed Shortwave Radiation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-temperature">3. Equilibrium temperature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-climate-change-scenario">4. A climate change scenario</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-exercise">Python exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-time-dependent-energy-balance-model">5. A time-dependent Energy Balance Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-energy-balance-equation">An energy balance <strong>equation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-energy-balance-model">An energy balance <strong>model</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-energy-balance-model">Solving the energy balance model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representing-time-derivatives-on-a-computer">6. Representing time derivatives on a computer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-of-the-energy-balance-model">7. Numerical solution of the Energy Balance Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#try-stepping-forward-one-timestep">Try stepping forward one timestep</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-10-functions-can-access-variables-and-other-functions-defined-outside-of-the-function">Python fact 10: Functions can access variables and other functions defined outside of the function.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automate-the-timestepping-with-a-loop">Automate the timestepping with a loop</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-11-the-for-statement-executes-a-statement-or-series-of-statements-a-specified-number-of-times-a-loop">Python fact 11: the <code class="docutils literal notranslate"><span class="pre">for</span></code> statement executes a statement (or series of statements) a specified number of times (a loop!)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-12-use-square-bracket-to-refer-to-elements-of-an-array-or-list-use-round-parentheses-for-function-arguments">Python fact 12: Use square bracket [ ] to refer to elements of an array or list. Use round parentheses ( ) for function arguments.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-result">Plotting the result</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-13-we-can-easily-make-simple-graphs-with-the-function-plt-plot-x-y-where-x-and-y-are-arrays-of-the-same-size-but-we-must-import-it-first">Python fact 13: We can easily make simple graphs with the function <code class="docutils literal notranslate"><span class="pre">plt.plot(x,y)</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of the same size. But we must import it first.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-take-away-messages">8. Summary and take-away messages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modeling-the-global-energy-budget">
<h1><span class="section-number">2. </span>Modeling the global energy budget<a class="headerlink" href="#modeling-the-global-energy-budget" title="Link to this heading">#</a></h1>
<p><strong>Introducing the zero-dimensional Energy Balance Model</strong></p>
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a> by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<hr class="docutils" />
<section id="recap-of-the-global-energy-budget">
<h2>1. Recap of the global energy budget<a class="headerlink" href="#recap-of-the-global-energy-budget" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Let’s look again at the observations <span id="id1">[<a class="reference internal" href="../references.html#id29" title="Kevin E. Trenberth and John T. Fasullo. Tracking earth's energy: from el niño to global warming. Surv. Geophys., 33:413–426, 2012. doi:10.1007/s10712-011-9150-2.">Trenberth and Fasullo, 2012</a>]</span>:</p>
<p><img alt="Observed global energy flows from Trenberth and Fasullo (2012)" src="../_images/GlobalEnergyBudget.png" /></p>
</section>
<hr class="docutils" />
<section id="tuning-radiative-fluxes-to-the-observations">
<h2>2. Tuning radiative fluxes to the observations<a class="headerlink" href="#tuning-radiative-fluxes-to-the-observations" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<section id="recap-of-our-simple-greenhouse-model">
<h3>Recap of our simple greenhouse model<a class="headerlink" href="#recap-of-our-simple-greenhouse-model" title="Link to this heading">#</a></h3>
<p>Last class we introduced a very simple model for the <strong>OLR</strong> or Outgoing Longwave Radiation to space:</p>
<div class="math notranslate nohighlight">
\[ \text{OLR} = \tau \sigma T_s^4 \]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the <strong>transmissivity</strong> of the atmosphere, a number less than 1 that represents the greenhouse effect of Earth’s atmosphere.</p>
<p>We also tuned this model to the observations by choosing <span class="math notranslate nohighlight">\( \tau \approx 0.61\)</span>.</p>
<p>More precisely:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OLRobserved</span> <span class="o">=</span> <span class="mf">238.5</span>  <span class="c1"># in W/m2</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.67E-8</span>  <span class="c1"># S-B constant</span>
<span class="n">Tsobserved</span> <span class="o">=</span> <span class="mf">288.</span>  <span class="c1"># global average surface temperature</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">OLRobserved</span> <span class="o">/</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">Tsobserved</span><span class="o">**</span><span class="mi">4</span>  <span class="c1"># solve for tuned value of transmissivity</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6114139923687016
</pre></div>
</div>
</div>
</div>
<p>Let’s now deal with the shortwave (solar) side of the energy budget.</p>
</section>
<section id="absorbed-shortwave-radiation-asr-and-planetary-albedo">
<h3>Absorbed Shortwave Radiation (ASR) and Planetary Albedo<a class="headerlink" href="#absorbed-shortwave-radiation-asr-and-planetary-albedo" title="Link to this heading">#</a></h3>
<p>Let’s define a few terms.</p>
<section id="global-mean-insolation">
<h4>Global mean insolation<a class="headerlink" href="#global-mean-insolation" title="Link to this heading">#</a></h4>
<p>From the observations, the area-averaged incoming solar radiation or <strong>insolation</strong> is 341.3 W m<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
<p>Let’s denote this quantity by <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="mf">341.3</span>  <span class="c1"># the insolation</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="planetary-albedo">
<h4>Planetary albedo<a class="headerlink" href="#planetary-albedo" title="Link to this heading">#</a></h4>
<p>Some of the incoming radiation is not absorbed at all but simply reflected back to space. Let’s call this quantity <span class="math notranslate nohighlight">\(F_{reflected}\)</span></p>
<p>From observations we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Freflected</span> <span class="o">=</span> <span class="mf">101.9</span>  <span class="c1">#  reflected shortwave flux in W/m2</span>
</pre></div>
</div>
</div>
</div>
<p>The <strong>planetary albedo</strong> is the fraction of <span class="math notranslate nohighlight">\(Q\)</span> that is reflected.</p>
<p>We will denote the planetary albedo by <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>From the observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">Freflected</span> <span class="o">/</span> <span class="n">Q</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.29856431292118374
</pre></div>
</div>
</div>
</div>
<p>That is, about 30% of the incoming radiation is reflected back to space.</p>
</section>
<section id="absorbed-shortwave-radiation">
<h4>Absorbed Shortwave Radiation<a class="headerlink" href="#absorbed-shortwave-radiation" title="Link to this heading">#</a></h4>
<p>The <strong>Absorbed Shortwave Radiation</strong> or ASR is the part of the incoming sunlight that is <em>not</em> reflected back to space, i.e. that part that is absorbed somewhere within the Earth system.</p>
<p>Mathematically we write</p>
<div class="math notranslate nohighlight">
\[ \text{ASR} = Q - F_{reflected} = (1-\alpha) Q \]</div>
<p>From the observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ASRobserved</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">-</span> <span class="n">Freflected</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ASRobserved</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>239.4
</pre></div>
</div>
</div>
</div>
<p>As we noted last time, this number is <em>just slightly greater</em> than the observed OLR of 238.5 W m<span class="math notranslate nohighlight">\(^{-2}\)</span>.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="equilibrium-temperature">
<h2>3. Equilibrium temperature<a class="headerlink" href="#equilibrium-temperature" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p><em>This is one of the central concepts in climate modeling.</em></p>
<p>The Earth system is in <strong>energy balance</strong> when energy in = energy out, i.e. when</p>
<div class="math notranslate nohighlight">
\[ \text{ASR} = \text{OLR} \]</div>
<p>We want to know:</p>
<ul class="simple">
<li><p>What surface temperature do we need to have this balance?</p></li>
<li><p>By how much would the temperature change in response to other changes in Earth system?</p>
<ul>
<li><p>Changes in greenhouse gases</p></li>
<li><p>Changes in cloudiness</p></li>
<li><p>etc.</p></li>
</ul>
</li>
</ul>
<p>With our simple greenhouse model, we can get an <strong>exact solution</strong> for the equilibrium temperature.</p>
<p>First, write down our statement of energy balance:</p>
<div class="math notranslate nohighlight">
\[ (1-\alpha) Q = \tau \sigma T_s^4 \]</div>
<p>Rearrange to solve for <span class="math notranslate nohighlight">\(T_s\)</span>:</p>
<div class="math notranslate nohighlight">
\[ T_s^4 = \frac{(1-\alpha) Q}{\tau \sigma} \]</div>
<p>and take the fourth root, denoting our <strong>equilibrium temperature</strong> as <span class="math notranslate nohighlight">\(T_{eq}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ T_{eq} = \left( \frac{(1-\alpha) Q}{\tau \sigma} \right)^\frac{1}{4} \]</div>
<p>Plugging the observed values back in, we compute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  define a reusable function!</span>
<span class="k">def</span><span class="w"> </span><span class="nf">equilibrium_temperature</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">tau</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">Q</span><span class="o">/</span><span class="p">(</span><span class="n">tau</span><span class="o">*</span><span class="n">sigma</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="n">Teq_observed</span> <span class="o">=</span> <span class="n">equilibrium_temperature</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">tau</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Teq_observed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>288.27131447889224
</pre></div>
</div>
</div>
</div>
<p>And this equilibrium temperature is <em>just slightly warmer</em> than 288 K.  Why?</p>
</section>
<hr class="docutils" />
<section id="a-climate-change-scenario">
<h2>4. A climate change scenario<a class="headerlink" href="#a-climate-change-scenario" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Suppose that, due to global warming (changes in atmospheric composition and subsequent changes in cloudiness):</p>
<ul class="simple">
<li><p>The longwave transmissitivity decreases to <span class="math notranslate nohighlight">\(\tau = 0.57\)</span></p></li>
<li><p>The planetary albedo increases to <span class="math notranslate nohighlight">\(\alpha = 0.32\)</span></p></li>
</ul>
<p>What is the <em><strong>new equilibrium temperature</strong></em>?</p>
<p>For this very simple model, we can work out the answer exactly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Teq_new</span> <span class="o">=</span> <span class="n">equilibrium_temperature</span><span class="p">(</span><span class="mf">0.32</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="mf">0.57</span><span class="p">)</span>
<span class="c1">#  an example of formatted print output, limiting to two or one decimal places</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The new equilibrium temperature is </span><span class="si">{:.2f}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Teq_new</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The equilibrium temperature increased by about </span><span class="si">{:.1f}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Teq_new</span><span class="o">-</span><span class="n">Teq_observed</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The new equilibrium temperature is 291.10 K.
The equilibrium temperature increased by about 2.8 K.
</pre></div>
</div>
</div>
</div>
<p>Most climate models are more complicated mathematically, and solving directly for the equilibrium temperature will not be possible!</p>
<p>Instead, we will be able to use the model to calculate the terms in the energy budget (ASR and OLR).</p>
<section id="python-exercise">
<h3>Python exercise<a class="headerlink" href="#python-exercise" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Write Python functions to calculate ASR and OLR for <em>arbitrary parameter values</em>.</p></li>
<li><p>Verify the following:</p>
<ul>
<li><p>With the new parameter values but the old temperature <span class="math notranslate nohighlight">\(T = 288\)</span> K, is ASR greater or lesser than OLR?</p></li>
<li><p>Is the Earth gaining or losing energy?</p></li>
<li><p>How does your answer change if <span class="math notranslate nohighlight">\(T = 295\)</span> K (or any other temperature greater than 291 K)?</p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="a-time-dependent-energy-balance-model">
<h2>5. A time-dependent Energy Balance Model<a class="headerlink" href="#a-time-dependent-energy-balance-model" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The above exercise shows us that if some properties of the climate system change in such a way that the <strong>equilibrium temperature goes up</strong>, then the Earth system <em>receives more energy from the sun than it is losing to space</em>. The system is <strong>no longer in energy balance</strong>.</p>
<p>The temperature must then increase to get back into balance. The increase will not happen all at once! It will take time for energy to accumulate in the climate system. We want to model this <strong>time-dependent adjustment</strong> of the system.</p>
<p>In fact almost all climate models are <strong>time-dependent</strong>, meaning the model calculates <strong>time derivatives</strong> (rates of change) of climate variables.</p>
<section id="an-energy-balance-equation">
<h3>An energy balance <strong>equation</strong><a class="headerlink" href="#an-energy-balance-equation" title="Link to this heading">#</a></h3>
<p>We will write the <strong>total energy budget</strong> of the Earth system as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align} 
\frac{dE}{dt} &amp;= \text{net energy flux in to system} \\
 &amp;= \text{flux in – flux out} \\
 &amp;= \text{ASR} - \text{OLR}
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> is the <strong>enthalpy</strong> or <strong>heat content</strong> of the total system.</p>
<p>We will express the budget <strong>per unit surface area</strong>, so each term above has units W m<span class="math notranslate nohighlight">\(^{-2}\)</span></p>
<p>Note: any <strong>internal exchanges</strong> of energy between different reservoirs (e.g. between ocean, land, ice, atmosphere) do not appear in this budget – because <span class="math notranslate nohighlight">\(E\)</span> is the <strong>sum of all reservoirs</strong>.</p>
<p>Also note: <strong>This is a generically true statement.</strong> We have just defined some terms, and made the (very good) assumption that the only significant energy sources are radiative exchanges with space.</p>
<p><strong>This equation is the starting point for EVERY CLIMATE MODEL.</strong></p>
<p>But so far, we don’t actually have a MODEL. We just have a statement of a budget. To use this budget to make a model, we need to relate terms in the budget to state variables of the atmosphere-ocean system.</p>
<p>For now, the state variable we are most interested in is <strong>temperature</strong> – because it is directly connected to the physics of each term above.</p>
</section>
<section id="an-energy-balance-model">
<h3>An energy balance <strong>model</strong><a class="headerlink" href="#an-energy-balance-model" title="Link to this heading">#</a></h3>
<p>If we now suppose that</p>
<div class="math notranslate nohighlight">
\[ E = C T_s \]</div>
<p>where <span class="math notranslate nohighlight">\(T_s\)</span> is the <strong>global mean surface temperature</strong>, and <span class="math notranslate nohighlight">\(C\)</span> is a constant – the <strong>effective heat capacity</strong> of the atmosphere- ocean column.</p>
<p>then our budget equation becomes:</p>
<div class="math notranslate nohighlight">
\[ C \frac{dT_s}{dt} = \text{ASR} - \text{OLR} \]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C\)</span> is the <strong>heat capacity</strong> of Earth system, in units of J m<span class="math notranslate nohighlight">\(^{-2}\)</span> K<span class="math notranslate nohighlight">\(^{-1}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{dT_s}{dt}\)</span> is the rate of change of global average surface temperature.</p></li>
</ul>
<p>By adopting this equation, we are assuming that the energy content of the Earth system (atmosphere, ocean, ice, etc.) is <em>proportional to surface temperature</em>.</p>
<p>Important things to think about:</p>
<ul class="simple">
<li><p>Why is this a sensible assumption?</p></li>
<li><p>What determines the heat capacity <span class="math notranslate nohighlight">\(C\)</span>?</p></li>
<li><p>What are some limitations of this assumption?</p></li>
</ul>
<p>For our purposes here we are going to use a value of C equivalent to heating 100 meters of water:</p>
<div class="math notranslate nohighlight">
\[C = c_w \rho_w H\]</div>
<p>where</p>
<p><span class="math notranslate nohighlight">\(c_w = 4 \times 10^3\)</span> J kg<span class="math notranslate nohighlight">\(^{-1}\)</span> <span class="math notranslate nohighlight">\(^\circ\)</span>C<span class="math notranslate nohighlight">\(^{-1}\)</span> is the specific heat of water,</p>
<p><span class="math notranslate nohighlight">\(\rho_w = 10^3\)</span> kg m<span class="math notranslate nohighlight">\(^{-3}\)</span> is the density of water, and</p>
<p><span class="math notranslate nohighlight">\(H\)</span> is an effective depth of water that is heated or cooled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_w</span> <span class="o">=</span> <span class="mf">4E3</span>  <span class="c1">#  Specific heat of water in J/kg/K</span>
<span class="n">rho_w</span> <span class="o">=</span> <span class="mf">1E3</span>  <span class="c1">#  Density of water in kg/m3</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">100.</span>   <span class="c1">#  Depth of water in m</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">c_w</span> <span class="o">*</span> <span class="n">rho_w</span> <span class="o">*</span> <span class="n">H</span>   <span class="c1">#  Heat capacity of the model </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The effective heat capacity is </span><span class="si">{:.1e}</span><span class="s1"> J/m2/K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The effective heat capacity is 4.0e+08 J/m2/K
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-the-energy-balance-model">
<h3>Solving the energy balance model<a class="headerlink" href="#solving-the-energy-balance-model" title="Link to this heading">#</a></h3>
<p>This is a first-order Ordinary Differential Equation (ODE) for <span class="math notranslate nohighlight">\(T_s\)</span> as a function of time. It is also <strong>our very first climate model!</strong></p>
<p>To solve it (i.e. see how <span class="math notranslate nohighlight">\(T_s\)</span> evolves from some specified initial condition) we have two choices:</p>
<ol class="arabic simple">
<li><p>Solve it analytically</p></li>
<li><p>Solve it numerically</p></li>
</ol>
<p>Option 1 (analytical) will usually not be possible because the equations will typically be too complex and non-linear. This is why computers are our best friends in the world of climate modeling.</p>
<p>HOWEVER it is often useful and instructive to simplify a model down to something that is analytically solvable when possible. Why? Two reasons:</p>
<ol class="arabic simple">
<li><p>Analysis will often yield a deeper understanding of the behavior of the system</p></li>
<li><p>Gives us a benchmark against which to test the results of our numerical solutions.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="representing-time-derivatives-on-a-computer">
<h2>6. Representing time derivatives on a computer<a class="headerlink" href="#representing-time-derivatives-on-a-computer" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Recall that the derivative is the <strong>instantaneous rate of change</strong>. It is defined as</p>
<div class="math notranslate nohighlight">
\[ \frac{dT}{dt} = \lim_{\Delta t\rightarrow 0}⁡ \frac{\Delta T}{\Delta t}\]</div>
<ul class="simple">
<li><p><strong>On the computer there is no such thing as an instantaneous change.</strong></p></li>
<li><p>We are always dealing with <em>discrete quantities</em>.</p></li>
<li><p>So we approximate the derivative with <span class="math notranslate nohighlight">\(\Delta T/ \Delta t\)</span>.</p></li>
<li><p>So long as we take the time interval <span class="math notranslate nohighlight">\(\Delta t\)</span> “small enough”, the approximation is valid and useful.</p></li>
<li><p>(The meaning of “small enough” varies widely in practice. Let’s not talk about it now)</p></li>
</ul>
<p>So we write our model as</p>
<div class="math notranslate nohighlight">
\[ C  \frac{\Delta T}{\Delta t} \approx \text{ASR} - \text{OLR}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta T\)</span> is the <strong>change in temperature predicted by our model</strong> over a short time interval <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>We can now use this to <strong>make a prediction</strong>:</p>
<p>Given a current temperature <span class="math notranslate nohighlight">\(T_1\)</span> at time <span class="math notranslate nohighlight">\(t_1\)</span>, what is the temperature <span class="math notranslate nohighlight">\(T_2\)</span> at a future time <span class="math notranslate nohighlight">\(t_2\)</span>?</p>
<p>We can write</p>
<div class="math notranslate nohighlight">
\[ \Delta T = T_2-T_1 \]</div>
<div class="math notranslate nohighlight">
\[ \Delta t = t_2-t_1 \]</div>
<p>and so our model says</p>
<div class="math notranslate nohighlight">
\[ C  \frac{T_2-T_1}{\Delta t} = \text{ASR} - \text{OLR} \]</div>
<p>Which we can rearrange to <strong>solve for the future temperature</strong>:</p>
<div class="math notranslate nohighlight">
\[ T_2 = T_1 + \frac{\Delta t}{C} \left( \text{ASR} - \text{OLR}(T_1) \right)  \]</div>
<p>We now have a formula with which to make our prediction!</p>
<p>Notice that we have written the OLR as a <em>function of temperature</em>. We will use the current temperature <span class="math notranslate nohighlight">\(T_1\)</span> to compute the OLR, and use that OLR to determine the future temperature.</p>
</section>
<hr class="docutils" />
<section id="numerical-solution-of-the-energy-balance-model">
<h2>7. Numerical solution of the Energy Balance Model<a class="headerlink" href="#numerical-solution-of-the-energy-balance-model" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The quantity <span class="math notranslate nohighlight">\(\Delta t\)</span> is called a <strong>timestep</strong>. It is the smallest time interval represented in our model.</p>
<p>Here we’re going to use a timestep of 1 year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="mf">60.</span> <span class="o">*</span> <span class="mf">60.</span> <span class="o">*</span> <span class="mf">24.</span> <span class="o">*</span> <span class="mf">365.</span>   <span class="c1"># one year expressed in seconds</span>
</pre></div>
</div>
</div>
</div>
<section id="try-stepping-forward-one-timestep">
<h3>Try stepping forward one timestep<a class="headerlink" href="#try-stepping-forward-one-timestep" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try a single timestep, assuming we have working functions for ASR and OLR</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mf">288.</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ASR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.32</span><span class="p">)</span> <span class="o">-</span> <span class="n">OLR</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.57</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">e45ef08587df</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Try a single timestep, assuming we have working functions for ASR and OLR</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">T1</span> <span class="o">=</span> <span class="mf">288.</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ASR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.32</span><span class="p">)</span> <span class="o">-</span> <span class="n">OLR</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.57</span><span class="p">)</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="nb">print</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;ASR&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><em><strong>Did you get a <code class="docutils literal notranslate"><span class="pre">NameError</span></code> here?</strong></em></p>
<p>The code above assumes that we have already defined functions <code class="docutils literal notranslate"><span class="pre">ASR()</span></code> and <code class="docutils literal notranslate"><span class="pre">OLR()</span></code>. If you haven’t completed the exercise above, then the code won’t work.</p>
<p>Let’s now define the functions that we were supposed to create above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ASR</span><span class="p">(</span><span class="n">Q</span><span class="o">=</span><span class="n">Q</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">Q</span>

<span class="k">def</span><span class="w"> </span><span class="nf">OLR</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’ll try again…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try a single timestep, assuming we have working functions for ASR and OLR</span>
<span class="n">T1</span> <span class="o">=</span> <span class="mf">288.</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ASR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.32</span><span class="p">)</span> <span class="o">-</span> <span class="n">OLR</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.57</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>288.7678026614462
</pre></div>
</div>
</div>
</div>
<p>What happened? Why?</p>
<p>Try another timestep</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span> <span class="o">=</span> <span class="n">T2</span>
<span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ASR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.32</span><span class="p">)</span> <span class="o">-</span> <span class="n">OLR</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.57</span><span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>289.3479210238739
</pre></div>
</div>
</div>
</div>
<p>Warmed up again, but by a smaller amount.</p>
<p>But this is tedious typing. Time to <strong>define a function</strong> to make things easier and more reliable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">step_forward</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">T</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ASR</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.32</span><span class="p">)</span> <span class="o">-</span> <span class="n">OLR</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.57</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Try it out with an arbitrary temperature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step_forward</span><span class="p">(</span><span class="mf">300.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>297.658459884
</pre></div>
</div>
</div>
</div>
<p>Notice that our function calls other functions and variables we have already defined.</p>
<section id="python-fact-10-functions-can-access-variables-and-other-functions-defined-outside-of-the-function">
<h4>Python fact 10: Functions can access variables and other functions defined outside of the function.<a class="headerlink" href="#python-fact-10-functions-can-access-variables-and-other-functions-defined-outside-of-the-function" title="Link to this heading">#</a></h4>
<p>This is both very useful and occasionally confusing.</p>
</section>
</section>
<section id="automate-the-timestepping-with-a-loop">
<h3>Automate the timestepping with a loop<a class="headerlink" href="#automate-the-timestepping-with-a-loop" title="Link to this heading">#</a></h3>
<p>Now let’s really harness the power of the computer by <strong>making a loop</strong> (and storing values in arrays):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">numsteps</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">Tsteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">numsteps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Tsteps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">288.</span> 
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numsteps</span><span class="p">):</span>
    <span class="n">Years</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">Tsteps</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_forward</span><span class="p">(</span> <span class="n">Tsteps</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Tsteps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[288.         288.76780266 289.34792102 289.78523685 290.11433323
 290.36166675 290.54736768 290.68669049 290.79115953 290.86946109
 290.92813114 290.97208122 291.00499865 291.02964965 291.0481083
 291.06192909 291.07227674 291.08002371 291.08582346 291.09016532
 291.09341571]
</pre></div>
</div>
</div>
</div>
<p>What did we just do?</p>
<ul class="simple">
<li><p>Created an array of zeros</p></li>
<li><p>set the initial temperature to 288 K</p></li>
<li><p>repeated our time step 20 times.</p></li>
<li><p>Stored the results of each time step into the array.</p></li>
</ul>
<section id="python-fact-11-the-for-statement-executes-a-statement-or-series-of-statements-a-specified-number-of-times-a-loop">
<h4>Python fact 11: the <code class="docutils literal notranslate"><span class="pre">for</span></code> statement executes a statement (or series of statements) a specified number of times (a loop!)<a class="headerlink" href="#python-fact-11-the-for-statement-executes-a-statement-or-series-of-statements-a-specified-number-of-times-a-loop" title="Link to this heading">#</a></h4>
</section>
<section id="python-fact-12-use-square-bracket-to-refer-to-elements-of-an-array-or-list-use-round-parentheses-for-function-arguments">
<h4>Python fact 12: Use square bracket [ ] to refer to elements of an array or list. Use round parentheses ( ) for function arguments.<a class="headerlink" href="#python-fact-12-use-square-bracket-to-refer-to-elements-of-an-array-or-list-use-round-parentheses-for-function-arguments" title="Link to this heading">#</a></h4>
</section>
</section>
<section id="plotting-the-result">
<h3>Plotting the result<a class="headerlink" href="#plotting-the-result" title="Link to this heading">#</a></h3>
<p>Now let’s draw a picture of our result!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a special instruction for the Jupyter notebook</span>
<span class="c1">#   Display all plots inline in the notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline  
<span class="c1">#  import the plotting package</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Years</span><span class="p">,</span> <span class="n">Tsteps</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Years&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Global mean temperature (K)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/035ffc842b48464eccd6be65c24df438334f148d79c732d875c728d3de2c9c03.png" src="../_images/035ffc842b48464eccd6be65c24df438334f148d79c732d875c728d3de2c9c03.png" />
</div>
</div>
<p>Note how the temperature <em>adjusts smoothly toward the equilibrium temperature</em>, that is, the temperature at which
ASR = OLR.</p>
<p><strong>If the planetary energy budget is out of balance, the temperature must change so that the OLR gets closer to the ASR!</strong></p>
<p>The adjustment is actually an <em>exponential decay</em> process: The rate of adjustment slows as the temperature approaches equilibrium.</p>
<p>The temperature gets very very close to equilibrium but never reaches it exactly.</p>
<section id="python-fact-13-we-can-easily-make-simple-graphs-with-the-function-plt-plot-x-y-where-x-and-y-are-arrays-of-the-same-size-but-we-must-import-it-first">
<h4>Python fact 13: We can easily make simple graphs with the function <code class="docutils literal notranslate"><span class="pre">plt.plot(x,y)</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of the same size. But we must import it first.<a class="headerlink" href="#python-fact-13-we-can-easily-make-simple-graphs-with-the-function-plt-plot-x-y-where-x-and-y-are-arrays-of-the-same-size-but-we-must-import-it-first" title="Link to this heading">#</a></h4>
<p>This is actually not native Python, but uses a graphics library called <a class="reference external" href="https://matplotlib.org">matplotlib</a>. This is the workhorse of scientific plotting in Python, and we will be using it all the time!</p>
<p>Just about all of our notebooks will start with this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="summary-and-take-away-messages">
<h2>8. Summary and take-away messages<a class="headerlink" href="#summary-and-take-away-messages" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<ul class="simple">
<li><p>We looked at the flows of energy in and out of the Earth system.</p></li>
<li><p>These are determined by radiation at the top of the Earth’s atmosphere.</p></li>
<li><p>Any imbalance between shortwave absorption (ASR) and longwave emission (OLR) drives a change in temperature</p></li>
<li><p>Using this idea, we built a climate model!</p></li>
<li><p>This <strong>Zero-Dimensional Energy Balance Model</strong> solves for the global, annual mean surface temperature <span class="math notranslate nohighlight">\(T_s\)</span></p></li>
<li><p>Two key assumptions:</p>
<ul>
<li><p>Energy content of the Earth system varies proportionally to <span class="math notranslate nohighlight">\(T_s\)</span></p></li>
<li><p>The OLR increases as <span class="math notranslate nohighlight">\(\tau \sigma T_s^4\)</span> (our simple greenhouse model)</p></li>
</ul>
</li>
<li><p>Earth (or any planet) has a well-defined <strong>equilibrium temperature</strong> <span class="math notranslate nohighlight">\(T_{eq}\)</span> at which ASR = OLR, because of the <em>temperature dependence of the outgoing longwave radiation</em>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(T_s &lt; T_{eq}\)</span>, the model will warm up.</p></li>
<li><p>We can represent the continous warming process on the computer using discrete timesteps.</p></li>
<li><p>We can plot the result.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>This notebook is part of <a class="reference external" href="https://brian-rose.github.io/ClimateLaboratoryBook">The Climate Laboratory</a>, an open-source textbook developed and maintained by <a class="reference external" href="http://www.atmos.albany.edu/facstaff/brose/index.html">Brian E. J. Rose</a>, University at Albany.</p>
<p>It is licensed for free and open consumption under the
<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International (CC BY 4.0)</a> license.</p>
<p>Development of these notes and the <a class="reference external" href="https://github.com/climlab/climlab">climlab software</a> is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.</p>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./courseware"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="models-budgets-fun.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Climate models, the global energy budget, and Fun with Python</p>
      </div>
    </a>
    <a class="right-next"
       href="analytical-efolding.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced topic: Analytical solution of the global Energy Balance Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-the-global-energy-budget">1. Recap of the global energy budget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-radiative-fluxes-to-the-observations">2. Tuning radiative fluxes to the observations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-our-simple-greenhouse-model">Recap of our simple greenhouse model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-shortwave-radiation-asr-and-planetary-albedo">Absorbed Shortwave Radiation (ASR) and Planetary Albedo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-mean-insolation">Global mean insolation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#planetary-albedo">Planetary albedo</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#absorbed-shortwave-radiation">Absorbed Shortwave Radiation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-temperature">3. Equilibrium temperature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-climate-change-scenario">4. A climate change scenario</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-exercise">Python exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-time-dependent-energy-balance-model">5. A time-dependent Energy Balance Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-energy-balance-equation">An energy balance <strong>equation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#an-energy-balance-model">An energy balance <strong>model</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-energy-balance-model">Solving the energy balance model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representing-time-derivatives-on-a-computer">6. Representing time derivatives on a computer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-of-the-energy-balance-model">7. Numerical solution of the Energy Balance Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#try-stepping-forward-one-timestep">Try stepping forward one timestep</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-10-functions-can-access-variables-and-other-functions-defined-outside-of-the-function">Python fact 10: Functions can access variables and other functions defined outside of the function.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automate-the-timestepping-with-a-loop">Automate the timestepping with a loop</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-11-the-for-statement-executes-a-statement-or-series-of-statements-a-specified-number-of-times-a-loop">Python fact 11: the <code class="docutils literal notranslate"><span class="pre">for</span></code> statement executes a statement (or series of statements) a specified number of times (a loop!)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-12-use-square-bracket-to-refer-to-elements-of-an-array-or-list-use-round-parentheses-for-function-arguments">Python fact 12: Use square bracket [ ] to refer to elements of an array or list. Use round parentheses ( ) for function arguments.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-result">Plotting the result</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#python-fact-13-we-can-easily-make-simple-graphs-with-the-function-plt-plot-x-y-where-x-and-y-are-arrays-of-the-same-size-but-we-must-import-it-first">Python fact 13: We can easily make simple graphs with the function <code class="docutils literal notranslate"><span class="pre">plt.plot(x,y)</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of the same size. But we must import it first.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-and-take-away-messages">8. Summary and take-away messages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#credits">Credits</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian E. J. Rose
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>