{"version":2,"kind":"Notebook","sha256":"3de2bf79e9827632da910ad235c8392e4167699d95c51f673fcd0d57a62678f7","slug":"transient-cesm","location":"/courseware/transient-cesm.ipynb","dependencies":[],"frontmatter":{"title":"Examing the transient and equilibrium CO2 response in the CESM","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"}],"doi":"https://doi.org/10.5281/zenodo.4265097","open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/brian-rose/ClimateLaboratoryBook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"}],"abbreviations":{"OLR":"Outgoing Longwave Radiation","ASR":"Absorbed Shortwave Radiation","ECS":"Equilibrium Climate Sensitivity","TCR":"Transient Climate Response","EBM":"Energy Balance Model","GCM":"Global Circulation Model","OGCM":"Ocean Global Circulation Model","AGCM":"Atmospheric Global Circulation Model","AOGCM":"Atmosphere-Ocean Global Circulation Model","RCM":"Radiative-Convective Model","RCE":"Radiative-Convective Equilibrium","SCM":"Single-Column Model","ESM":"Earth System Model","CESM":"Community Earth System Model","IPCC":"Intergovernmental Panel on Climate Change","NCAR":"National Center for Atmospheric Research"},"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/brian-rose/ClimateLaboratoryBook/blob/main/courseware/transient-cesm.ipynb","thumbnail":"/ClimateLaboratoryBook/build/72a1ea4a26a2984d2b563dba60bd71bf.jpeg","thumbnailOptimized":"/ClimateLaboratoryBook/build/72a1ea4a26a2984d2b563dba60bd71bf.webp","exports":[{"format":"ipynb","filename":"transient-cesm.ipynb","url":"/ClimateLaboratoryBook/build/transient-cesm-d9bf977cab4b3f1762fccfdb3fce6d66.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oPUDiBQEhI"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bnRVAWe8cc"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"ApFeE8QvE4"},{"type":"text","value":" by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZtBpFgZiFn"},{"type":"link","url":"http://www.atmos.albany.edu/facstaff/brose/index.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OnHRFsYbUA"}],"urlSource":"http://www.atmos.albany.edu/facstaff/brose/index.html","key":"vaI1g0cgcN"},{"type":"text","value":", University at Albany.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nwbO0DLbli"}],"key":"lwicRxuSLI"}],"key":"CglXGp9kZh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"I have run two sets of experiments with the ","key":"dRQ9xiPd8a"},{"type":"abbreviation","title":"Community Earth System Model","children":[{"type":"text","value":"CESM","key":"KsP4BDdXfl"}],"key":"s7JBTvyIcW"},{"type":"text","value":" model:","key":"yzGeU1xQdX"}],"key":"b9SpW0FINJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The fully coupled model:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aay0X0huoc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"pre-industrial control","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rkobyVzkWi"}],"key":"KavfJOFBwS"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"1%/year CO2 ramp scenario for 80 years","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vhDfddl5Nj"}],"key":"JujQUNRCZe"}],"key":"d9EanhLtph"}],"key":"WNKcpO63Tf"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The slab ocean model:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rP7DdAdUA5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"pre-industrial control with prescribed q-flux","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bSMHqV4XMC"}],"key":"UTMQ55pf8c"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"2xCO2 scenario run out to equilibrium","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bB8Tl214xy"}],"key":"MemprdQeIP"}],"key":"E21Oir1y9T"}],"key":"odr8jBx2Fl"}],"key":"ZIjEk12bVe"}],"key":"aAPPbT9IkZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our main first task is to compute the two canonical measures of climate sensitivity for this model:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gGKD605GMh"}],"key":"Xzh6fcDM60"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Equilibrium Climate Sensitivity (","key":"Ous0jGRPMg"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"Hce70x8ZX2"}],"key":"AFcNm6jacE"},{"type":"text","value":")","key":"D3iyN2rawe"}],"key":"bEt7WCh0x3"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Transient Climate Response (","key":"c7ciVxNSks"},{"type":"abbreviation","title":"Transient Climate Response","children":[{"type":"text","value":"TCR","key":"K7ghIGTD7s"}],"key":"hGAAF4PDdX"},{"type":"text","value":")","key":"obpu7KgwE8"}],"key":"eoiBnsxbE1"}],"key":"SsT4r2dFCi"}],"key":"mXZGKeE6RS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the ","key":"rXif4XozfO"},{"type":"abbreviation","title":"Intergovernmental Panel on Climate Change","children":[{"type":"text","value":"IPCC","key":"Zi28ke5Lri"}],"key":"gL9e2mhbi3"},{"type":"text","value":" AR5 WG1 report, Chapter 9, page 817:","key":"bDbbLHcaPI"}],"key":"nvZDsz1ma8"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Equilibrium climate sensitivity (","key":"ngc8fwOuYt"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"X2nxtPfH2l"}],"key":"ASQiEOWJjT"},{"type":"text","value":") is the equilibrium change in global and annual mean surface air temperature after doubling the atmos- pheric concentration of CO2 relative to pre-industrial levels.","key":"KYEaHzi9n1"}],"key":"ytYh757uBQ"}],"key":"CSwTxIYHi4"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The transient climate response (","key":"UA0EpBIJaz"},{"type":"abbreviation","title":"Transient Climate Response","children":[{"type":"text","value":"TCR","key":"U0Ooah6ODt"}],"key":"bmDnBavXEq"},{"type":"text","value":") is the change in global and annual mean surface temperature from an experiment in which the CO2 concentration is increased by 1% yr","key":"IrKEHE6j0N"},{"type":"inlineMath","value":"^{–1}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mtext>–</mtext><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{–1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">–1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"m1ivsAgm3O"},{"type":"text","value":", and calculated using the difference between the start of the experiment and a 20-year period centred on the time of CO2 doubling.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"inyWOQG3gT"}],"key":"WsE4mWCoxP"}],"key":"GTZaZDlYL7"}],"key":"Ya3K9mkB1p"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, a quick demonstration that 1%/year compounded increase reaches doubling after 70 years","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mcYrtghdZ2"}],"identifier":"first-a-quick-demonstration-that-1-year-compounded-increase-reaches-doubling-after-70-years","label":"First, a quick demonstration that 1%/year compounded increase reaches doubling after 70 years","html_id":"first-a-quick-demonstration-that-1-year-compounded-increase-reaches-doubling-after-70-years","implicit":true,"key":"mgvfKNO2KE"}],"key":"tgS7sFofcB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"startingamount = 1.\namount = startingamount\nfor n in range(70):\n    amount *= 1.01\namount","key":"I3UaVGlEys"},{"type":"output","id":"JtvqatPrgE5wd5XjJXvvC","data":[{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/plain":{"content":"2.006763368395386","content_type":"text/plain"}}}],"key":"AXVuPM4DIq"}],"key":"No6sw7UfQ8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"abbreviation","title":"Transient Climate Response","children":[{"type":"text","value":"TCR","key":"Afx5Eam3oC"}],"key":"L9hn90oC2Y"},{"type":"text","value":" is always smaller than ","key":"iJbUjhxrnT"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"fJ7pViFxCR"}],"key":"mJPzm72GMv"},{"type":"text","value":" due to the transient effects of ocean heat uptake.","key":"zXNAIzrsQ5"}],"key":"rBqqHXRJ9D"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are going to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LSQEhTQ63u"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"estimate","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GRHpLm0d1O"}],"key":"zfYhjQQld3"},{"type":"text","value":" the ","key":"rQzFW1g17t"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"t7MzoMhdGr"}],"key":"EdJkFw6t8x"},{"type":"text","value":" of the fully coupled model by using the equilibrium response of the Slab Ocean .","key":"tvMbPQcvfJ"}],"key":"bV6vZrGQoQ"}],"key":"j1wfhRaiu2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport xarray as xr","key":"EMaQPr14Eo"},{"type":"output","id":"CiS_jJ93_snufXA3VZ3H8","data":[],"key":"TF28fp7YsR"}],"key":"VlQSrhAZdh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the concatenated output from the CAM output (atmosphere)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bEKBwOmbks"}],"identifier":"load-the-concatenated-output-from-the-cam-output-atmosphere","label":"Load the concatenated output from the CAM output (atmosphere)","html_id":"load-the-concatenated-output-from-the-cam-output-atmosphere","implicit":true,"key":"U1VB0ZELyb"}],"key":"DSeZsXnWEG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"casenames = {'cpl_control': 'cpl_1850_f19',\n             'cpl_CO2ramp': 'cpl_CO2ramp_f19',\n             'som_control': 'som_1850_f19',\n             'som_2xCO2':   'som_1850_2xCO2',\n            }\n# The path to the THREDDS server, should work from anywhere\nbasepath = 'http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/'\n# For better performance if you can access the roselab_rit filesystem (e.g. from JupyterHub)\n# basepath = '/roselab_rit/cesm_archive/'\ncasepaths = {}\nfor name in casenames:\n    casepaths[name] = basepath + casenames[name] + '/concatenated/'","key":"PwbnPu4gYt"},{"type":"output","id":"jJCTdlBnpdJ2mc2wB11TT","data":[],"key":"zS00c2Xp5E"}],"key":"BGzDmpuXts"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# make a dictionary of all the CAM atmosphere output\natm = {}\nfor name in casenames:\n    path = casepaths[name] + casenames[name] + '.cam.h0.nc'\n    print('Attempting to open the dataset ', path)\n    atm[name] = xr.open_dataset(path, decode_times=False)","key":"W3iwnBvw9u"},{"type":"output","id":"ArbCKIWSB-xsiN4CkSEU1","data":[{"name":"stdout","output_type":"stream","text":"Attempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_1850_f19/concatenated/cpl_1850_f19.cam.h0.nc\nAttempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/cpl_CO2ramp_f19/concatenated/cpl_CO2ramp_f19.cam.h0.nc\nAttempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_f19/concatenated/som_1850_f19.cam.h0.nc\nAttempting to open the dataset  http://thredds.atmos.albany.edu:8080/thredds/dodsC/CESMA/som_1850_2xCO2/concatenated/som_1850_2xCO2.cam.h0.nc\n"}],"key":"v1DoWCTx4u"}],"key":"cwVOgTkCzE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A plot of the prescribed CO2 concentrations in the coupled simulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQfj1a0INU"}],"identifier":"a-plot-of-the-prescribed-co2-concentrations-in-the-coupled-simulations","label":"A plot of the prescribed CO2 concentrations in the coupled simulations","html_id":"a-plot-of-the-prescribed-co2-concentrations-in-the-coupled-simulations","implicit":true,"key":"HSvRHup3XG"}],"key":"Zj8kWISpNA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"days_per_year = 365\nfig, ax = plt.subplots()\nfor name in ['cpl_control', 'cpl_CO2ramp']:\n    ax.plot(atm[name].time/days_per_year, atm[name].co2vmr*1E6, label=name)\nax.set_title('CO2 volume mixing ratio (CESM coupled simulations)')\nax.set_xlabel('Years')\nax.set_ylabel('pCO2 (ppm)')\nax.grid()\nax.legend();","key":"xNBMWenyVF"},{"type":"output","id":"kV1TMkRUg4th_QYN9Djse","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5994eedec9c803778a6110eaeb276bd4","path":"/ClimateLaboratoryBook/build/5994eedec9c803778a6110eaeb276bd4.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"qj7rQNLlw2"}],"key":"ATcehaLMJr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Issues to think about:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aXAkhV0LU6"}],"key":"zpW6vXooj7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Why do we talk about fractional changes in CO2, such as “doubling atmospheric CO2”, and \"1%/year compounded CO2 increase?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G4sMTfA99o"}],"key":"OpbSbQ8dyl"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Why not instead talk about changes in absolute amounts of CO2?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ySockQhYh8"}],"key":"rrf3DpopHs"}],"key":"LXzc4V380K"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The answer is closely related to the fact that the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LCpNSYIq2E"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"radiative forcing","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UjTjChAjCg"}],"key":"qrm0rPw7wU"},{"type":"text","value":" associated with CO2 increase is approximately ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v9gmNeCJEu"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"logarithmic","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PxJGTSmhJe"}],"key":"D9uOSTpqe4"},{"type":"text","value":" in CO2 amount. So a doubling of CO2 represents roughly the same radiative forcing ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G648hL4B6D"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"regardless of the initial CO2 concentration","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LmhRtagyt3"}],"key":"QHTj8xcnfu"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jnUJE8OxJh"}],"key":"VBz1LTiaGd"}],"key":"zMcA1MEqdq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute and plot time series of global, annual mean near-surface air temperature in all four simulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yrSEKxxux1"}],"identifier":"compute-and-plot-time-series-of-global-annual-mean-near-surface-air-temperature-in-all-four-simulations","label":"Compute and plot time series of global, annual mean near-surface air temperature in all four simulations","html_id":"compute-and-plot-time-series-of-global-annual-mean-near-surface-air-temperature-in-all-four-simulations","implicit":true,"key":"ziUn2PnrUg"}],"key":"ItsxVSJ0Am"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# The surface air temperature, which we will use for our sensitivity metrics\natm['cpl_control'].TREFHT","key":"O968MIjYP3"},{"type":"output","id":"FDsHOnWUsllx0-pJ9WV8o","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;TREFHT&#x27; (time: 240, lat: 96, lon: 144)&gt; Size: 13MB\n[3317760 values with dtype=float32]\nCoordinates:\n  * time     (time) float64 2kB 31.0 59.0 90.0 ... 7.239e+03 7.269e+03 7.3e+03\n  * lat      (lat) float64 768B -90.0 -88.11 -86.21 -84.32 ... 86.21 88.11 90.0\n  * lon      (lon) float64 1kB 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5\nAttributes:\n    units:         K\n    long_name:     Reference height temperature\n    cell_methods:  time: mean</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'TREFHT'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 240</li><li><span class='xr-has-index'>lat</span>: 96</li><li><span class='xr-has-index'>lon</span>: 144</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-98d57fc1-731d-4a20-99a9-364b3234299c' class='xr-array-in' type='checkbox' checked><label for='section-98d57fc1-731d-4a20-99a9-364b3234299c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[3317760 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-faad25f6-832a-48ad-9df6-284e08060b98' class='xr-section-summary-in' type='checkbox'  checked><label for='section-faad25f6-832a-48ad-9df6-284e08060b98' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>31.0 59.0 ... 7.269e+03 7.3e+03</div><input id='attrs-4df12844-5505-4da2-ba14-03e8e4bd0a22' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4df12844-5505-4da2-ba14-03e8e4bd0a22' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6f76d99-8f32-4523-9157-d4e623ca5390' class='xr-var-data-in' type='checkbox'><label for='data-b6f76d99-8f32-4523-9157-d4e623ca5390' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>days since 0001-01-01 00:00:00</dd><dt><span>calendar :</span></dt><dd>noleap</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd></dl></div><div class='xr-var-data'><pre>array([  31.,   59.,   90., ..., 7239., 7269., 7300.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -88.11 -86.21 ... 88.11 90.0</div><input id='attrs-6cea3e71-67ac-48b4-b4e8-f3c967319235' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6cea3e71-67ac-48b4-b4e8-f3c967319235' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06df14c5-2490-4911-ae15-7f44b55ec2c1' class='xr-var-data-in' type='checkbox'><label for='data-06df14c5-2490-4911-ae15-7f44b55ec2c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -88.105263, -86.210526, -84.315789, -82.421053, -80.526316,\n       -78.631579, -76.736842, -74.842105, -72.947368, -71.052632, -69.157895,\n       -67.263158, -65.368421, -63.473684, -61.578947, -59.684211, -57.789474,\n       -55.894737, -54.      , -52.105263, -50.210526, -48.315789, -46.421053,\n       -44.526316, -42.631579, -40.736842, -38.842105, -36.947368, -35.052632,\n       -33.157895, -31.263158, -29.368421, -27.473684, -25.578947, -23.684211,\n       -21.789474, -19.894737, -18.      , -16.105263, -14.210526, -12.315789,\n       -10.421053,  -8.526316,  -6.631579,  -4.736842,  -2.842105,  -0.947368,\n         0.947368,   2.842105,   4.736842,   6.631579,   8.526316,  10.421053,\n        12.315789,  14.210526,  16.105263,  18.      ,  19.894737,  21.789474,\n        23.684211,  25.578947,  27.473684,  29.368421,  31.263158,  33.157895,\n        35.052632,  36.947368,  38.842105,  40.736842,  42.631579,  44.526316,\n        46.421053,  48.315789,  50.210526,  52.105263,  54.      ,  55.894737,\n        57.789474,  59.684211,  61.578947,  63.473684,  65.368421,  67.263158,\n        69.157895,  71.052632,  72.947368,  74.842105,  76.736842,  78.631579,\n        80.526316,  82.421053,  84.315789,  86.210526,  88.105263,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 2.5 5.0 ... 352.5 355.0 357.5</div><input id='attrs-dd2be534-9fcf-4af7-9173-634a750d9c40' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd2be534-9fcf-4af7-9173-634a750d9c40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0f5b074-2de2-4342-809f-8f402a81435c' class='xr-var-data-in' type='checkbox'><label for='data-e0f5b074-2de2-4342-809f-8f402a81435c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0. ,   2.5,   5. ,   7.5,  10. ,  12.5,  15. ,  17.5,  20. ,  22.5,\n        25. ,  27.5,  30. ,  32.5,  35. ,  37.5,  40. ,  42.5,  45. ,  47.5,\n        50. ,  52.5,  55. ,  57.5,  60. ,  62.5,  65. ,  67.5,  70. ,  72.5,\n        75. ,  77.5,  80. ,  82.5,  85. ,  87.5,  90. ,  92.5,  95. ,  97.5,\n       100. , 102.5, 105. , 107.5, 110. , 112.5, 115. , 117.5, 120. , 122.5,\n       125. , 127.5, 130. , 132.5, 135. , 137.5, 140. , 142.5, 145. , 147.5,\n       150. , 152.5, 155. , 157.5, 160. , 162.5, 165. , 167.5, 170. , 172.5,\n       175. , 177.5, 180. , 182.5, 185. , 187.5, 190. , 192.5, 195. , 197.5,\n       200. , 202.5, 205. , 207.5, 210. , 212.5, 215. , 217.5, 220. , 222.5,\n       225. , 227.5, 230. , 232.5, 235. , 237.5, 240. , 242.5, 245. , 247.5,\n       250. , 252.5, 255. , 257.5, 260. , 262.5, 265. , 267.5, 270. , 272.5,\n       275. , 277.5, 280. , 282.5, 285. , 287.5, 290. , 292.5, 295. , 297.5,\n       300. , 302.5, 305. , 307.5, 310. , 312.5, 315. , 317.5, 320. , 322.5,\n       325. , 327.5, 330. , 332.5, 335. , 337.5, 340. , 342.5, 345. , 347.5,\n       350. , 352.5, 355. , 357.5])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5cd839ad-6982-468d-8df0-0a8b2fe688d9' class='xr-section-summary-in' type='checkbox'  ><label for='section-5cd839ad-6982-468d-8df0-0a8b2fe688d9' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4c760a38-7013-4786-b51d-3e31d7b81ed9' class='xr-index-data-in' type='checkbox'/><label for='index-4c760a38-7013-4786-b51d-3e31d7b81ed9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  31.0,   59.0,   90.0,  120.0,  151.0,  181.0,  212.0,  243.0,  273.0,\n        304.0,\n       ...\n       7025.0, 7055.0, 7086.0, 7116.0, 7147.0, 7178.0, 7208.0, 7239.0, 7269.0,\n       7300.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=240))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-224604af-f9bf-4ca0-8b84-68526fc20829' class='xr-index-data-in' type='checkbox'/><label for='index-224604af-f9bf-4ca0-8b84-68526fc20829' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -90.0,  -88.10526315789474,  -86.21052631578948,\n         -84.3157894736842,  -82.42105263157895,  -80.52631578947368,\n        -78.63157894736842,  -76.73684210526316,  -74.84210526315789,\n        -72.94736842105263,  -71.05263157894737,  -69.15789473684211,\n        -67.26315789473685,  -65.36842105263158, -63.473684210526315,\n       -61.578947368421055, -59.684210526315795,  -57.78947368421053,\n        -55.89473684210527,               -54.0,  -52.10526315789474,\n        -50.21052631578947,  -48.31578947368421,  -46.42105263157895,\n       -44.526315789473685, -42.631578947368425,  -40.73684210526316,\n         -38.8421052631579,  -36.94736842105264,  -35.05263157894737,\n        -33.15789473684211, -31.263157894736842, -29.368421052631582,\n       -27.473684210526322, -25.578947368421055, -23.684210526315795,\n       -21.789473684210535,  -19.89473684210526,               -18.0,\n        -16.10526315789474,  -14.21052631578948,  -12.31578947368422,\n       -10.421052631578945,  -8.526315789473685,  -6.631578947368425,\n        -4.736842105263165, -2.8421052631579045, -0.9473684210526301,\n        0.9473684210526301,  2.8421052631578902,    4.73684210526315,\n         6.631578947368411,   8.526315789473685,  10.421052631578945,\n        12.315789473684205,  14.210526315789465,  16.105263157894726,\n                      18.0,   19.89473684210526,   21.78947368421052,\n         23.68421052631578,   25.57894736842104,  27.473684210526315,\n        29.368421052631575,  31.263157894736835,  33.157894736842096,\n        35.052631578947356,   36.94736842105263,   38.84210526315789,\n         40.73684210526315,   42.63157894736841,   44.52631578947367,\n         46.42105263157893,   48.31578947368419,   50.21052631578948,\n         52.10526315789474,                54.0,   55.89473684210526,\n         57.78947368421052,   59.68421052631578,   61.57894736842104,\n          63.4736842105263,   65.36842105263156,   67.26315789473682,\n         69.15789473684211,   71.05263157894737,   72.94736842105263,\n         74.84210526315789,   76.73684210526315,   78.63157894736841,\n         80.52631578947367,   82.42105263157893,   84.31578947368419,\n         86.21052631578945,   88.10526315789474,                90.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8fc205c5-4256-4a45-b0a8-72d45e492398' class='xr-index-data-in' type='checkbox'/><label for='index-8fc205c5-4256-4a45-b0a8-72d45e492398' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   2.5,   5.0,   7.5,  10.0,  12.5,  15.0,  17.5,  20.0,  22.5,\n       ...\n       335.0, 337.5, 340.0, 342.5, 345.0, 347.5, 350.0, 352.5, 355.0, 357.5],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=144))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c65dfc31-b772-4caf-8f74-96b9ea0f4157' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c65dfc31-b772-4caf-8f74-96b9ea0f4157' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Reference height temperature</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'TREFHT' (time: 240, lat: 96, lon: 144)> Size: 13MB\n[3317760 values with dtype=float32]\nCoordinates:\n  * time     (time) float64 2kB 31.0 59.0 90.0 ... 7.239e+03 7.269e+03 7.3e+03\n  * lat      (lat) float64 768B -90.0 -88.11 -86.21 -84.32 ... 86.21 88.11 90.0\n  * lon      (lon) float64 1kB 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5\nAttributes:\n    units:         K\n    long_name:     Reference height temperature\n    cell_methods:  time: mean","content_type":"text/plain"}}}],"key":"RfNbc8Z9NB"}],"key":"SzAGLG6K6G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  The area weighting needed for global averaging\ngw = atm['som_control'].gw\nprint(gw)","key":"a9CJyi0pEW"},{"type":"output","id":"QcgjMVWnoRqrIHkERS-_R","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray 'gw' (lat: 96)> Size: 768B\n[96 values with dtype=float64]\nCoordinates:\n  * lat      (lat) float64 768B -90.0 -88.11 -86.21 -84.32 ... 86.21 88.11 90.0\nAttributes:\n    long_name:  gauss weights\n"}],"key":"vqOMMx2PW9"}],"key":"hrb4TmfNcQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def global_mean(field, weight=gw):\n    '''Return the area-weighted global average of the input field'''\n    return (field*weight).mean(dim=('lat','lon'))/weight.mean(dim='lat')","key":"vN4naX1nAm"},{"type":"output","id":"lmDlbL8ksk_xtBL4dLk7h","data":[],"key":"JL6l0jmlmh"}],"key":"hTb6o4M0Uz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#  Loop through the four simulations and produce the global mean timeseries\nTREFHT_global = {}\nfor name in casenames:\n    TREFHT_global[name] = global_mean(atm[name].TREFHT)","key":"GH0mql5M9F"},{"type":"output","id":"peVPNOMcNJ0FCmHAsIlBu","data":[],"key":"QxsDMa6OT5"}],"key":"cc1bPuqumZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make some pretty timeseries plots, including an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qIuMd1hR5l"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"approximate","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JauYuV59mE"}],"key":"rAWqsyRfRA"},{"type":"text","value":" running annual average","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lCGZIbsv1x"}],"identifier":"make-some-pretty-timeseries-plots-including-an-approximate-running-annual-average","label":"Make some pretty timeseries plots, including an approximate running annual average","html_id":"make-some-pretty-timeseries-plots-including-an-approximate-running-annual-average","implicit":true,"key":"ziaMhiPVix"}],"key":"Acylw2g1mq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(2,1,figsize=(10,8))\nfor name in casenames:\n    if 'cpl' in name:\n        ax = axes[0]\n        ax.set_title('Fully coupled ocean')\n    else:\n        ax = axes[1]\n        ax.set_title('Slab ocean')\n    field = TREFHT_global[name]\n    field_running = field.rolling(time=12, center=True).mean()\n    line = ax.plot(field.time / days_per_year, \n                   field, \n                   label=name,\n                   linewidth=0.75,\n                   )\n    ax.plot(field_running.time / days_per_year, \n            field_running, \n            color=line[0].get_color(),\n            linewidth=2,\n           )\nfor ax in axes:\n    ax.legend();\n    ax.set_xlabel('Years')\n    ax.set_ylabel('Temperature (K)')\n    ax.grid();\n    ax.set_xlim(0,100)\nfig.suptitle('Global mean surface air temperature in CESM simulations', fontsize=16);","key":"DWRCz60YMd"},{"type":"output","id":"uRC_XYBuND91vq-xR5uNS","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"46ae1b5d504ec6a0464e16e0bb8385df","path":"/ClimateLaboratoryBook/build/46ae1b5d504ec6a0464e16e0bb8385df.png"},"text/plain":{"content":"<Figure size 1000x800 with 2 Axes>","content_type":"text/plain"}}}],"key":"kkIc0YzYow"}],"key":"Lgf2GbdvZV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Issues to think about here include:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M6d7JVkg3w"}],"key":"TEMhNEeMNi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Why is the annual average here only approximate? ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cRBQwMQ511"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"(think about the calendar)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KR74O0lX0M"}],"key":"KirMyC8SEe"}],"key":"a58vvPj1Pc"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Why is there an annual cycle in the global average temperature? (planet is coldest during NH winter)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EF9zWpLZm7"}],"key":"YTtfmnjXqQ"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Different character of the temperature ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NLUw4p1tZ6"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"variability","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WQWVRf42hJ"}],"key":"JI69lCh7U1"},{"type":"text","value":" in the coupled vs. slab model","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m16kzwVFRU"}],"key":"LQPFyyYXdh"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Much more rapid warming in the Slab Ocean Model","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SAcQyHepkt"}],"key":"QPlfV1xVlf"}],"key":"cOa36eLqaf"}],"key":"Vp1q7yNhjK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can work on computing ","key":"AydfhnEUvX"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"ZsWJ81wvK7"}],"key":"m0njUlBhXF"},{"type":"text","value":" and ","key":"DXc8kW4idu"},{"type":"abbreviation","title":"Transient Climate Response","children":[{"type":"text","value":"TCR","key":"d1SA5oeNp0"}],"key":"qu5Dj31jXZ"}],"identifier":"now-we-can-work-on-computing-ecs-and-tcr","label":"Now we can work on computing ECS and TCR","html_id":"now-we-can-work-on-computing-ecs-and-tcr","implicit":true,"key":"PxtVUgNzz2"}],"key":"fi3SdGEeK9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# extract the last 10 years from the slab ocean control simulation\n# and the last 20 years from the coupled control\nnyears_slab = 10\nnyears_cpl = 20\nclim_slice_slab = slice(-(nyears_slab*12),None)\nclim_slice_cpl = slice(-(nyears_cpl*12),None)","key":"zkIcddswQS"},{"type":"output","id":"t11u3KB9OFDFPIF5bgNE0","data":[],"key":"NY9A9pwYWW"}],"key":"pKuZpSGwgF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# extract the last 10 years from the slab ocean control simulation\nT0_slab = TREFHT_global['som_control'].isel(time=clim_slice_slab).mean(dim='time')\nT0_slab","key":"Ie70KGMcj7"},{"type":"output","id":"Ecs9w4G8OrTu4NYWD0pAb","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt; Size: 8B\narray(286.82486457)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b77fd23a-afd3-4ff6-9ce5-1ee866565452' class='xr-array-in' type='checkbox' checked><label for='section-b77fd23a-afd3-4ff6-9ce5-1ee866565452' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>286.8</span></div><div class='xr-array-data'><pre>array(286.82486457)</pre></div></div></li><li class='xr-section-item'><input id='section-650699df-e514-4c2f-8237-0f82aed50624' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-650699df-e514-4c2f-8237-0f82aed50624' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-bbec3a02-4454-41b8-9fee-894ef0abb70a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bbec3a02-4454-41b8-9fee-894ef0abb70a' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-1f0ce379-6017-4d4f-b0a7-9d8b3c09354f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1f0ce379-6017-4d4f-b0a7-9d8b3c09354f' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray ()> Size: 8B\narray(286.82486457)","content_type":"text/plain"}}}],"key":"CcrEAnhx3I"}],"key":"JnD9lHnyoQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# and the last 20 years from the coupled control\nT0_cpl = TREFHT_global['cpl_control'].isel(time=clim_slice_cpl).mean(dim='time')\nT0_cpl","key":"jBgtbtT0TX"},{"type":"output","id":"GK8NfsxyR2THdPV8HS4U_","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt; Size: 8B\narray(286.75125938)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-cde5b8f4-915f-457e-a49f-0f85da40d04b' class='xr-array-in' type='checkbox' checked><label for='section-cde5b8f4-915f-457e-a49f-0f85da40d04b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>286.8</span></div><div class='xr-array-data'><pre>array(286.75125938)</pre></div></div></li><li class='xr-section-item'><input id='section-2dc545ec-2447-4ea7-9275-812f75bc305b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2dc545ec-2447-4ea7-9275-812f75bc305b' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-55b06d19-c4b1-48e6-919e-2c015f869585' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-55b06d19-c4b1-48e6-919e-2c015f869585' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-f653ff64-8285-43be-a816-a0bb92a23b9a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f653ff64-8285-43be-a816-a0bb92a23b9a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray ()> Size: 8B\narray(286.75125938)","content_type":"text/plain"}}}],"key":"LR4Xh34iKy"}],"key":"kwxYpxznmV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# extract the last 10 years from the slab 2xCO2 simulation\nT2x_slab = TREFHT_global['som_2xCO2'].isel(time=clim_slice_slab).mean(dim='time')\nT2x_slab","key":"mEuTPLhtLZ"},{"type":"output","id":"JE3IciqaRx4OxdQGuNBkl","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt; Size: 8B\narray(289.71521445)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-19a78b59-0aea-4b3f-9453-2e6e57e06961' class='xr-array-in' type='checkbox' checked><label for='section-19a78b59-0aea-4b3f-9453-2e6e57e06961' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>289.7</span></div><div class='xr-array-data'><pre>array(289.71521445)</pre></div></div></li><li class='xr-section-item'><input id='section-328a64ff-e4fd-4f74-ac77-52cdd5238bb7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-328a64ff-e4fd-4f74-ac77-52cdd5238bb7' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-cdc04a47-c7f2-45e9-8cd3-c21bfb83e9c2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cdc04a47-c7f2-45e9-8cd3-c21bfb83e9c2' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-871d643a-d150-467b-9abf-4d03d45300a0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-871d643a-d150-467b-9abf-4d03d45300a0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray ()> Size: 8B\narray(289.71521445)","content_type":"text/plain"}}}],"key":"sapUh5esms"}],"key":"iwELy0ECcD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# extract the last 20 years from the coupled CO2 ramp simulation\nT2x_cpl = TREFHT_global['cpl_CO2ramp'].isel(time=clim_slice_cpl).mean(dim='time')\nT2x_cpl","key":"BU5sBtAHj5"},{"type":"output","id":"KcmHhOLtK2tDsBSoNBwF1","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1f1f1f;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray ()&gt; Size: 8B\narray(288.41935278)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-74daaeb4-20bd-466d-9dbb-40725ce12699' class='xr-array-in' type='checkbox' checked><label for='section-74daaeb4-20bd-466d-9dbb-40725ce12699' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>288.4</span></div><div class='xr-array-data'><pre>array(288.41935278)</pre></div></div></li><li class='xr-section-item'><input id='section-4beb7f1c-1263-40ce-a5e8-59c59a95b8ff' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4beb7f1c-1263-40ce-a5e8-59c59a95b8ff' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-1db509fa-c8b5-43d4-a4cd-a82cfb486908' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1db509fa-c8b5-43d4-a4cd-a82cfb486908' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-0f081c4d-c6ff-496c-be71-8bcb018e36fb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0f081c4d-c6ff-496c-be71-8bcb018e36fb' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray ()> Size: 8B\narray(288.41935278)","content_type":"text/plain"}}}],"key":"oHhZo5Gjq1"}],"key":"oTBnxgCtVg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ECS = T2x_slab - T0_slab\nTCR = T2x_cpl - T0_cpl\nprint('The Equilibrium Climate Sensitivity is {:.3} K.'.format(float(ECS)))\nprint('The Transient Climate Response is {:.3} K.'.format(float(TCR)))","key":"vIxscJQHtR"},{"type":"output","id":"sB-90Ms2rK4wyVXoE6f3e","data":[{"name":"stdout","output_type":"stream","text":"The Equilibrium Climate Sensitivity is 2.89 K.\nThe Transient Climate Response is 1.67 K.\n"}],"key":"DiM7Cd4KBl"}],"key":"BbSFUcPxa4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some CMIP climate sensitivity results to compare against","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"upF0ooAXUM"}],"identifier":"some-cmip-climate-sensitivity-results-to-compare-against","label":"Some CMIP climate sensitivity results to compare against","html_id":"some-cmip-climate-sensitivity-results-to-compare-against","implicit":true,"key":"rZ3UPt0yYi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Figure and table from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"muiFDHeVYz"},{"type":"citeGroup","kind":"narrative","children":[{"type":"cite","kind":"narrative","label":"AR5_Ch9","identifier":"ar5_ch9","children":[{"type":"text","value":"Flato ","key":"E0RcmoErMZ"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"mx1sc56hDk"}],"key":"VoGCqTW96E"},{"type":"text","value":" (2013)","key":"YN88paw7n8"}],"enumerator":"1","key":"ZuukL3l5nv"}],"key":"aV0Vy879Zs"}],"key":"TaoS48dCMk"}],"key":"FX9DbWMxQx"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/ClimateLaboratoryBook/build/72a1ea4a26a2984d2b563dba60bd71bf.jpeg","alt":"feedback AR5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cOOxnX9sF9","urlSource":"https://www.ipcc.ch/site/assets/uploads/2018/02/Fig9-43-1.jpg","urlOptimized":"/ClimateLaboratoryBook/build/72a1ea4a26a2984d2b563dba60bd71bf.webp"}],"key":"mmdcxlodHq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure 9.43","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kZyXihzKBz"}],"key":"BnVPCBNXjQ"},{"type":"text","value":" | (a) Strengths of individual feedbacks for CMIP3 and CMIP5 models (left and right columns of symbols) for Planck (P), water vapour (WV), clouds (C), albedo (A), lapse rate (LR), combination of water vapour and lapse rate (WV+LR) and sum of all feedbacks except Planck (ALL), from Soden and Held (2006) and Vial et al. (2013), following Soden et al. (2008). CMIP5 feedbacks are derived from CMIP5 simulations for abrupt fourfold increases in CO2 concentrations (4 × CO2). (b) ","key":"Meu7D5uAmZ"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"vMZ3oEa4Z9"}],"key":"nKZzYymIW9"},{"type":"text","value":" obtained using regression techniques by Andrews et al. (2012) against ","key":"yqaQo5vzW8"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"CSU2Slj1un"}],"key":"etZMb0EB1t"},{"type":"text","value":" estimated from the ratio of CO2 ERF to the sum of all feedbacks. The CO2 ERF is one-half the 4 × CO2 forcings from Andrews et al. (2012), and the total feedback (ALL + Planck) is from Vial et al. (2013).","key":"GeIulveos6"}],"key":"DNEj7VxXaY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Figure caption reproduced from the AR5 WG1 report ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F5lx9aibgn"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"AR5_Ch9","identifier":"ar5_ch9","children":[{"type":"text","value":"Flato ","key":"XFNxfIcTS4"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"MEDv48Kay2"}],"key":"SYlGPISPW1"},{"type":"text","value":", 2013","key":"QbmTc9YeR1"}],"enumerator":"1","key":"IcNkriXgyP"}],"key":"M7PwvWOGdU"}],"key":"LM6dPqE64N"}],"key":"GOpviZjtV5"}],"key":"XwnH8hKA5k"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/ClimateLaboratoryBook/build/AR5_Table9.5-92c55699099e17fc5a1812a28c830ab7.png","alt":"AR5 Table 9.5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gCGhJWwopD","urlSource":"../images/AR5_Table9.5.png","urlOptimized":"/ClimateLaboratoryBook/build/AR5_Table9.5-92c55699099e17fc5a1812a28c830ab7.webp"}],"key":"ksdpm3Zf4w"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comparing against the multi-model mean of the ","key":"oXPyaz596B"},{"type":"abbreviation","title":"Equilibrium Climate Sensitivity","children":[{"type":"text","value":"ECS","key":"ZNhDjuLoL3"}],"key":"W3fK50hvX7"},{"type":"text","value":" and ","key":"RIm65qf6Mq"},{"type":"abbreviation","title":"Transient Climate Response","children":[{"type":"text","value":"TCR","key":"Xe2yYMlZy9"}],"key":"H1YfX4YXVj"},{"type":"text","value":", our model is apparently slightly less sensitive than the CMIP5 mean.","key":"eU3GwMsXSg"}],"key":"byDmpvxPor"}],"key":"arc1slBAKH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s make some maps to compare spatial patterns of transient vs. equilibrium warming","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ILEr4Or0hR"}],"identifier":"lets-make-some-maps-to-compare-spatial-patterns-of-transient-vs-equilibrium-warming","label":"Let’s make some maps to compare spatial patterns of transient vs. equilibrium warming","html_id":"lets-make-some-maps-to-compare-spatial-patterns-of-transient-vs-equilibrium-warming","implicit":true,"key":"JlOnMJ2swY"}],"key":"GvNcL8IU2A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is a helper function that takes a 2D lat/lon field and renders it as a nice contour map with accompanying zonal average line plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XoldJfUb2s"}],"key":"n9UK2StHVF"}],"key":"DVCiM6ylAz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# The map projection capabilities come from the cartopy package. There are many possible projections\nimport cartopy.crs as ccrs\nfrom cartopy.util import add_cyclic_point","key":"UTnwFpjkJo"},{"type":"output","id":"8Ap9HxKgXOOndRr2zPvJ4","data":[],"key":"HmGHVDw1Ei"}],"key":"zucW5yoeyD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def make_map(field, title=\"\", levels=8):\n    '''input field should be a 2D xarray.DataArray on a lat/lon grid.\n        Make a filled contour plot of the field, and a line plot of the zonal mean\n    '''\n    fig = plt.figure(figsize=(14,6))\n    nrows = 10; ncols = 3\n    mapax = plt.subplot2grid((nrows,ncols), (0,0), colspan=ncols-1, rowspan=nrows-1, projection=ccrs.Robinson())\n    barax = plt.subplot2grid((nrows,ncols), (nrows-1,0), colspan=ncols-1)\n    plotax = plt.subplot2grid((nrows,ncols), (0,ncols-1), rowspan=nrows-1)\n    # add cyclic point so cartopy doesn't show a white strip at zero longitude\n    wrap_data, wrap_lon = add_cyclic_point(field.values, coord=field.lon, axis=field.dims.index('lon'))\n    cx = mapax.contourf(wrap_lon, field.lat, wrap_data, levels=levels, transform=ccrs.PlateCarree())\n    mapax.set_global(); mapax.coastlines();\n    plt.colorbar(cx, cax=barax, orientation='horizontal', label='Surface air temperature (K)')\n    plotax.plot(field.mean(dim='lon'), field.lat)\n    plotax.set_xlabel('Zonal mean (K)')\n    plotax.set_ylabel('Latitude')\n    plotax.grid()\n    fig.suptitle(title, fontsize=16)\n    return fig, (mapax, plotax, barax), cx","key":"yxm7GvIDAd"},{"type":"output","id":"ruM4VC1Ly4mY1TPz-mSAr","data":[],"key":"T33yOHOfhU"}],"key":"ixMmOTT1WI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot a single time slice of surface air temperature just as example\nfig, axes, cx = make_map(atm['cpl_control'].TREFHT.isel(time=0), \n                        title=\"Surface air temperature in the coupled control simulation\")","key":"Jfb4tPEumy"},{"type":"output","id":"sI_lLx9wHImMYxCZ2UDph","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8c9dd6dad5534c56e674a7ff4ddc4aa9","path":"/ClimateLaboratoryBook/build/8c9dd6dad5534c56e674a7ff4ddc4aa9.png"},"text/plain":{"content":"<Figure size 1400x600 with 3 Axes>","content_type":"text/plain"}}}],"key":"Ri9BjqfUa7"}],"key":"qrmKXDp5s4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make maps of the surface air temperature anomaly due to CO2 doubling in both the slab and coupled models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MbelP6Lf32"}],"identifier":"make-maps-of-the-surface-air-temperature-anomaly-due-to-co2-doubling-in-both-the-slab-and-coupled-models","label":"Make maps of the surface air temperature anomaly due to CO2 doubling in both the slab and coupled models","html_id":"make-maps-of-the-surface-air-temperature-anomaly-due-to-co2-doubling-in-both-the-slab-and-coupled-models","implicit":true,"key":"dLPXlsUodf"}],"key":"P2dY3I60Jk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Tmap_cpl_2x = atm['cpl_CO2ramp'].TREFHT.isel(time=clim_slice_cpl).mean(dim='time')\nTmap_cpl_control = atm['cpl_control'].TREFHT.isel(time=clim_slice_cpl).mean(dim='time')\nDeltaT_cpl = Tmap_cpl_2x - Tmap_cpl_control\n\nTmap_som_2x = atm['som_2xCO2'].TREFHT.isel(time=clim_slice_slab).mean(dim='time')\nTmap_som_control = atm['som_control'].TREFHT.isel(time=clim_slice_slab).mean(dim='time')\nDeltaT_som = Tmap_som_2x - Tmap_som_control","key":"MkBWaRMU9n"},{"type":"output","id":"rgpgJrBgt8lf8PPElRLM5","data":[],"key":"HC6PFD92ro"}],"key":"Vyjc7EwE0E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"contours = np.arange(0., 8.5, 0.5)\nfig, axes, cx = make_map(DeltaT_cpl, levels=contours,\n                        title=\"Surface air temperature anomaly (coupled transient)\")\naxes[1].set_xlim(0,7)  # ensure the line plots have same axes\n\nfig, axes,cx  = make_map(DeltaT_som, levels=contours,\n                         title=\"Surface air temperature anomaly (equilibrium SOM)\")\naxes[1].set_xlim(0,7)","key":"H8bRPqzZh7"},{"type":"output","id":"aRoBJ6IrNuAezb7UC5f9f","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(0.0, 7.0)","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb0eddb13ca642eefbb3fd43c248108a","path":"/ClimateLaboratoryBook/build/bb0eddb13ca642eefbb3fd43c248108a.png"},"text/plain":{"content":"<Figure size 1400x600 with 3 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f2484db5b2fd8c651dfc2a91066824e","path":"/ClimateLaboratoryBook/build/8f2484db5b2fd8c651dfc2a91066824e.png"},"text/plain":{"content":"<Figure size 1400x600 with 3 Axes>","content_type":"text/plain"}}}],"key":"XwH0MH1ukR"}],"key":"Iud8Acry2B"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lots of intersting phenomena to think about here, including:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CCy8Eroalz"}],"key":"zGB5qIQJFC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Polar amplification of surface warming","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ypD8QXhGw5"}],"key":"ggoLZxJbNS"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Reduction in equator-to-pole temperature gradients","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nByG18c9px"}],"key":"hlFoBQRV33"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Much larger polar amplification in SOM than in transient -- especially over the Southern Ocean (the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KWVhstItt1"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"delayed warming of the Southern Ocean","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xah2HS9e7g"}],"key":"AKJ8U04RvT"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ts3j7zhiuJ"}],"key":"XoXj0vk8EC"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"North Atlantic ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RYpUKfYmRV"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"warming hole","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PfvHpM2kjc"}],"key":"beOjFKi1HQ"},{"type":"text","value":" present in transient but not in equilibrium SOM.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hsGXImRHaE"}],"key":"Uarrlmq9dE"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Land-ocean warming contrast: larger in transient, but still present in equilibrium","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YG3IdLhY5l"}],"key":"hnm39eWdCM"}],"key":"pRhChD00lq"}],"key":"lZlPczYawz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Appendix: for later reference, here is how you can open the other output types","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L5bkEd65r0"}],"identifier":"appendix-for-later-reference-here-is-how-you-can-open-the-other-output-types","label":"Appendix: for later reference, here is how you can open the other output types","html_id":"appendix-for-later-reference-here-is-how-you-can-open-the-other-output-types","implicit":true,"key":"LRNIwpbmFx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following will open the rest of the ","key":"MQ2lXfSBI7"},{"type":"abbreviation","title":"Community Earth System Model","children":[{"type":"text","value":"CESM","key":"BJDmWWLgaS"}],"key":"WcEX8gLPD4"},{"type":"text","value":" output (land, sea ice, river routing, ocean).","key":"jwaoereIQg"}],"key":"BSjfPWbEH9"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"These are not needed for the above homework assignment, but may be useful later on.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TdsUkiBwsu"}],"key":"S5jcQhlE7Z"}],"key":"ZjABC0UtmK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # make a dictionary of all the CLM land model output\n# land = {}\n# for name in casenames:\n#     path = casepaths[name] + casenames[name] + '.clm2.h0.nc'\n#     print('Attempting to open the dataset ', path)\n#     land[name] = xr.open_dataset(path)","key":"Pddf6GmOQ0"},{"type":"output","id":"9A7U19NHqGpEJvbRe9Fk2","data":[],"key":"cvp915GIat"}],"key":"vPsRjkeNRV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # make a dictionary of all the sea ice model output\n# ice = {}\n# for name in casenames:\n#     path = casepaths[name] + casenames[name] + '.cice.h.nc'\n#     print('Attempting to open the dataset ', path)\n#     ice[name] = xr.open_dataset(path)","key":"c4GR0ojFT3"},{"type":"output","id":"bS_LZqD_zVYnjmoythuXK","data":[],"key":"BeDlSoGjjM"}],"key":"oGidzPPvDm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # make a dictionary of all the river transport output\n# rtm = {}\n# for name in casenames:\n#     path = casepaths[name] + casenames[name] + '.rtm.h0.nc'\n#     print('Attempting to open the dataset ', path)\n#     rtm[name] = xr.open_dataset(path)","key":"WQmJyyI6X2"},{"type":"output","id":"O4uK3Bln3tbVelo-dWkfF","data":[],"key":"wA7jxrGr7q"}],"key":"zTf0NJhIXZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ocn = {}\n# for name in casenames:\n#     if 'cpl' in name:\n#         path = casepaths[name] + casenames[name] + '.pop.h.nc'\n#         print('Attempting to open the dataset ', path)\n#         ocn[name] = xr.open_dataset(path)","key":"ANE948NL69"},{"type":"output","id":"EnklA5Jatxhv3Rz-4QgGr","data":[],"key":"u9c6VwZYKF"}],"key":"P2S5pFfWbg"},{"type":"block","kind":"notebook-content","data":{"slideshow":{"slide_type":"skip"}},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mydw3kkUYx"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credits","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L53pFoNsZ1"}],"identifier":"credits","label":"Credits","html_id":"credits","implicit":true,"key":"VrS35gNmaL"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This notebook is part of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YjU2MSdiaK"},{"type":"link","url":"https://brian-rose.github.io/ClimateLaboratoryBook","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The Climate Laboratory","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DzttAiL65C"}],"urlSource":"https://brian-rose.github.io/ClimateLaboratoryBook","key":"Dolmlz4Pmz"},{"type":"text","value":", an open-source textbook developed and maintained by ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SfZpXuQUV9"},{"type":"link","url":"http://www.atmos.albany.edu/facstaff/brose/index.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Brian E. J. Rose","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PFpzcdnAgd"}],"urlSource":"http://www.atmos.albany.edu/facstaff/brose/index.html","key":"XrHQbHD5ZR"},{"type":"text","value":", University at Albany.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NPE9mUARUF"}],"key":"nEdVG0GrKX"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"It is licensed for free and open consumption under the\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"AWFiqk0DME"},{"type":"link","url":"https://creativecommons.org/licenses/by/4.0/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Creative Commons Attribution 4.0 International (CC BY 4.0)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vc7LCZJfBT"}],"urlSource":"https://creativecommons.org/licenses/by/4.0/","key":"Ms4OfBGUnT"},{"type":"text","value":" license.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jLy3pNoCo8"}],"key":"JweHmdk7Uw"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Development of these notes and the ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"emo3ESrg7K"},{"type":"link","url":"https://github.com/climlab/climlab","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"climlab software","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YSbFekG9S1"}],"urlSource":"https://github.com/climlab/climlab","error":true,"key":"aItWMOiSQe"},{"type":"text","value":" is partially supported by the National Science Foundation under award AGS-1455071 to Brian Rose. Any opinions, findings, conclusions or recommendations expressed here are mine and do not necessarily reflect the views of the National Science Foundation.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Ncd1SLpbuN"}],"key":"LrtzRWqjXt"},{"type":"thematicBreak","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KCpwgkMW4C"}],"key":"OorEwwxmI9"}],"key":"iVJ1ZdEZ1g"},"references":{"cite":{"order":["AR5_Ch9"],"data":{"AR5_Ch9":{"label":"AR5_Ch9","enumerator":"1","html":"Flato, G., Marotzke, J., Abiodun, B., Braconnot, P., Chou, S. C., Collins, W., Cox, P., Driouech, F., Emori, S., Eyring, V., Forest, C., Gleckler, P., Guilyardi, E., Jakob, C., Kattsov, V., Reason, C., & Rummukainen, M. (2013). Evaluation of Climate Models. In T. F. Stocker, D. Qin, G.-K. Plattner, M. Tignor, S. K. Allen, J. Boschung, A. Nauels, Y. Xia, V. Bex, & P. M. Midgley (Eds.), <i>Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change</i>. Cambridge University Press."}}}},"footer":{"navigation":{"prev":{"title":"Advanced topic: Climate sensitivity and feedback","url":"/advanced-sensitivity-feedback","group":"The Climate Laboratory"},"next":{"title":"Toy models of transient warming","url":"/transient-toy","group":"The Climate Laboratory"}}},"domain":"http://localhost:3000"}